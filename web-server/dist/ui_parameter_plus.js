/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"ui_parameter_plus": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/dist/";
/******/
/******/ 	var jsonpArray = window["webpackJsonp"] = window["webpackJsonp"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./web-server/plugins/slycat-parameter-image-plus-model/js/ui.js","vendors~slycat_page~slycat_project~slycat_projects~ui_cca~ui_parameter_image~ui_parameter_plus~ui_ru~29e28113","vendors~slycat_page~slycat_project~slycat_projects~ui_cca~ui_parameter_image~ui_parameter_plus~ui_ti~7afcd8b9","vendors~ui_cca~ui_parameter_image~ui_parameter_plus~ui_timeseries","slycat_page~slycat_project~slycat_projects~ui_cca~ui_parameter_image~ui_parameter_plus~ui_run_comman~247387c4","slycat_page~slycat_project~slycat_projects~ui_cca~ui_parameter_image~ui_parameter_plus~ui_timeseries","ui_cca~ui_parameter_image~ui_parameter_plus~ui_timeseries","ui_cca~ui_parameter_image~ui_parameter_plus","ui_parameter_image~ui_parameter_plus","ui_parameter_plus~ui_timeseries"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/css-loader/index.js!./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css":
/*!***************************************************************************************************!*\
  !*** ./node_modules/css-loader!./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css ***!
  \***************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var escape = __webpack_require__(/*! ../../../../node_modules/css-loader/lib/url/escape.js */ \"./node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = __webpack_require__(/*! ../../../../node_modules/css-loader/lib/css-base.js */ \"./node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.i, \"/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\\n\\n/* Page header */\\n\\n#edit-model-button\\n{\\n  float: right;\\n}\\n\\n#table\\n{\\n\\tposition: absolute;\\n\\ttop: 0;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tbottom: 0;\\n}\\n\\n.x-axis,\\n.y-axis\\n{\\n  -moz-user-select: none;\\n  -webkit-user-select: none;\\n  -ms-user-select: none;\\n  user-select: none;\\n  shape-rendering: crispEdges;\\n}\\n\\n.x-axis path,\\n.y-axis path\\n{\\n  fill: none;\\n  stroke: black;\\n}\\n\\n#remote-error\\n{\\n  background-color: red;\\n  color: yellow;\\n  padding: 1em;\\n}\\n\\n/* Model */\\n#parameter-image-plus-layout {\\n  -webkit-flex: 1;\\n  flex: 1;\\n}\\n\\n/* New CCA table styles */\\n#barplot-table {\\n  /*height: 250px;*/\\n  overflow: hidden;\\n}\\n.barplotHeader {\\n  /*overflow: hidden;*/\\n  white-space: nowrap;\\n}\\n.barplotHeaderColumns {\\n  /*outline: 1px solid blue;*/\\n  white-space: nowrap;\\n  display: inline-block;\\n}\\n.barplotHeaderColumn {\\n  text-align: right !important;\\n  display: inline-block;\\n  /*padding: 3px;*/\\n  cursor: pointer;\\n  /*outline: 1px solid red;*/\\n}\\n.wrapper {\\n  /*No longer using box-sizing since we are sizing cells based on an wrapper div inside them*/\\n/*  box-sizing: border-box;\\n  -moz-box-sizing: border-box;*/\\n}\\n.barplotHeaderColumn .wrapper {\\n  padding: 3px;\\n}\\n.mask\\n{\\n  background-color: white;\\n  position: relative; /* needed to get this cell to cover scrolling header row */\\n  z-index: 1;\\n}\\n.mask .wrapper {\\n  padding: 3px;\\n}\\n.barplotViewport {\\n\\n}\\n.barplotGroup {\\n  overflow: hidden;\\n  width: auto !important; /* Need to force auto width since jQuery Resizable Widget sets static width on resize, which then breaks horizontal expansion/contraction on pane resize */\\n}\\n.barplotColumn {\\n  float: left;\\n  clear: left;\\n}\\n.barplotGroup.inputs,\\n.barplotHeader,\\n.barplotColumn,\\n.mask,\\n.inputs .ui-resizable-s\\n{\\n  border-color: #C0C0C0;\\n  border-style: solid;\\n  border-width: 0;\\n}\\n/*.barplotGroup.inputs,*/\\n.barplotHeader\\n{\\n  border-bottom-width: 1px;\\n}\\n.barplotColumn,\\n.mask\\n{\\n  border-right-width: 1px;\\n}\\n.inputs .ui-resizable-s {\\n  bottom: 0;\\n  height: 3px;\\n  border-bottom-width: 1px;\\n  border-top-width: 1px;\\n  background-color: #DDDDCC;\\n}\\n.inputs .ui-resizable-s.ui-resizable-hover {\\n  background-color: #FFCC66;\\n}\\n.noVerticalResize .ui-resizable-s {\\n  display: none !important;\\n}\\n.toggle-control-s {\\n  width: 50px;\\n  height: 100%;\\n  margin: 0 auto;\\n  background-color: #CCCCBB;\\n}\\n.toggle-control-s.toggle-control-hover {\\n  cursor: pointer;\\n  background-color: #FFCC66;\\n}\\n/*.barplotGroup.inputs {\\n  border-bottom: 7px solid red;\\n}*/\\n.barplotColumn .barplotCell {\\n  display: block;\\n}\\n.barplotCanvas {\\n  /*overflow: auto;*/\\n  /*display: relative;*/ /* Only needed if using DOM's scrollIntoView() function instead of jQuery plugin */\\n  height: 100%;\\n}\\n.barplotCanvas.input {\\n  overflow-x: hidden;\\n  /*overflow-y: auto;*/\\n}\\n.barplotRow {\\n  white-space: nowrap;\\n}\\n.barplotCell {\\n  display: inline-block;\\n  text-align: right;\\n}\\n#rsquared-label sup {\\n  position: absolute;\\n  margin-top: -3px;\\n}\\n.rowInput,\\n.rowOutput\\n{\\n  cursor: pointer;\\n}\\n#barplot-table .inputLabel .wrapper,\\n#barplot-table .outputLabel .wrapper\\n{\\n  padding: 3px;\\n}\\n#barplot-table .inputLabel,\\n#barplot-table .outputLabel,\\n.barplotCell.col0,\\n.barplotHeaderColumn\\n{\\n  font-weight: bold;\\n  text-align: center;\\n}\\n#barplot-table .inputLabel\\n{\\n  background: #eeffe0;\\n}\\n#barplot-table .inputLabel.selected-variable,\\n#barplot-table .barplotRow.rowInput.selected-variable,\\n#barplot-table .barplotCell.rowInput.selected-variable\\n{\\n  background: #3ca654;\\n  color: white;\\n}\\n#barplot-table .outputLabel\\n{\\n  background: #eeeeff;\\n}\\n#barplot-table .outputLabel.selected-variable,\\n#barplot-table .barplotRow.rowOutput.selected-variable,\\n#barplot-table .barplotCell.rowOutput.selected-variable\\n{\\n  background: #7767b0;\\n  color: white;\\n}\\n.barplotHeaderColumnLabelWrapper,\\n.selectCCAComponent,\\n.wrapper,\\n.barplotCellValue,\\n.selected-component .spacer,\\n.negative,\\n.positive\\n{\\n  display: inline-block;\\n}\\n.barplotCellValue\\n{\\n  padding: 3px 23px 3px 18px;\\n  width: 40px;\\n}\\n.selected-component .barplotCellValue,\\n.barplotHeaderColumn.selected-component .barplotHeaderColumnLabelWrapper\\n{\\n  background-color: #DDDDDD;\\n  border-width: 0px 1px;\\n  border-style: solid;\\n  border-color: #808080;\\n  color: #666655;\\n}\\n.barplotHeaderColumn.selected-component .wrapper {\\n  padding: 0;\\n}\\n.barplotHeaderColumn.selected-component .barplotHeaderColumnLabelWrapper\\n{\\n  padding: 3px 3px 3px 3px;\\n  width: 75px;\\n}\\n.spacer\\n{\\n  width: 100px;\\n  display: none;\\n}\\n.negativeSpacer\\n{\\n  text-align: right;\\n}\\n.positiveSpacer\\n{\\n  text-align: left;\\n}\\n.negative,\\n.positive\\n{\\n  height: 12px;\\n}\\n.negative\\n{\\n  background-color: blue;\\n  border-top-left-radius: 2px;\\n  border-bottom-left-radius: 2px;\\n}\\n.positive\\n{\\n  background-color: red;\\n  border-top-right-radius: 2px;\\n  border-bottom-right-radius: 2px;\\n}\\n#barplot-table span.sortCCAComponent\\n{\\n  width: 15px;\\n  height: 15px;\\n  display: inline-block;\\n  border: 1px solid transparent;\\n  cursor: pointer;\\n  position: relative;\\n  top: 3px;\\n  margin-left: 3px;\\n}\\n.barplotHeaderColumn.mask.col0 {\\n  vertical-align: top;\\n}\\n.slick-header-column {\\n  padding-right: 41px !important;\\n}\\n.icon-sort-off {\\n  border: 1px solid transparent;\\n  background: transparent url(\" + escape(__webpack_require__(/*! ../../../img/sort-asc-light.png */ \"./web-server/img/sort-asc-light.png\")) + \") no-repeat center center;\\n}\\n.icon-sort-off:hover {\\n  border: 1px solid transparent !important;\\n  background: transparent url(\" + escape(__webpack_require__(/*! ../../../img/sort-asc-gray.png */ \"./web-server/img/sort-asc-gray.png\")) + \") no-repeat center center !important;\\n}\\n.icon-sort-ascending:hover,\\n.icon-sort-descending:hover\\n{\\n  border: 1px solid transparent;\\n}\\n.slick-header-button,\\n.slick-header-column:hover > .slick-header-button\\n{\\n  width: 10px;\\n}\\n.slick-header-button.icon-image-on,\\n.slick-header-button.icon-image-off\\n{\\n  right: 16px;\\n  top: 4px;\\n}\\n.slick-header-button.icon-image-off {\\n  background: transparent url(\" + escape(__webpack_require__(/*! ../../../img/image-light.png */ \"./web-server/img/image-light.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-image-on,\\n.slick-header-button.icon-image-off:hover\\n{\\n  background: transparent url(\" + escape(__webpack_require__(/*! ../../../img/image-gray.png */ \"./web-server/img/image-gray.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-y-on,\\n.slick-header-button.icon-y-off\\n{\\n  right: 16px;\\n  top: 4px;\\n}\\n.slick-header-button.icon-y-off {\\n  background: transparent url(\" + escape(__webpack_require__(/*! ../../../img/y-light.png */ \"./web-server/img/y-light.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-y-on,\\n.slick-header-button.icon-y-off:hover\\n{\\n  background: transparent url(\" + escape(__webpack_require__(/*! ../../../img/y-gray.png */ \"./web-server/img/y-gray.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-x-on,\\n.slick-header-button.icon-x-off\\n{\\n  right: 26px;\\n  top: 4px;\\n}\\n.slick-header-button.icon-x-off {\\n  background: transparent url(\" + escape(__webpack_require__(/*! ../../../img/x-light.png */ \"./web-server/img/x-light.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-x-on,\\n.slick-header-button.icon-x-off:hover\\n{\\n  background: transparent url(\" + escape(__webpack_require__(/*! ../../../img/x-gray.png */ \"./web-server/img/x-gray.png\")) + \") no-repeat center center;\\n}\\n#page-title {\\n  padding-top: 5px;\\n  padding-bottom: 35px;\\n}\\n#controls-pane {\\n  \\n}\\n.center {\\n  text-align: center;\\n}\\n#color-switcher {\\n  margin: 0;\\n  float: none;\\n  display: inline-block;\\n}\\n#color-switcher .label {\\n  font-weight: bold;\\n}\\n#color-switcher .color {\\n  background-color: #DBD9EB;\\n  padding: 4px;\\n}\\n#color-switcher .color:hover {\\n  cursor: pointer;\\n}\\n#color-switcher .selected:hover {\\n  cursor: default;\\n}\\n#color-switcher .selected {\\n  background-color: #7767B0 !important;\\n  color: white;\\n}\\n#color-switcher,\\n#controls\\n{\\n  font-size: small;\\n}\\n#controls {\\n  display: inline-block;\\n  margin: 2px 0;\\n}\\n#controls label {\\n  font-weight: bold;\\n  margin-right: 5px;\\n}\\n#controls label.disabled,\\n#controls select:disabled\\n{\\n  color: gray;\\n}\\n#controls select:disabled {\\n\\n}\\n#controls select {\\n  margin-right: 10px;\\n  padding: 2px 4px;\\n}\\n#controls button,\\n#controls label[for=\\\"auto-scale-option\\\"]\\n{\\n  margin-right: 10px;\\n}\\n#scatterplot.resizing,\\n#scatterplot .resize-handle:hover {\\n  cursor: nwse-resize;\\n}\\n#scatterplot rect.outline:hover,\\n#scatterplot g.image-frame image.image\\n{\\n  cursor: move;\\n}\\n#scatterplot .close-button:hover,\\n#scatterplot .pin-button:hover {\\n  cursor: pointer;\\n}\\n#scatterplot g.open-image image.image {\\n\\n}\\n#scatterplot .close-button,\\n#scatterplot .resize-handle,\\n#scatterplot .pin-button\\n{\\n  visibility: hidden;\\n}\\n#scatterplot g.open-image:hover .close-button,\\n#scatterplot g.open-image.resizing .close-button,\\n#scatterplot g.hover-image .pin-button,\\n#scatterplot g.open-image:hover .pin-button,\\n#scatterplot g.image-frame:hover .resize-handle,\\n#scatterplot g.open-image.resizing .resize-handle\\n{\\n  visibility: visible;\\n}\\n#scatterplot g.legend:hover {\\n  cursor: move;\\n}\\n#scatterplot .image-frame rect.outline {\\n  shape-rendering: crispEdges;\\n}\\n.legend-axis path,\\n.legend-axis line\\n{\\n  fill: none;\\n  stroke: black;\\n  shape-rendering: crispEdges;\\n}\\n.dialogErrorMessage {\\n  color: red;\\n}\\n#scatterplot canvas {\\n  z-index: -1;\\n}\\n\\n/* dendrogram styles */\\n#dendrogram-pane #dendrogram-sort-control \\n{\\n  position: absolute;\\n  bottom: 0px;\\n  left: 0px;\\n  cursor: pointer;\\n  background: #DBD9EB url(\" + escape(__webpack_require__(/*! ../../../img/sort-dendrogram.png */ \"./web-server/img/sort-dendrogram.png\")) + \") no-repeat center center;;\\n  padding: 4px;\\n  margin: 0 0 5px 18px;\\n  height: 17px;\\n  min-width: 17px;\\n}\\n\\n#dendrogram-pane #dendrogram-sort-control.selected\\n{\\n  background: #7767B0 url(\" + escape(__webpack_require__(/*! ../../../img/sort-dendrogram-selected.png */ \"./web-server/img/sort-dendrogram-selected.png\")) + \") no-repeat center center;\\n  color: #FFFFFF;\\n  cursor: default;\\n}\\n\\n#dendrogram-viewer .node .glyph circle\\n{\\n  stroke: grey;\\n}\\n\\n#dendrogram-viewer .node.selected .glyph circle\\n{\\n  fill: #7767b0 !important;\\n  stroke: black;\\n}\\n\\n#dendrogram-viewer .node .glyph text\\n{\\n  cursor: pointer;\\n}\\n\\n#dendrogram-viewer .node .subtree\\n{\\n  cursor: pointer;\\n}\\n\\n#dendrogram-viewer .node .subtree path\\n{\\n  stroke: none;\\n}\\n\\n/* Hiding the additional glyph initially */\\n#dendrogram-viewer .node .subtree path.filled-glyph\\n{\\n  display: none;\\n}\\n/* Showing it for selected nodes */\\n#dendrogram-viewer .node.selected .subtree path.filled-glyph\\n{\\n  display: inline;\\n}\\n\\n#dendrogram-viewer .node.selected .subtree text\\n{\\n  fill: white;\\n}\\n\\n#dendrogram-viewer .node .sparkline path\\n{\\n  fill: none;\\n  stroke: black;\\n}\\n\\n#dendrogram-viewer .link\\n{\\n  fill: none;\\n  stroke: #C9C9C9;\\n  shape-rendering: crispEdges;\\n}\\n#dendrogram-leaf-backdrop {\\n  height: 100%;\\n  width: 49px;\\n  position: absolute;\\n  right: 0;\\n  z-index: -1;\\n}\\n#dendrogram-viewer g.sparkline path {\\n  stroke-linecap: round;\\n}\\n#dendrogram-viewer g.sparkline path:hover,\\n#dendrogram-viewer g.sparkline path.highlight\\n{\\n  stroke-width: 4px;\\n}\\n#dendrogram-viewer g.sparkline path.highlight {\\n  \\n}\\n#dendrogram-viewer g.sparkline path.nullValue {\\n  stroke-dasharray: 2px, 2px;\\n}\\n#dendrogram-viewer g.sparkline path.highlight.nullValue {\\n  stroke-dasharray: 2px, 5px;\\n}\\n#dendrogram-viewer g.thumbnail rect.outline {\\n  stroke: unset;\\n}\\n#dendrogram-viewer g.thumbnail.highlight rect.outline {\\n  stroke: black;\\n}\\n#dendrogram-viewer g.square {\\n  shape-rendering: crispEdges;\\n}\\n\\n/* ui layout */\\n.ui-layout-resizer\\n{\\n  background: #ddc;\\n}\\n.ui-layout-resizer-hover\\n{\\n  background: #fc6;\\n}\\n.ui-layout-resizer-dragging\\n{\\n  background: #fc6;\\n}\\n.ui-layout-toggler\\n{\\n  background: #ccb;\\n}\\n.ui-layout-toggler-hover\\n{\\n  background: #fc6;\\n}\\n.ui-layout-pane, .ui-layout-container\\n{\\n  background: white;\\n  padding: 0;\\n  border: 0;\\n  margin: 0;\\n}\\n\\n/* Image Preview */\\n#scatterplot-pane #image-preview {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  background-color: white;\\n  display: none;\\n  text-align: center;\\n}\\n#scatterplot-pane #image-preview-image {\\n  max-height: 100%;\\n  max-width: 100%;\\n}\", \"\"]);\n\n// exports\n\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css?./node_modules/css-loader");

/***/ }),

/***/ "./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css":
/*!*************************************************************************!*\
  !*** ./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("\nvar content = __webpack_require__(/*! !../../../../node_modules/css-loader!./ui.css */ \"./node_modules/css-loader/index.js!./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css\");\n\nif(typeof content === 'string') content = [[module.i, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = __webpack_require__(/*! ../../../../node_modules/style-loader/lib/addStyles.js */ \"./node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(false) {}\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css?");

/***/ }),

/***/ "./web-server/plugins/slycat-parameter-image-plus-model/img/pin.png":
/*!**************************************************************************!*\
  !*** ./web-server/plugins/slycat-parameter-image-plus-model/img/pin.png ***!
  \**************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAAs0lEQVQ4jdXRsWoCQRgE4A9RLMRCsFHsrO2jb5E6PoaIZTpLa/FZrJJ30IT0gaSwsBBB0OLu4LLe6WllBqbZf2b+2V3+Ewao3Wvu44B31G81d/CJY8y3IiFNPOEV3ylzwmUiLGeYv9C9suDn0nCcsTHhHs/X6sMoJ2BSxAwVfATmHRqhsJQTMEUVs9TZGptQmPWIL2ihhy1WmIt+4wxhQDtuNYxrw0J0pd+ctn9QLSJ6LJwAXgcqz7/uBCYAAAAASUVORK5CYII=\"\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/img/pin.png?");

/***/ }),

/***/ "./web-server/plugins/slycat-parameter-image-plus-model/js/color-switcher.js":
/*!***********************************************************************************!*\
  !*** ./web-server/plugins/slycat-parameter-image-plus-model/js/color-switcher.js ***!
  \***********************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($) {\n\nvar _d = __webpack_require__(/*! js/d3.min */ \"./web-server/js/d3.min.js\");\n\nvar _d2 = _interopRequireDefault(_d);\n\n__webpack_require__(/*! jquery-ui */ \"./node_modules/jquery-ui/jquery-ui.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\n$.widget(\"slycat.colorswitcher\", {\n  options: {\n    colormap: \"day\"\n  },\n\n  _create: function _create() {\n    var self = this;\n\n    this.color_maps = {\n      \"night\": {\n        \"label\": \"Night\",\n        \"background\": _d2.default.rgb(128, 128, 128),\n        \"null_color\": \"rgb(75,75,75)\",\n        \"opacity\": \"0.5\",\n        \"colors\": [_d2.default.rgb(59, 76, 192), _d2.default.rgb(68, 90, 204), _d2.default.rgb(77, 104, 215), _d2.default.rgb(87, 117, 225), _d2.default.rgb(98, 130, 234), _d2.default.rgb(108, 142, 241), _d2.default.rgb(119, 154, 247), _d2.default.rgb(130, 165, 251), _d2.default.rgb(141, 176, 254), _d2.default.rgb(152, 185, 255), _d2.default.rgb(163, 194, 255), _d2.default.rgb(174, 201, 253), _d2.default.rgb(184, 208, 249), _d2.default.rgb(194, 213, 244), _d2.default.rgb(204, 217, 238), _d2.default.rgb(213, 219, 230), _d2.default.rgb(221, 221, 221), _d2.default.rgb(229, 216, 209), _d2.default.rgb(236, 211, 197), _d2.default.rgb(241, 204, 185), _d2.default.rgb(245, 196, 173), _d2.default.rgb(247, 187, 160), _d2.default.rgb(247, 177, 148), _d2.default.rgb(247, 166, 135), _d2.default.rgb(244, 154, 123), _d2.default.rgb(241, 141, 111), _d2.default.rgb(236, 127, 99), _d2.default.rgb(229, 112, 88), _d2.default.rgb(222, 96, 77), _d2.default.rgb(213, 80, 66), _d2.default.rgb(203, 62, 56), _d2.default.rgb(192, 40, 47), _d2.default.rgb(180, 4, 38)]\n      },\n      \"day\": {\n        \"label\": \"Day\",\n        \"background\": _d2.default.rgb(255, 255, 255),\n        \"null_color\": \"gray\",\n        \"opacity\": \"0.7\",\n        \"colors\": [_d2.default.rgb(100, 108, 234), _d2.default.rgb(115, 118, 240), _d2.default.rgb(128, 128, 244), _d2.default.rgb(140, 138, 248), _d2.default.rgb(151, 147, 250), _d2.default.rgb(161, 155, 251), _d2.default.rgb(169, 163, 251), _d2.default.rgb(177, 170, 250), _d2.default.rgb(184, 177, 248), _d2.default.rgb(189, 182, 245), _d2.default.rgb(193, 187, 241), _d2.default.rgb(197, 191, 236), _d2.default.rgb(199, 194, 230), _d2.default.rgb(200, 196, 224), _d2.default.rgb(201, 198, 216), _d2.default.rgb(200, 199, 208), _d2.default.rgb(198, 198, 198), _d2.default.rgb(210, 197, 195), _d2.default.rgb(220, 194, 192), _d2.default.rgb(229, 191, 187), _d2.default.rgb(236, 186, 181), _d2.default.rgb(243, 181, 175), _d2.default.rgb(248, 175, 168), _d2.default.rgb(251, 168, 160), _d2.default.rgb(254, 159, 152), _d2.default.rgb(255, 150, 143), _d2.default.rgb(255, 140, 133), _d2.default.rgb(253, 129, 123), _d2.default.rgb(250, 117, 112), _d2.default.rgb(246, 105, 101), _d2.default.rgb(240, 91, 90), _d2.default.rgb(233, 75, 78), _d2.default.rgb(225, 57, 66)]\n      },\n      \"rainbow\": {\n        \"label\": \"Rainbow Night\",\n        \"background\": _d2.default.rgb(128, 128, 128),\n        \"null_color\": \"rgb(75,75,75)\",\n        \"opacity\": \"0.6\",\n        \"colors\": [_d2.default.rgb(0, 0, 255), _d2.default.rgb(0, 255, 255), _d2.default.rgb(255, 255, 0), _d2.default.rgb(255, 0, 0)]\n      },\n      \"rainbow_day\": {\n        \"label\": \"Rainbow Day\",\n        \"background\": _d2.default.rgb(255, 255, 255),\n        \"null_color\": \"gray\",\n        \"opacity\": \"0.7\",\n        \"colors\": [_d2.default.rgb(0, 0, 255), _d2.default.rgb(0, 255, 255), _d2.default.rgb(255, 255, 0), _d2.default.rgb(255, 0, 0)]\n      }\n    };\n\n    this.container = $(\"<div>\").appendTo(this.element).append('<span class=\"label\">Colors: </span>');\n    $.each(this.color_maps, function (key, value) {\n      var button = $(\"<span>\").addClass(\"color\").toggleClass(\"selected\", key == self.options.colormap).appendTo(self.container).attr(\"data-colormap\", key).html(value.label).click(function () {\n        if ($(this).hasClass(\"selected\")) return;\n\n        self.options.colormap = this.getAttribute(\"data-colormap\");\n        self.container.find(\".color\").removeClass(\"selected\");\n        $(this).addClass(\"selected\");\n\n        self.element.trigger(\"colormap-changed\", [self.options.colormap]);\n      });\n    });\n  },\n\n  _setOption: function _setOption(key, value) {\n    //console.log(\"slycat.colorswitcher._setOption()\", key, value);\n    this.options[key] = value;\n\n    if (key == \"colormap\") {\n      this.container.find(\".color\").removeClass(\"selected\");\n      this.container.find(\"[data-colormap='\" + this.options.colormap + \"']\").addClass(\"selected\");\n    }\n  },\n\n  // Return a d3 rgb object with the suggested background color for the given color map.\n  get_background: function get_background(name) {\n    if (name === undefined) name = this.options.colormap;\n    return this.color_maps[name].background;\n  },\n\n  // Return the null color value for the given color map.\n  get_null_color: function get_null_color(name) {\n    if (name === undefined) name = this.options.colormap;\n    return this.color_maps[name][\"null_color\"];\n  },\n\n  // Return the suggested opacity value for the given color map.\n  get_opacity: function get_opacity(name) {\n    if (name === undefined) name = this.options.colormap;\n    return this.color_maps[name].opacity;\n  },\n\n  // Return a d3 linear color scale with the current color map for the domain [0, 1].\n  // Callers should modify the domain by passing a min and max to suit their own needs.  \n  get_color_scale: function get_color_scale(name, min, max) {\n    if (name === undefined) name = this.options.colormap;\n    if (min === undefined) min = 0.0;\n    if (max === undefined) max = 1.0;\n    var domain = [];\n    var domain_scale = _d2.default.scale.linear().domain([0, this.color_maps[name].colors.length - 1]).range([min, max]);\n    for (var i in this.color_maps[name].colors) {\n      domain.push(domain_scale(i));\n    }return _d2.default.scale.linear().domain(domain).range(this.color_maps[name].colors);\n  },\n\n  // Deprecated\n  get_color_map: function get_color_map(name, min, max) {\n    return this.get_color_scale(name, min, max);\n  },\n\n  // Return a d3 ordinal color scale with the current color map for the domain [0, 1].\n  // Callers should modify the domain by passing an array of values to suit their own needs. \n  get_color_scale_ordinal: function get_color_scale_ordinal(name, values) {\n    if (name === undefined) name = this.options.colormap;\n    if (values === undefined) values = [0, 1];\n\n    var tempOrdinal = _d2.default.scale.ordinal().domain(values).rangePoints([0, 100], 0);\n    var tempColorscale = this.get_color_scale(name, 0, 100);\n    var rgbRange = [];\n    for (var i = 0; i < values.length; i++) {\n      rgbRange.push(tempColorscale(tempOrdinal(values[i])));\n    }\n    return _d2.default.scale.ordinal().domain(values).range(rgbRange);\n  },\n\n  // Deprecated\n  get_color_map_ordinal: function get_color_map_ordinal(name, values) {\n    return this.get_color_scale_ordinal(name, values);\n  },\n\n  get_gradient_data: function get_gradient_data(name) {\n    var self = this;\n\n    if (name === undefined) name = this.options.colormap;\n\n    var colors = self.color_maps[name][\"colors\"];\n    var length = colors.length;\n    var data = [];\n    for (var i = 0; i < length; i++) {\n      data.push({ offset: i * (100 / (length - 1)), color: colors[length - 1 - i] });\n    }\n    return data;\n  },\n\n  setUpColorMapsForAllColumns: function setUpColorMapsForAllColumns(name, columns) {\n    for (var j = 0; j != columns.length; ++j) {\n      columns[j].colorMap = this.get_color_scale(name, columns[j].columnMin, columns[j].columnMax);\n    }\n  }\n});\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\")))\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/color-switcher.js?");

/***/ }),

/***/ "./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-controls.js":
/*!***************************************************************************************!*\
  !*** ./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-controls.js ***!
  \***************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($) {\n\nvar _slycatServerRoot = __webpack_require__(/*! js/slycat-server-root */ \"./web-server/js/slycat-server-root.js\");\n\nvar _slycatServerRoot2 = _interopRequireDefault(_slycatServerRoot);\n\nvar _slycatDialogWebpack = __webpack_require__(/*! js/slycat-dialog-webpack */ \"./web-server/js/slycat-dialog-webpack.js\");\n\nvar dialog = _interopRequireWildcard(_slycatDialogWebpack);\n\n__webpack_require__(/*! jquery-ui */ \"./node_modules/jquery-ui/jquery-ui.js\");\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n$.widget(\"parameter_image.controls\", {\n  options: {\n    \"server-root\": \"\",\n    mid: null,\n    model_name: null,\n    aid: null,\n    metadata: null,\n    // cluster_index : null,\n    \"x-variable\": null,\n    \"y-variable\": null,\n    \"image-variable\": null,\n    \"color-variable\": null,\n    \"auto-scale\": true,\n    // clusters : [],\n    x_variables: [],\n    y_variables: [],\n    image_variables: [],\n    color_variables: [],\n    rating_variables: [],\n    category_variables: [],\n    selection: [],\n    hidden_simulations: [],\n    indices: []\n  },\n\n  _create: function _create() {\n    var self = this;\n\n    // if(self.options.clusters.length > 0)\n    // {\n    //   this.cluster_label = $(\"<label for='cluster-switcher'>Cluster:</label>\")\n    //     .appendTo(this.element)\n    //     ;\n    //   this.cluster_select = $(\"<select id='cluster-switcher' name='cluster-switcher' />\")\n    //     .change(function(){\n    //       self.element.trigger(\"cluster-selection-changed\", this.value);\n    //     })\n    //     .appendTo(this.element)\n    //     ;\n    // }\n\n    this.x_label = $(\"<label for='x-axis-switcher'>X Axis:</label>\").appendTo(this.element);\n    this.x_select = $(\"<select id='x-axis-switcher' name='x-axis-switcher' />\").change(function () {\n      self.element.trigger(\"x-selection-changed\", this.value);\n    }).appendTo(this.element);\n\n    this.y_label = $(\"<label for='y-axis-switcher'>Y Axis:</label>\").appendTo(this.element);\n    this.y_select = $(\"<select id='y-axis-switcher' name='y-axis-switcher' />\").change(function () {\n      self.element.trigger(\"y-selection-changed\", this.value);\n    }).appendTo(this.element);\n\n    if (this.options.image_variables != null && this.options.image_variables.length > 0) {\n      this.images_label = $(\"<label for='images-switcher'>Image Set:</label>\").appendTo(this.element);\n      this.images_select = $(\"<select id='images-switcher' name='images-switcher' />\").change(function () {\n        self.element.trigger(\"images-selection-changed\", this.value);\n      }).appendTo(this.element);\n    }\n\n    this.color_label = $(\"<label for='color-variable-switcher'>Point Color:</label>\").appendTo(this.element);\n    this.color_select = $(\"<select id='color-variable-switcher' name='color-variable-switcher' />\").change(function () {\n      self.element.trigger(\"color-selection-changed\", this.value);\n    }).appendTo(this.element);\n\n    this.selection_label = $(\"<label for='selection-control'>Selection:</label>\").appendTo(this.element);\n    this.selection_select = $(\"<select id='selection-control' name='selection-control' />\").change(function () {\n\n      var selectedOption = $('option:selected', this);\n      var label = selectedOption.attr(\"label\");\n      var text = selectedOption.text();\n      var value = this.value;\n      if (label == 'set' || label == 'clear') {\n        var variableLabel = selectedOption.parent().attr('label');\n        if (label == 'set') {\n          openSetValueDialog(variableLabel, value);\n        } else if (label == 'clear') {\n          openClearValueDialog(variableLabel, value);\n        }\n      } else if (value == 'hide') {\n        self.element.trigger(\"hide-selection\", self.options.selection);\n      } else if (value == 'show') {\n        self.element.trigger(\"show-selection\", self.options.selection);\n      } else if (value == 'pin') {\n        self.element.trigger(\"pin-selection\", self.options.selection);\n      }\n      this.selectedIndex = 0;\n    }).appendTo(this.element);\n\n    this.show_all_button = $(\"<button>Show All</button>\").click(function () {\n      self.element.trigger(\"show-all\");\n    }).appendTo(this.element);\n\n    this.auto_scale = $(\"<input id='auto-scale-option' name='auto-scale-option' value='auto-scale' type='checkbox' checked='true'>\").change(function () {\n      self.element.trigger(\"auto-scale\", this.checked);\n    }).appendTo(this.element);\n\n    this.auto_scale_label = $(\"<label for='auto-scale-option'>Auto Scale</label>\").appendTo(this.element);\n\n    this.csv_button = $(\"<button>Download Data Table</button>\").click(function () {\n      if (self.options.selection.length == 0 && self.options.hidden_simulations.length == 0) {\n        self._write_data_table();\n      } else {\n        openCSVSaveChoiceDialog();\n      }\n    }).appendTo(this.element);\n\n    $('#set-value-form').dialog({\n      modal: true,\n      autoOpen: false,\n      buttons: {\n        'Apply': function Apply() {\n          //$('#mainForm input#target').val( $(this).find('#widgetName').val() );\n          var variableIndex = $('input#variable-index', this).val();\n          var value = $('input#value', this).val().trim();\n          var numeric = self.options.metadata[\"column-types\"][variableIndex] != \"string\";\n          var valueValid = value.length > 0;\n          if (valueValid && numeric && isNaN(Number(value))) {\n            valueValid = false;\n          }\n          if (valueValid) {\n            self.element.trigger(\"set-value\", {\n              selection: self.options.selection,\n              variable: variableIndex,\n              value: numeric ? value : '\"' + value + '\"'\n            });\n            $(this).dialog('close');\n          } else {\n            var message = \"Please enter a value.\";\n            if (numeric) message = \"Please enter a numeric value.\";\n            $('.dialogErrorMessage', this).text(message);\n          }\n        },\n        'Cancel': function Cancel() {\n          $(this).dialog('close');\n        }\n      }\n    });\n\n    $('#clear-value-form').dialog({\n      modal: true,\n      autoOpen: false,\n      buttons: {\n        'Clear': function Clear() {\n          var variableIndex = $('input#variable-index', this).val();\n          self.element.trigger(\"set-value\", { selection: self.options.selection, variable: variableIndex, value: NaN });\n          $(this).dialog('close');\n        },\n        'Cancel': function Cancel() {\n          $(this).dialog('close');\n        }\n      }\n    });\n\n    self.save_choice_buttons = {\n      'Save The Whole Table': function SaveTheWholeTable() {\n        self._write_data_table();\n        //$(this)._write_data_table();  //what's the diff with above?\n        $(this).dialog('close');\n      },\n      'Save Visible Rows': function SaveVisibleRows() {\n        self._write_data_table(self._filterIndices());\n        //$(this)._write_data_table();  //what's the diff with above?\n        $(this).dialog('close');\n      },\n      'Save Selected Rows': function SaveSelectedRows() {\n        self._write_data_table(self.options.selection);\n        $(this).dialog('close');\n      },\n      'Cancel': function Cancel() {\n        $(this).dialog('close');\n      }\n    };\n\n    $('#csv-save-choice-form').dialog({\n      modal: true,\n      autoOpen: false,\n      buttons: self.save_choice_buttons\n    });\n\n    function openSetValueDialog(variable, variableIndex) {\n      $(\"#set-value-form #set-value-form-variable\").text(variable);\n      $(\"#set-value-form input\").attr('value', '');\n      $(\"#set-value-form input#variable-index\").attr('value', variableIndex);\n      $(\"#set-value-form .dialogErrorMessage\").empty();\n      $(\"#set-value-form\").dialog(\"open\");\n    }\n    function openClearValueDialog(variable, variableIndex) {\n      $(\"#clear-value-form #clear-value-form-variable\").text(variable);\n      $(\"#set-value-form input\").attr('value', '');\n      $(\"#clear-value-form input#variable-index\").attr('value', variableIndex);\n      $(\"#clear-value-form\").dialog(\"open\");\n    }\n    function openCSVSaveChoiceDialog() {\n      var txt = \"\";\n\n      if (self.options.selection.length > 0) {\n        txt += \"You have \" + self.options.selection.length + \" rows selected. \";\n      }\n      if (self.options.hidden_simulations.length > 0) {\n        var visibleRows = self.options.metadata['row-count'] - self.options.hidden_simulations.length;\n        txt += \"You have \" + visibleRows + \" rows visible. \";\n      }\n\n      txt += \"What would you like to do?\";\n      $(\"#csv-save-choice-form #csv-save-choice-label\").text(txt);\n\n      var buttons = $.extend({}, self.save_choice_buttons);\n      if (self.options.selection.length == 0) {\n        delete buttons[\"Save Selected Rows\"];\n      }\n      if (self.options.hidden_simulations.length == 0) {\n        delete buttons[\"Save Visible Rows\"];\n      }\n      $(\"#csv-save-choice-form\").dialog(\"option\", \"buttons\", buttons);\n\n      $(\"#csv-save-choice-form\").dialog(\"open\");\n    }\n\n    // if(self.options.clusters.length > 0)\n    // {\n    //   self._set_clusters();\n    // }\n    self._set_x_variables();\n    self._set_y_variables();\n    self._set_image_variables();\n    self._set_color_variables();\n    self._set_auto_scale();\n    self._set_selection_control();\n    self._set_show_all();\n  },\n\n  _write_data_table: function _write_data_table(selectionList) {\n    var self = this;\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"models/\" + self.options.mid + \"/arraysets/\" + self.options.aid + \"/data\",\n      data: JSON.stringify({ \"hyperchunks\": \"0/.../...\" }),\n      contentType: \"application/json\",\n      success: function success(result) {\n        self._write_csv(self._convert_to_csv(result, selectionList), self.options.model_name + \"_data_table.csv\");\n      },\n      error: function error(request, status, reason_phrase) {\n        window.alert(\"Error retrieving data table: \" + reason_phrase);\n      }\n    });\n  },\n\n  _write_csv: function _write_csv(csvData, defaultFilename) {\n    var self = this;\n    var D = document;\n    var a = D.createElement(\"a\");\n    var strMimeType = \"text/plain\";\n    var defaultFilename = defaultFilename || \"slycatDataTable.csv\";\n\n    //build download link:\n    a.href = \"data:\" + strMimeType + \";charset=utf-8,\" + encodeURIComponent(csvData); //encodeURIComponent() handles all special chars\n\n    if ('download' in a) {\n      //FF20, CH19\n      a.setAttribute(\"download\", defaultFilename);\n      a.innerHTML = \"downloading...\";\n      D.body.appendChild(a);\n      setTimeout(function () {\n        var e = D.createEvent(\"MouseEvent\");\n        e.initMouseEvent(\"click\", true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n        a.dispatchEvent(e);\n        D.body.removeChild(a);\n      }, 66);\n      return true;\n    } else {\n      // end if('download' in a)\n      console.log(\"++ firefox/chrome detect failed\");\n    }\n    /*\n        if (window.MSBlobBuilder) { // IE10\n          console.log( \"doing the IE10 stuff\" );\n          var bb = new MSBlobBuilder();\n          bb.append(strData);\n          return navigator.msSaveBlob(bb, strFileName);\n        }\n    \n        //do iframe dataURL download: (older W3)\n        console.log( \"doing the older W3 stuff\" );\n        var f = D.createElement(\"iframe\");\n        D.body.appendChild(f);\n        f.src = \"data:\" + (A[2] ? A[2] : \"application/octet-stream\") + (window.btoa ? \";base64\" : \"\") + \",\" + (window.btoa ? window.btoa : escape)(strData);\n        setTimeout(function() {\n          D.body.removeChild(f);\n        }, 333);\n        return true;\n    */\n  },\n\n  _convert_to_csv: function _convert_to_csv(array, sl) {\n    // Note that array.data is column-major:  array.data[0][*] is the first column\n    var self = this;\n    var selectionList = sl || [];\n    var numRows = array[0].length;\n    var numCols = array.length;\n    var rowMajorOutput = \"\";\n    var r, c, value;\n    // add the headers\n    for (c = 0; c < numCols; c++) {\n      rowMajorOutput += self.options.metadata[\"column-names\"][c] + \",\";\n    }\n    rowMajorOutput = rowMajorOutput.slice(0, -1); //rmv last comma\n    rowMajorOutput += \"\\n\";\n    // add the data\n    for (r = 0; r < numRows; r++) {\n      if (selectionList.length == 0 || selectionList.indexOf(r) > -1) {\n        for (c = 0; c < numCols; c++) {\n          value = array[c][r];\n          if (value === null) {\n            value = NaN;\n          }\n          rowMajorOutput += value + \",\";\n        }\n        rowMajorOutput = rowMajorOutput.slice(0, -1); //rmv last comma\n        rowMajorOutput += \"\\n\";\n      }\n    }\n    return rowMajorOutput;\n  },\n\n  // _set_clusters: function()\n  // { \n  //   var self = this;\n  //   this.cluster_select.empty();\n  //   for(var i = 0; i < this.options.clusters.length; i++) {\n  //     $(\"<option />\")\n  //       .text(this.options.clusters[i])\n  //       .attr(\"value\", i)\n  //       .attr(\"selected\", function(){\n  //         return self.options.cluster_index == i ? \"selected\" : false;\n  //       })\n  //       .appendTo(this.cluster_select)\n  //       ;\n  //   }\n  // },\n\n  _set_x_variables: function _set_x_variables() {\n    var self = this;\n    this.x_select.empty();\n    for (var i = 0; i < this.options.x_variables.length; i++) {\n      $(\"<option />\").text(this.options.metadata['column-names'][this.options.x_variables[i]]).attr(\"value\", this.options.x_variables[i]).attr(\"selected\", function () {\n        return self.options[\"x-variable\"] == self.options.x_variables[i] ? \"selected\" : false;\n      }).appendTo(this.x_select);\n    }\n  },\n\n  _set_y_variables: function _set_y_variables() {\n    var self = this;\n    this.y_select.empty();\n    for (var i = 0; i < this.options.y_variables.length; i++) {\n      $(\"<option />\").text(this.options.metadata['column-names'][this.options.y_variables[i]]).attr(\"value\", this.options.y_variables[i]).attr(\"selected\", function () {\n        return self.options[\"y-variable\"] == self.options.y_variables[i] ? \"selected\" : false;\n      }).appendTo(this.y_select);\n    }\n  },\n\n  _set_image_variables: function _set_image_variables() {\n    var self = this;\n    if (this.options.image_variables != null && this.options.image_variables.length > 0) {\n      this.images_select.empty();\n      for (var i = 0; i < this.options.image_variables.length; i++) {\n        $(\"<option />\").text(this.options.metadata['column-names'][this.options.image_variables[i]]).attr(\"value\", this.options.image_variables[i]).attr(\"selected\", function () {\n          return self.options[\"image-variable\"] == self.options.image_variables[i] ? \"selected\" : false;\n        }).appendTo(this.images_select);\n      }\n    }\n  },\n\n  _set_color_variables: function _set_color_variables() {\n    var self = this;\n    this.color_select.empty();\n    for (var i = 0; i < this.options.color_variables.length; i++) {\n      $(\"<option />\").text(this.options.metadata['column-names'][this.options.color_variables[i]]).attr(\"value\", this.options.color_variables[i]).attr(\"selected\", function () {\n        return self.options[\"color-variable\"] == self.options.color_variables[i] ? \"selected\" : false;\n      }).appendTo(this.color_select);\n    }\n  },\n\n  _set_auto_scale: function _set_auto_scale() {\n    var self = this;\n    this.auto_scale.prop(\"checked\", self.options[\"auto-scale\"]);\n  },\n\n  _set_selection_control: function _set_selection_control() {\n    var self = this;\n    this.selection_select.empty();\n    // Start with empty option\n    $(\"<option />\").text(\"Pick Action\").appendTo(this.selection_select);\n\n    // Add options for ratings and categories\n    for (var i = 0; i < this.options.rating_variables.length; i++) {\n      var optgroup = $(\"<optgroup />\").attr(\"label\", this.options.metadata['column-names'][this.options.rating_variables[i]]).appendTo(this.selection_select);\n      $(\"<option />\").text(\"Set\").attr(\"value\", this.options.rating_variables[i]).attr(\"label\", \"set\").appendTo(optgroup);\n      // Disabling clear functionality for ratings since it causes problems with nulls\n      // $(\"<option />\")\n      //   .text(\"Clear\")\n      //   .attr(\"value\", this.options.rating_variables[i])\n      //   .attr(\"label\", \"clear\")\n      //   .appendTo(optgroup)\n      //   ;\n    }\n\n    for (var i = 0; i < this.options.category_variables.length; i++) {\n      var optgroup = $(\"<optgroup />\").attr(\"label\", this.options.metadata['column-names'][this.options.category_variables[i]]).appendTo(this.selection_select);\n      $(\"<option />\").text(\"Set\").attr(\"value\", this.options.category_variables[i]).attr(\"label\", \"set\").appendTo(optgroup);\n      $(\"<option />\").text(\"Clear\").attr(\"value\", this.options.category_variables[i]).attr(\"label\", \"clear\").appendTo(optgroup);\n    }\n\n    // Finish with global actions\n    var scatterplotOptgroup = $(\"<optgroup />\").attr(\"label\", \"Scatterplot Points\").appendTo(this.selection_select);\n    $(\"<option />\").text(\"Hide\").attr(\"value\", \"hide\").appendTo(scatterplotOptgroup);\n    $(\"<option />\").text(\"Show\").attr(\"value\", \"show\").appendTo(scatterplotOptgroup);\n    $(\"<option />\").text(\"Pin\").attr(\"value\", \"pin\").appendTo(scatterplotOptgroup);\n\n    // var imagesOptgroup = $(\"<optgroup />\")\n    //   .attr(\"label\", \"Images\")\n    //   .appendTo(this.selection_select)\n    //   ;\n    // $(\"<option />\")\n    //   .text(\"Open\")\n    //   .attr(\"value\", \"open\")\n    //   .appendTo(imagesOptgroup)\n    //   ;\n    // $(\"<option />\")\n    //   .text(\"Close\")\n    //   .attr(\"value\", \"close\")\n    //   .appendTo(imagesOptgroup)\n    //   ;\n\n\n    // Set state\n    self._set_selection();\n  },\n\n  // _set_selected_cluster: function()\n  // {\n  //   var self = this;\n  //   this.cluster_select.val(self.options.cluster_index);\n  // },\n\n  _set_selected_x: function _set_selected_x() {\n    var self = this;\n    this.x_select.val(self.options[\"x-variable\"]);\n  },\n\n  _set_selected_y: function _set_selected_y() {\n    var self = this;\n    this.y_select.val(self.options[\"y-variable\"]);\n  },\n\n  _set_selected_image: function _set_selected_image() {\n    var self = this;\n    if (self.options[\"image-variable\"] != null && self.options.image_variables.length > 0) {\n      this.images_select.val(self.options[\"image-variable\"]);\n    }\n  },\n\n  _set_selected_color: function _set_selected_color() {\n    var self = this;\n    this.color_select.val(self.options[\"color-variable\"]);\n  },\n\n  _set_selection: function _set_selection() {\n    var self = this;\n    this.selection_select.prop(\"disabled\", this.options.selection.length == 0);\n    this.selection_label.toggleClass(\"disabled\", this.options.selection.length == 0);\n  },\n\n  _set_show_all: function _set_show_all() {\n    var self = this,\n        noneHidden = this.options.hidden_simulations.length == 0;\n    var titleText = 'Show All Hidden Scatterplot Points';\n    if (noneHidden) {\n      titleText = 'There are currently no hidden scatterplot points to show.';\n    }\n    this.show_all_button.prop(\"disabled\", noneHidden);\n    this.show_all_button.attr(\"title\", titleText);\n  },\n\n  // Remove hidden_simulations from indices\n  _filterIndices: function _filterIndices() {\n    var self = this;\n    var indices = self.options.indices;\n    var hidden_simulations = self.options.hidden_simulations;\n    var filtered_indices = self._cloneArrayBuffer(indices);\n    var length = indices.length;\n\n    // Remove hidden simulations and NaNs and empty strings\n    for (var i = length - 1; i >= 0; i--) {\n      var hidden = $.inArray(indices[i], hidden_simulations) > -1;\n      if (hidden) {\n        filtered_indices.splice(i, 1);\n      }\n    }\n\n    return filtered_indices;\n  },\n\n  // Clones an ArrayBuffer or Array\n  _cloneArrayBuffer: function _cloneArrayBuffer(source) {\n    // Array.apply method of turning an ArrayBuffer into a normal array is very fast (around 5ms for 250K) but doesn't work in WebKit with arrays longer than about 125K\n    // if(source.length > 1)\n    // {\n    //   return Array.apply( [], source );\n    // }\n    // else if(source.length == 1)\n    // {\n    //   return [source[0]];\n    // }\n    // return [];\n\n    // For loop method is much shower (around 300ms for 250K) but works in WebKit. Might be able to speed things up by using ArrayBuffer.subarray() method to make smallery arrays and then Array.apply those.\n    var clone = [];\n    for (var i = 0; i < source.length; i++) {\n      clone.push(source[i]);\n    }\n    return clone;\n  },\n\n  _setOption: function _setOption(key, value) {\n    var self = this;\n\n    //console.log(\"sparameter_image.variableswitcher._setOption()\", key, value);\n    this.options[key] = value;\n\n    // if(key == \"cluster_index\")\n    // {\n    //   self._set_selected_cluster();\n    // }\n    if (key == \"x-variable\") {\n      self._set_selected_x();\n    } else if (key == \"y-variable\") {\n      self._set_selected_y();\n    } else if (key == \"image-variable\") {\n      self._set_selected_image();\n    } else if (key == \"color-variable\") {\n      self._set_selected_color();\n    } else if (key == \"image_variables\") {\n      self._set_image_variables();\n    } else if (key == 'x_variables') {\n      self._set_x_variables();\n    } else if (key == 'y_variables') {\n      self._set_y_variables();\n    } else if (key == 'color_variables') {\n      self._set_color_variables();\n    } else if (key == 'selection') {\n      self._set_selection();\n    } else if (key == 'hidden_simulations') {\n      self._set_show_all();\n    }\n  }\n\n}); /* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\")))\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-controls.js?");

/***/ }),

/***/ "./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-dendrogram.js":
/*!***********************************************************************************************!*\
  !*** ./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-dendrogram.js ***!
  \***********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($) {\n\nvar _slycatServerRoot = __webpack_require__(/*! js/slycat-server-root */ \"./web-server/js/slycat-server-root.js\");\n\nvar _slycatServerRoot2 = _interopRequireDefault(_slycatServerRoot);\n\nvar _d = __webpack_require__(/*! js/d3.min */ \"./web-server/js/d3.min.js\");\n\nvar _d2 = _interopRequireDefault(_d);\n\nvar _slycatRemotesWebpack = __webpack_require__(/*! js/slycat-remotes-webpack */ \"./web-server/js/slycat-remotes-webpack.js\");\n\nvar remotes = _interopRequireWildcard(_slycatRemotesWebpack);\n\nvar _urijs = __webpack_require__(/*! urijs */ \"./node_modules/urijs/src/URI.js\");\n\nvar _urijs2 = _interopRequireDefault(_urijs);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\n///////////////////////////////////////////////////////////////////////////////////////////\n// HTML5 DOM dendrogram control, for use with the parameter-image model.\n\n$.widget(\"parameter_image.dendrogram\", {\n  options: {\n    clusters: [],\n    cluster: 0,\n    cluster_data: null,\n    collapsed_nodes: null,\n    expanded_nodes: null,\n    selected_nodes: null,\n    color_array: null,\n    colorscale: null,\n    data_table_index_array: null,\n    dendrogram_sort_order: true,\n    highlight: [],\n    hidden_simulations: [],\n    images: [],\n    square_size: 8,\n    square_border_size: 1,\n    selected_square_size: 16,\n    selected_square_border_size: 2,\n    hover_timeout: 1000,\n    image_cache: {},\n    cache_references: [{}],\n    // image_cache needs to be shared between dendrogram and scatterplot, thus it is passed inside an array to keep it in sync.\n    // http://api.jqueryui.com/jquery.widget/\n    // All options passed on init are deep-copied to ensure the objects can be modified later without affecting the widget. \n    // Arrays are the only exception, they are referenced as-is. \n    // This exception is in place to support data-binding, where the data source has to be kept as a reference.\n    login_dialog: null\n  },\n\n  _create: function _create() {\n    var self = this;\n\n    this.remotes = remotes.create_pool();\n    self.login_open = false;\n\n    self.options.image_cache = self.options.cache_references[0];\n\n    self.preview = $(\"<div id='image-preview'>\").on(\"mouseover\", function () {\n      self._clear_hover_timer();\n    }).on(\"mouseout\", function (d) {\n      self._close_preview();\n    }).on(\"click\", function (d) {\n      self._close_preview(true);\n    }).appendTo($(\"#scatterplot-pane\"));\n\n    self.preview_image = $(\"<img id='image-preview-image' />\").appendTo(self.preview);\n\n    this._set_cluster();\n  },\n\n  _set_cluster: function _set_cluster() {\n    var self = this;\n    self.container = _d2.default.select(\"#dendrogram-viewer\");\n\n    var cluster_data = this.options.cluster_data;\n    var collapsed_nodes = this.options.collapsed_nodes;\n    var expanded_nodes = this.options.expanded_nodes;\n    var selected_nodes = this.options.selected_nodes;\n\n    var linkage = cluster_data[\"linkage\"];\n    var input_indices = cluster_data[\"input-indices\"];\n    var exemplars = cluster_data[\"exemplars\"];\n    var subtrees = [];\n\n    for (var i = 0; i < input_indices.length; i++) {\n      subtrees.push({ \"node-index\": subtrees.length, leaves: 1, exemplar: exemplars[i], selected: false, \"image-index\": i, \"data-table-index\": input_indices[i] });\n    }\n    for (var i = 0; i < linkage.length; i++) {\n      subtrees.push({ \"node-index\": subtrees.length, children: [subtrees[linkage[i][0]], subtrees[linkage[i][1]]], leaves: linkage[i][3], exemplar: exemplars[i + input_indices.length], selected: false, \"image-index\": null, \"data-table-index\": null });\n    }\n\n    var padding = 20;\n    var diagram_width = this.element.parent().width() - padding - padding - 30;\n    var diagram_height = this.element.parent().height() - padding - padding;\n\n    var layout = _d2.default.layout.cluster().size([diagram_height, diagram_width]) // Width and height are transposed here because the layout defaults top-to-buttom.\n    .separation(function () {\n      return 1;\n    });\n\n    self.container.selectAll(\"g\").remove();\n\n    self.sortControl = $('<div id=\"dendrogram-sort-control\"></div>').appendTo('#dendrogram-pane').click(function () {\n      if (!$(this).hasClass(\"selected\")) {\n        self.options.dendrogram_sort_order = true;\n        self._set_dendrogram_sort_order_state();\n        self.element.trigger(\"sort-by-dendrogram-order\");\n      }\n    });\n    this._set_dendrogram_sort_order_state();\n\n    var vis = self.container.append(\"svg:g\").attr(\"transform\", \"translate(\" + padding + \",\" + padding + \")\");\n\n    var root = subtrees[subtrees.length - 1];\n    self.root = root;\n    root.x0 = diagram_height / 2;\n    root.y0 = 0;\n\n    // Compute the layout once for the entire tree so we can capture the max depth ...\n    var nodes = layout.nodes(root).reverse();\n    var max_depth = -1;\n    nodes.forEach(function (d) {\n      max_depth = Math.max(max_depth, d.depth);\n    });\n\n    // We have collapse/expand/selected node data. Let's go ahead and apply it.\n    if (collapsed_nodes != null || expanded_nodes != null || selected_nodes != null) {\n      nodes.forEach(function (d) {\n        if (selected_nodes != null && selected_nodes.length > 0) {\n          if (selected_nodes.indexOf(d[\"node-index\"]) > -1) {\n            d.selected = true;\n          }\n        }\n        if (collapsed_nodes && collapsed_nodes.indexOf(d[\"node-index\"]) > -1 && d.children) {\n          toggle(d);\n        } else if (expanded_nodes && expanded_nodes.indexOf(d[\"node-index\"]) > -1 && d._children) {\n          toggle(d);\n        }\n      });\n    }\n    // We have no data on expanded / collapsed nodes. Let's go ahead and just show the top four levels.\n    if (expanded_nodes == null && collapsed_nodes == null) {\n      // Start showing the top four levels of the tree ...\n      nodes.forEach(function (d, index) {\n        if (d.depth == 3) {\n          toggle(d);\n        }\n      });\n    }\n    // We have no selected node data. Let's select the root node.\n    if (selected_nodes == null) {\n      select_node(self, root, true);\n    } else {\n      // We had selected node data, so let's style them and trigger the node-selection-changed event\n      self._style_selected_nodes();\n      self._color_links();\n      // Find all selected nodes\n      var selection = [];\n      find_selected_nodes(root, selection);\n      self.element.trigger(\"node-selection-changed\", { node: null, skip_bookmarking: true, selection: selection });\n    }\n\n    // Initial update for the diagram ...\n    update_subtree(root, true);\n\n    // Helper function that draws dendrogram links with right-angles.\n    function path(d, i) {\n      if (d.target._children) {\n        return \"M\" + d.source.y + \",\" + d.source.x + \"V\" + d.target.x + \"H\" + diagram_width;\n      }\n      return \"M\" + d.source.y + \",\" + d.source.x + \"V\" + d.target.x + \"H\" + d.target.y;\n    }\n\n    function find_selected_nodes(d, selection) {\n      if (d.selected) selection.push({ \"node-index\": d[\"node-index\"], \"image-index\": d[\"image-index\"], \"data-table-index\": d[\"data-table-index\"] });\n      if (d.children) for (var i = 0; i < d.children.length; i++) {\n        find_selected_nodes(d.children[i], selection);\n      }if (d._children) for (var i = 0; i < d._children.length; i++) {\n        find_selected_nodes(d._children[i], selection);\n      }\n    }\n\n    // Keeping track of already selected nodes becomes too complicated with multi selection\n    //var last_selected_node = null;\n    function select_node(context, d, skip_bookmarking) {\n      // Keeping track of already selected nodes becomes too complicated with multi selection\n      // if(last_selected_node === d)\n      //   return;\n      // last_selected_node = d;\n\n      function select_subtree(d) {\n        d.selected = true;\n        if (d.children) for (var i = 0; i < d.children.length; i++) {\n          select_subtree(d.children[i]);\n        }if (d._children) for (var i = 0; i < d._children.length; i++) {\n          select_subtree(d._children[i]);\n        }\n      }\n\n      // Mark this node and all its children as selected\n      select_subtree(d);\n\n      // Sets the \"selected\" class on all selected nodes, thus coloring the circles in blue\n      context._style_selected_nodes();\n\n      // Colors the lines between the nodes to show what's selected\n      context._color_links();\n\n      // Find all selected nodes\n      var selection = [];\n      find_selected_nodes(root, selection);\n      context.options.selected_nodes = context._getNodeIndexes(selection);\n\n      context.element.trigger(\"node-selection-changed\", { node: d, skip_bookmarking: skip_bookmarking, selection: selection });\n    }\n\n    function unselect_node(context, d, skip_bookmarking) {\n      function unselect_subtree(d) {\n        d.selected = false;\n        if (d.children) for (var i = 0; i < d.children.length; i++) {\n          unselect_subtree(d.children[i]);\n        }if (d._children) for (var i = 0; i < d._children.length; i++) {\n          unselect_subtree(d._children[i]);\n        }\n      }\n\n      // Mark this node and all its children as unselected\n      unselect_subtree(d);\n\n      // Prunes selected nodes that have been orphaned\n      prune_tree(root);\n\n      // Sets the \"selected\" class on all selected nodes, thus coloring the circles in blue\n      context._style_selected_nodes();\n\n      // Colors the lines between the nodes to show what's selected\n      context._color_links();\n\n      // Find all selected nodes\n      var selection = [];\n      find_selected_nodes(root, selection);\n      context.options.selected_nodes = context._getNodeIndexes(selection);\n\n      context.element.trigger(\"node-selection-changed\", { node: d, skip_bookmarking: skip_bookmarking, selection: selection });\n    }\n\n    function prune_tree(d) {\n      if (d.children || d._children) {\n        // This is a branch node\n        if (!d.selected) {\n          // Branch node is unselected, so just process its children\n          if (d.children) $.each(d.children, function (index, subtree) {\n            prune_tree(subtree);\n          });\n          if (d._children) $.each(d._children, function (index, subtree) {\n            prune_tree(subtree);\n          });\n          return false;\n        } else {\n          //Branch node is selected, so process its children and set its selected state accordingly\n          var selected_state = false;\n          var child_selected_state = false;\n          if (d.children) $.each(d.children, function (index, subtree) {\n            child_selected_state = prune_tree(subtree);\n            selected_state = selected_state || child_selected_state;\n          });\n          if (d._children) $.each(d._children, function (index, subtree) {\n            child_selected_state = prune_tree(subtree);\n            selected_state = selected_state || child_selected_state;\n          });\n          d.selected = selected_state;\n          return selected_state;\n        }\n      } else {\n        // This is a leaf node\n        if (d.selected) return true;else return false;\n      }\n    }\n\n    function update_subtree(source, skip_bookmarking) {\n      var duration = _d2.default.event && _d2.default.event.altKey ? 5000 : 500;\n\n      // Compute the new layout.\n      var nodes = layout.nodes(root).reverse();\n\n      // Normalize for fixed-depth.\n      nodes.forEach(function (d) {\n        if (d.children || d._children) d.y = d.depth * (diagram_width / max_depth);\n      });\n\n      // Update the nodes.\n      var node = vis.selectAll(\"g.node\").data(nodes, function (d) {\n        return d[\"node-index\"];\n      });\n\n      // Expand all child nodes up to a certain level, collapse all child when level is rached\n      function expandUpToLevel(d, level) {\n        if (d.children) {\n          for (var i = 0; i < d.children.length; i++) {\n            // If this child is at the correct depth and it is expanded, we collapse it\n            if (d.children[i].depth == level && d.children[i].children) {\n              toggle(d.children[i]);\n            }\n            // If this child is above the correct depth and it is collapsed, we expand it and process its children\n            else if (d.children[i].depth < level && d.children[i]._children) {\n                toggle(d.children[i]);\n                expandUpToLevel(d.children[i], level);\n              }\n              // If this child is above the correct depth and it is expanded, we just process its children\n              else if (d.children[i].depth < level && d.children[i].children) {\n                  expandUpToLevel(d.children[i], level);\n                }\n          }\n        }\n        // If d has no children, we do nothing\n        else {\n            return;\n          }\n      }\n\n      // Create new nodes at the parent's previous position.\n      var node_enter = node.enter().append(\"svg:g\").attr(\"class\", \"node\").classed(\"selected\", function (d) {\n        return d.selected;\n      }).attr(\"transform\", function (d) {\n        return \"translate(\" + source.y0 + \",\" + source.x0 + \")\";\n      }).style(\"opacity\", 1e-6);\n\n      // Triangle\n      var node_subtree = node_enter.append(\"svg:g\").attr(\"class\", \"subtree\").style(\"opacity\", 1e-6).style(\"display\", function (d) {\n        return d.leaves > 1 ? \"inline\" : \"none\";\n      }).on(\"click\", function (d) {\n        self._close_preview(true);\n        toggle(d);\n        // Change expandThisFar to however deep below the target node you want to expand\n        var expandThisFar = 9999;\n        expandUpToLevel(d, d.depth + expandThisFar);\n        update_subtree(d);\n      });\n\n      node_subtree.append(\"svg:path\").attr(\"class\", \"subtree-glyph\").attr(\"title\", \"Expand all\").attr(\"alt\", \"Expand all\").attr(\"d\", \"M 0 0 L 40 -13 L 40 13 Z\").style(\"fill\", \"url(#subtree-gradient)\");\n\n      // Due to a bug in Firefox, we cannot use css to change the fill style on path.subtree-glyph from above.\n      // Instead we'll use css to display and hide this path.filled-glyph\n      node_subtree.append(\"svg:path\").attr(\"class\", \"filled-glyph\").attr(\"title\", \"Expand all\").attr(\"alt\", \"Expand all\").attr(\"d\", \"M 0 0 L 40 -13 L 40 13 Z\").style(\"fill\", \"#7767b0\");\n\n      node_subtree.append(\"svg:text\").attr(\"x\", 28).attr(\"dy\", \".4em\").attr(\"text-anchor\", \"middle\").attr(\"title\", \"Expand all\").attr(\"alt\", \"Expand all\").text(function (d) {\n        return d.leaves;\n      });\n\n      node_subtree.append(\"svg:text\").attr(\"x\", -9).attr(\"dy\", -5).attr(\"text-anchor\", \"middle\").text(\"+\").style(\"fill\", \"black\").on(\"click\", function (d) {\n        self._close_preview(true);\n        toggle(d);\n        // Change expandThisFar to however deep below the target node you want to expand\n        var expandThisFar = 2;\n        expandUpToLevel(d, d.depth + expandThisFar);\n        update_subtree(d);\n        _d2.default.event.stopPropagation();\n      });\n\n      // Circle\n      var node_glyph = node_enter.append(\"svg:g\").attr(\"class\", \"glyph\").on(\"click\", function (d) {\n        self._close_preview(true);\n        if (_d2.default.event.ctrlKey || _d2.default.event.metaKey) {\n          if (d.selected) {\n            unselect_node(self, d);\n          } else {\n            select_node(self, d);\n          }\n        } else {\n          // Clear previous selection if user didn't Ctrl+click\n          $.each(subtrees, function (index, subtree) {\n            subtree.selected = false;\n          });\n          select_node(self, d);\n        }\n      });\n\n      node_glyph.append(\"svg:circle\").attr(\"r\", 4.5).style(\"cursor\", \"pointer\").style(\"fill\", function (d) {\n        return d.children || d._children ? \"#dbd9eb\" : \"white\";\n      });\n\n      node_glyph.append(\"svg:text\").attr(\"x\", -9).attr(\"dy\", 13).attr(\"text-anchor\", \"middle\").text(\"–\").style(\"fill\", \"black\").style(\"display\", function (d) {\n        return d._children || !d.children && !d._children ? \"none\" : \"inline\";\n      }).on(\"click\", function (d) {\n        self._close_preview(true);\n        toggle(d);\n        update_subtree(d);\n        _d2.default.event.stopPropagation();\n      });\n\n      // Square\n      var vertical_lift = -(self.options.square_size / 2) - self.options.square_border_size;\n      var selected_vertical_lift = -(self.options.selected_square_size / 2) - self.options.selected_square_border_size;\n      var trans_endpoint = \"translate(25, 0)\";\n      var trans_notendpoint = \"translate(65, 0)\";\n\n      var node_square = node_enter.append(\"svg:g\").attr(\"class\", \"square\").attr(\"transform\", function (d) {\n        return d.leaves > 1 ? trans_notendpoint : trans_endpoint;\n      }) // Move to the right according to whether it's an endpoint\n      .style(\"opacity\", 1e-6).style(\"display\", \"none\");\n\n      var node_square_rect = node_square.append(\"svg:rect\").style(\"stroke\", \"black\").style(\"fill\", function (d, i) {\n        if (self.options.colorscale !== null && self.options.color_array != null) {\n          var index = d[\"data-table-index\"];\n          if (index != null) {\n            var value = self.options.color_array[index];\n            if (value != null) return self.options.colorscale(value);else return $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n          } else return \"black\";\n        } else {\n          return \"black\";\n        }\n      }).classed(\"nullValue\", function (d, i) {\n        if (d[\"data-table-index\"] == null || d[\"data-table-index\"] != null && self.options.color_array[d[\"data-table-index\"]] !== null) return false;else return true;\n      }).on(\"click\", function (d) {\n        self._close_preview(true);\n        self._handle_highlight(d, _d2.default.event, this);\n      });\n\n      self._set_highlight();\n\n      // Transition new nodes to their final position.\n      var node_update = node.transition().duration(duration).attr(\"transform\", function (d) {\n        return \"translate(\" + (d._children ? diagram_width - 39 : d.y + 1) + \",\" + d.x + \")\"; // Draws extended horizontal lines for collapsed nodes\n      }).style(\"opacity\", 1.0);\n\n      node.classed(\"leaf\", function (d) {\n        return d._children || !d.children && !d._children;\n      });\n      node.filter(\".leaf\").on(\"mouseover\", function (d) {\n        self._open_preview(d);\n      }).on(\"mouseout\", function (d) {\n        self._close_preview();\n      });\n\n      node_update.select(\".subtree\").style(\"opacity\", function (d) {\n        return d._children ? 1.0 : 1e-6;\n      }).style(\"display\", function (d) {\n        return d._children ? \"inline\" : \"none\";\n      });\n\n      // Need to re-assign fill style to get around this firefox bug: https://bugzilla.mozilla.org/show_bug.cgi?id=652991\n      // It only seems to affect fill gradients and only when the URI changes, like it does for us with bookmarking.\n      node_update.select(\".subtree-glyph\").style(\"fill\", \"url(#subtree-gradient)\");\n\n      node_update.select(\".square\").style(\"opacity\", function (d) {\n        return d._children || !d.children && !d._children ? 1.0 : 1e-6;\n      }).each(\"end\", function () {\n        _d2.default.select(this).style(\"display\", function (d) {\n          return d._children || !d.children && !d._children ? \"inline\" : \"none\";\n        });\n      });\n\n      node_update.select(\".glyph text\").style(\"display\", function (d) {\n        return d._children || !d.children && !d._children ? \"none\" : \"inline\";\n      });\n\n      // Transition exiting nodes to the parent's new position.\n      var node_exit = node.exit().transition().duration(duration).attr(\"transform\", function (d) {\n        return \"translate(\" + source.y + \",\" + source.x + \")\";\n      }).style(\"opacity\", 1e-6).remove();\n\n      node_exit.select(\".square\").each(\"start\", function () {\n        _d2.default.select(this).style(\"display\", \"none\");\n      });\n\n      // Update the links.\n      var link = vis.selectAll(\"path.link\").data(layout.links(nodes), function (d) {\n        return d.target[\"node-index\"];\n      });\n\n      // Enter any new links at the parent's previous position.\n      link.enter().insert(\"svg:path\", \"g\").attr(\"class\", \"link\").attr(\"d\", function (d) {\n        var o = { x: source.x0, y: source.y0 };\n        return path({ source: o, target: o });\n      }).transition().duration(duration).attr(\"d\", path);\n\n      // Transition new links to their new position.\n      link.transition().duration(duration).attr(\"d\", path);\n\n      // Transition exiting links to the parent's new position.\n      link.exit().transition().duration(duration).attr(\"d\", function (d) {\n        var o = { x: source.x, y: source.y };\n        return path({ source: o, target: o });\n      }).remove();\n\n      self._color_links();\n\n      // Stash the old positions for transition.\n      nodes.forEach(function (d) {\n        d.x0 = d.x;\n        d.y0 = d.y;\n      });\n\n      // Bookmark expanded and collapsed nodes\n      if (!skip_bookmarking) {\n        var findExpandedAndCollapsedNodes = function findExpandedAndCollapsedNodes(d) {\n          // If this node is expanded, add its node-index to the expanded array\n          if (d.children) {\n            expanded.push(d[\"node-index\"]);\n            // Recursively call this function for each child to capture any collapsed and expanded ones\n            for (var i = 0; i < d.children.length; i++) {\n              findExpandedAndCollapsedNodes(d.children[i]);\n            }\n          }\n          // Otherwise if this node is collapsed, add its node-index to the collapsed array\n          else if (d._children) {\n              collapsed.push(d[\"node-index\"]);\n            }\n        };\n\n        var expanded = [];\n        var collapsed = [];\n\n        findExpandedAndCollapsedNodes(root);\n        self.options.expanded_nodes = expanded;\n        self.options.collapsed_nodes = collapsed;\n        self.element.trigger(\"expanded-collapsed-nodes-changed\", { expanded: expanded, collapsed: collapsed });\n      }\n    }\n\n    // Toggle children.\n    function toggle(d) {\n      if (d.children) {\n        d._children = d.children;\n        d.children = null;\n      } else {\n        d.children = d._children;\n        d._children = null;\n      }\n\n      self.element.trigger(\"node-toggled\", d);\n    }\n  },\n\n  _clear_hover_timer: function _clear_hover_timer() {\n    var self = this;\n    if (self.hover_timer) {\n      window.clearTimeout(self.hover_timer);\n      self.hover_timer = null;\n    }\n  },\n\n  _open_preview: function _open_preview(image) {\n    var self = this;\n\n    // Do nothing if we don't have an exemplar to show\n    if (image.exemplar == undefined) {\n      return;\n    }\n\n    self._clear_hover_timer();\n\n    var image_uri = self.options.images[image.exemplar];\n\n    // Open new preview only if we are not showing it already\n    if (self.target_image != image_uri) {\n      self.target_image = image_uri;\n      self.preview_image.hide();\n      self.preview.show();\n      self._display_image(image_uri);\n    }\n  },\n\n  _display_image: function _display_image(image_uri) {\n    var self = this;\n\n    // If the image is in the cache, display it\n    if (image_uri in self.options.image_cache) {\n      var url_creator = window.URL || window.webkitURL;\n      var image_url = url_creator.createObjectURL(self.options.image_cache[image_uri]);\n      self.preview_image.attr('src', image_url);\n      self.preview_image.show();\n      return;\n    }\n\n    if (!self.login_open) {\n      self.login_open = true;\n      var uri = (0, _urijs2.default)(image_uri);\n      self.remotes.get_remote({\n        hostname: uri.hostname(),\n        title: \"Login to \" + uri.hostname(),\n        message: \"Loading \" + uri.pathname(),\n        cancel: function cancel() {\n          self.login_open = false;\n        },\n        success: function success(hostname) {\n          var xhr = new XMLHttpRequest();\n          var api = \"/file\";\n\n          // xhr.image = image;\n          //Double encode to avoid cherrypy's auto unencode in the controller\n          xhr.open(\"GET\", _slycatServerRoot2.default + \"remotes/\" + hostname + api + uri.pathname(), true);\n          xhr.responseType = \"arraybuffer\";\n          xhr.onload = function (e) {\n            // If we get 404, the remote session no longer exists because it timed-out.\n            // If we get 500, there was an internal error communicating to the remote host.\n            // Either way, delete the cached session and create a new one.\n            if (this.status == 404 || this.status == 500) {\n              self.remotes.delete_remote(uri.hostname());\n              self._open_images(images);\n              return;\n            }\n            // If we get 400, it means that the session is good and we're\n            // communicating with the remote host, but something else went wrong\n            // (probably file permissions issues).\n            if (this.status == 400) {\n              console.log(this);\n              console.log(this.getAllResponseHeaders());\n              var message = this.getResponseHeader(\"slycat-message\");\n              var hint = this.getResponseHeader(\"slycat-hint\");\n\n              if (message && hint) {\n                window.alert(message + \"\\n\\n\" + hint);\n              } else if (message) {\n                window.alert(message);\n              } else {\n                window.alert(\"Error loading image \" + this.image_uri + \": \" + this.statusText);\n              }\n              return;\n            } else {\n              // We received the image, so put it in the cache and start-over.\n              var array_buffer_view = new Uint8Array(this.response);\n              var blob = new Blob([array_buffer_view], { type: this.getResponseHeader('content-type') });\n              self.options.image_cache[image_uri] = blob;\n              self._display_image(image_uri);\n              return;\n            }\n          };\n\n          xhr.send();\n          self.login_open = false;\n        }\n      });\n    }\n  },\n\n  _close_preview: function _close_preview(immediate) {\n    var self = this;\n\n    if (immediate) {\n      close_preview();\n    } else {\n      self.hover_timer = window.setTimeout(function () {\n        close_preview();\n      }, self.options.hover_timeout);\n    }\n\n    function close_preview() {\n      self.target_image = null;\n      self.preview.hide();\n      self.preview_image.hide();\n    }\n  },\n\n  _set_color: function _set_color() {\n    var self = this;\n\n    this.container.selectAll(\"g.square rect\").style(\"fill\", function (d, i) {\n      var index = d[\"data-table-index\"];\n      if (index != null) {\n        var value = self.options.color_array[index];\n        if (value != null) return self.options.colorscale(value);else return $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n      } else return \"black\";\n    }).classed(\"nullValue\", function (d, i) {\n      if (d[\"data-table-index\"] == null || d[\"data-table-index\"] != null && self.options.color_array[d[\"data-table-index\"]] !== null) return false;else return true;\n    });\n  },\n\n  _set_highlight: function _set_highlight() {\n    var self = this;\n\n    var offset = -(self.options.square_size / 2) - self.options.square_border_size / 2;\n    var selected_offset = -(self.options.selected_square_size / 2) - self.options.selected_square_border_size / 2;\n    var trans = \"translate(\" + offset + \", \" + offset + \")\";\n    var trans_selected = \"translate(\" + selected_offset + \", \" + selected_offset + \")\";\n\n    checkChildren(self.root);\n\n    this.container.selectAll(\"g.square\").classed(\"highlight\", function (d, i) {\n      if (d.highlight) return true;else return false;\n    });\n\n    this.container.selectAll(\"g.square rect\").attr(\"width\", function (d) {\n      return d.highlight ? self.options.selected_square_size : self.options.square_size;\n    }).attr(\"height\", function (d) {\n      return d.highlight ? self.options.selected_square_size : self.options.square_size;\n    }).style(\"stroke-width\", function (d) {\n      return d.highlight ? self.options.selected_square_border_size : self.options.square_border_size;\n    }).attr(\"transform\", function (d) {\n      return d.highlight ? trans_selected : trans; // Move up according to selected or not\n    });\n\n    // Checks if target or any of its children are highlighted\n    function checkChildren(target) {\n      var highlight = false;\n      if (target.children) {\n        for (var i = 0; i < target.children.length; i++) {\n          if (checkChildren(target.children[i])) {\n            highlight = true;\n          }\n        }\n        target.highlight = highlight;\n      } else if (target._children) {\n        for (var i = 0; i < target._children.length; i++) {\n          if (checkChildren(target._children[i])) {\n            highlight = true;\n          }\n        }\n        target.highlight = highlight;\n      } else if (target[\"data-table-index\"] != null && self.options.highlight.indexOf(target[\"data-table-index\"]) > -1) {\n        target.highlight = true;\n        highlight = true;\n      } else {\n        target.highlight = false;\n        highlight = false;\n      }\n      return highlight;\n    }\n  },\n\n  _handle_highlight: function _handle_highlight(d, event, element) {\n    var self = this;\n    var data_table_indexes = getDataTableIndexesFromChildren(d);\n\n    if (!event.ctrlKey && !_d2.default.event.metaKey) {\n      self.options.highlight = data_table_indexes;\n    } else {\n      if (d.highlight) {\n        for (var i = 0; i < data_table_indexes.length; i++) {\n          var index = self.options.highlight.indexOf(data_table_indexes[i]);\n          if (index > -1) {\n            self.options.highlight.splice(index, 1);\n          }\n        }\n      } else {\n        for (var i = 0; i < data_table_indexes.length; i++) {\n          if (self.options.highlight.indexOf(data_table_indexes[i]) == -1) self.options.highlight.push(data_table_indexes[i]);\n        }\n      }\n    }\n    self._set_highlight();\n    self.element.trigger(\"selection-changed\", [self.options.highlight]);\n\n    function getDataTableIndexesFromChildren(target) {\n      var data_table_indexes = [];\n      if (target.children) {\n        for (var i = 0; i < target.children.length; i++) {\n          if (target.children[i][\"data-table-index\"] != null) data_table_indexes.push(target.children[i][\"data-table-index\"]);else data_table_indexes = data_table_indexes.concat(getDataTableIndexesFromChildren(target.children[i]));\n        }\n      } else if (target._children) {\n        for (var i = 0; i < target._children.length; i++) {\n          if (target._children[i][\"data-table-index\"] != null) data_table_indexes.push(target._children[i][\"data-table-index\"]);else data_table_indexes = data_table_indexes.concat(getDataTableIndexesFromChildren(target._children[i]));\n        }\n      } else if (target[\"data-table-index\"] != null) data_table_indexes.push(target[\"data-table-index\"]);\n\n      return data_table_indexes;\n    }\n  },\n\n  _set_dendrogram_sort_order_state: function _set_dendrogram_sort_order_state() {\n    var self = this;\n    self.sortControl.attr(\"title\", function (index, attr) {\n      return self.options.dendrogram_sort_order ? \"Inputs are sorted in dendrogram order\" : \"Sort inputs in dendrogram order\";\n    }).toggleClass(\"selected\", self.options.dendrogram_sort_order);\n  },\n\n  _set_hidden_simulations: function _set_hidden_simulations() {\n    //console.log(\"setting hidden simulations in dendrogram\");\n    var self = this;\n\n    var selection = [];\n\n    update_selected_nodes(self.root, selection);\n\n    self.options.selected_nodes = self._getNodeIndexes(selection);\n\n    self._style_selected_nodes();\n    self._color_links();\n\n    self.element.trigger(\"node-selection-changed\", { node: null, skip_bookmarking: false, selection: selection });\n\n    function update_selected_nodes(d, selection) {\n      var image_index = d[\"image-index\"];\n      if (image_index != null) {\n        if (self.options.hidden_simulations.indexOf(image_index) > -1) {\n          d.selected = false;\n        } else {\n          d.selected = true;\n          selection.push({ \"node-index\": d[\"node-index\"], \"image-index\": d[\"image-index\"], \"data-table-index\": d[\"data-table-index\"] });\n        }\n      }\n      if (d.children) for (var i = 0; i < d.children.length; i++) {\n        update_selected_nodes(d.children[i], selection);\n      }if (d._children) for (var i = 0; i < d._children.length; i++) {\n        update_selected_nodes(d._children[i], selection);\n      }\n    }\n  },\n\n  _style_selected_nodes: function _style_selected_nodes() {\n    var self = this;\n    self.container.selectAll(\".node\").classed(\"selected\", function (d) {\n      return d.selected;\n    });\n  },\n\n  _color_links: function _color_links() {\n    var self = this;\n    self.container.selectAll(\"path.link\").attr(\"style\", function (d) {\n      if (checkChildren(d.target)) {\n        if (d.source.selected) return \"stroke: black;\";else return \"stroke: #646464;\";\n      }\n    });\n\n    // Checks if target or any of its children are selected\n    function checkChildren(target) {\n      if (target.selected) return true;else if (target.children) {\n        for (var i = 0; i < target.children.length; i++) {\n          if (checkChildren(target.children[i])) return true;\n        }\n      } else if (target._children) {\n        for (var i = 0; i < target._children.length; i++) {\n          if (checkChildren(target._children[i])) return true;\n        }\n      }\n      return false;\n    }\n  },\n\n  _getNodeIndexes: function _getNodeIndexes(nodes) {\n    var node_indexes = [];\n    var node_index = null;\n\n    for (var i = 0; i < nodes.length; i++) {\n      node_index = nodes[i][\"node-index\"];\n      if (node_index != null) node_indexes.push(node_index);\n    }\n\n    return node_indexes;\n  },\n\n  resize_canvas: function resize_canvas() {\n    this._set_cluster();\n  },\n\n  _setOption: function _setOption(key, value) {\n    //console.log(\"timeseries.dendrogram._setOption()\", key, value);\n    this.options[key] = value;\n\n    if (key == \"cluster_data\") {\n      this._set_cluster();\n    } else if (key == \"color-options\") {\n      this.options.color_array = value.color_array;\n      this.options.colorscale = value.colorscale;\n      this._set_color();\n    } else if (key == \"colorscale\") {\n      this._set_color();\n    } else if (key == \"dendrogram_sort_order\") {\n      this._set_dendrogram_sort_order_state();\n    } else if (key == \"highlight\") {\n      if (value == undefined) this.options.highlight = [];\n      this._set_highlight();\n    } else if (key == \"hidden_simulations\") {\n      this._set_hidden_simulations();\n    } else if (key == \"images\") {\n      // We don't need to do anything when images are updated, because they are always followed by cluster_data, which triggers a refresh\n    }\n  }\n});\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\")))\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-dendrogram.js?");

/***/ }),

/***/ "./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-scatterplot.js":
/*!************************************************************************************************!*\
  !*** ./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-scatterplot.js ***!
  \************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($) {\n\nvar _slycatServerRoot = __webpack_require__(/*! js/slycat-server-root */ \"./web-server/js/slycat-server-root.js\");\n\nvar _slycatServerRoot2 = _interopRequireDefault(_slycatServerRoot);\n\nvar _d = __webpack_require__(/*! js/d3.min */ \"./web-server/js/d3.min.js\");\n\nvar _d2 = _interopRequireDefault(_d);\n\nvar _urijs = __webpack_require__(/*! urijs */ \"./node_modules/urijs/src/URI.js\");\n\nvar _urijs2 = _interopRequireDefault(_urijs);\n\nvar _slycatRemotesWebpack = __webpack_require__(/*! js/slycat-remotes-webpack */ \"./web-server/js/slycat-remotes-webpack.js\");\n\nvar remotes = _interopRequireWildcard(_slycatRemotesWebpack);\n\n__webpack_require__(/*! jquery-ui */ \"./node_modules/jquery-ui/jquery-ui.js\");\n\n__webpack_require__(/*! js/slycat-login-controls-webpack */ \"./web-server/js/slycat-login-controls-webpack.js\");\n\nvar _pin = __webpack_require__(/*! ../img/pin.png */ \"./web-server/plugins/slycat-parameter-image-plus-model/img/pin.png\");\n\nvar _pin2 = _interopRequireDefault(_pin);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n$.widget(\"parameter_image.scatterplot\", {\n  options: {\n    width: 300,\n    height: 300,\n    pick_distance: 3,\n    drag_threshold: 3,\n    indices: [],\n    x_label: \"X Label\",\n    y_label: \"Y Label\",\n    v_label: \"V Label\",\n    x: [],\n    y: [],\n    v: [],\n    x_string: false,\n    y_string: false,\n    v_string: false,\n    images: [],\n    selection: [],\n    colorscale: _d2.default.scale.linear().domain([-1, 0, 1]).range([\"blue\", \"white\", \"red\"]),\n    border: 25,\n    open_images: [],\n    gradient: null,\n    hidden_simulations: [],\n    filtered_indices: [],\n    filtered_selection: [],\n    filtered_x: [],\n    filtered_y: [],\n    filtered_v: [],\n    scale_x: [],\n    scale_y: [],\n    scale_v: [],\n    \"auto-scale\": true,\n    canvas_square_size: 8,\n    canvas_square_border_size: 1,\n    canvas_selected_square_size: 16,\n    canvas_selected_square_border_size: 2,\n    pinned_width: 200,\n    pinned_height: 200,\n    hover_time: 250,\n    image_cache: {},\n    cache_references: [{}],\n    // image_cache needs to be shared between dendrogram and scatterplot, thus it is passed inside an array to keep it in sync.\n    // http://api.jqueryui.com/jquery.widget/\n    // All options passed on init are deep-copied to ensure the objects can be modified later without affecting the widget.\n    // Arrays are the only exception, they are referenced as-is.\n    // This exception is in place to support data-binding, where the data source has to be kept as a reference.\n    login_dialog: null\n  },\n\n  _create: function _create() {\n    var self = this;\n\n    this.remotes = remotes.create_pool();\n    self.login_open = false;\n\n    if (self.options[\"auto-scale\"]) {\n      self.options.filtered_x = self._filterValues(self.options.x);\n      self.options.filtered_y = self._filterValues(self.options.y);\n      self.options.filtered_v = self._filterValues(self.options.v);\n      self.options.scale_x = self.options.filtered_x;\n      self.options.scale_y = self.options.filtered_y;\n      self.options.scale_v = self.options.filtered_v;\n    } else {\n      self.options.scale_x = self.options.x;\n      self.options.scale_y = self.options.y;\n      self.options.scale_v = self.options.v;\n    }\n\n    self.hover_timer = null;\n    self.close_hover_timer = null;\n\n    self.hover_timer_canvas = null;\n\n    self.opening_image = null;\n    self.state = \"\";\n    self.start_drag = null;\n    self.current_drag = null;\n    self.end_drag = null;\n\n    // Setup the scatterplot ...\n    self.svg = _d2.default.select(self.element.get(0)).append(\"svg\");\n    self.x_axis_layer = self.svg.append(\"g\").attr(\"class\", \"x-axis\");\n    self.y_axis_layer = self.svg.append(\"g\").attr(\"class\", \"y-axis\");\n    self.legend_layer = self.svg.append(\"g\").attr(\"class\", \"legend\");\n    self.legend_axis_layer = self.legend_layer.append(\"g\").attr(\"class\", \"legend-axis\");\n    self.datum_layer = self.svg.append(\"g\").attr(\"class\", \"datum-layer\");\n    self.selected_layer = self.svg.append(\"g\").attr(\"class\", \"selected-layer\");\n    self.canvas_datum = _d2.default.select(self.element.get(0)).append(\"canvas\").style({ 'position': 'absolute' }).node();\n    self.canvas_datum_layer = self.canvas_datum.getContext(\"2d\");\n    self.canvas_selected = _d2.default.select(self.element.get(0)).append(\"canvas\").style({ 'position': 'absolute' }).node();\n    self.canvas_selected_layer = self.canvas_selected.getContext(\"2d\");\n    self.selection_layer = self.svg.append(\"g\").attr(\"class\", \"selection-layer\");\n    self.image_layer = self.svg.append(\"g\").attr(\"class\", \"image-layer\");\n\n    self.options.image_cache = self.options.cache_references[0];\n\n    self.updates = {};\n    self.update_timer = null;\n    self._schedule_update({\n      update_indices: true,\n      update_width: true,\n      update_height: true,\n      update_x: true,\n      update_y: true,\n      update_x_label: true,\n      update_y_label: true,\n      render_data: true,\n      render_selection: true,\n      open_images: true,\n      render_legend: true,\n      update_legend_colors: true,\n      update_legend_position: true,\n      update_legend_axis: true,\n      update_v_label: true\n    });\n\n    self.legend_layer.call(_d2.default.behavior.drag().on('drag', function () {\n      // Make sure mouse is inside svg element\n      if (0 <= _d2.default.event.y && _d2.default.event.y <= self.options.height && 0 <= _d2.default.event.x && _d2.default.event.x <= self.options.width) {\n        var theElement = _d2.default.select(this);\n        var transx = Number(theElement.attr(\"data-transx\"));\n        var transy = Number(theElement.attr(\"data-transy\"));\n        transx += _d2.default.event.dx;\n        transy += _d2.default.event.dy;\n        theElement.attr(\"data-transx\", transx);\n        theElement.attr(\"data-transy\", transy);\n        theElement.attr('transform', \"translate(\" + transx + \", \" + transy + \")\");\n      }\n    }).on(\"dragstart\", function () {\n      self.state = \"moving\";\n      _d2.default.event.sourceEvent.stopPropagation(); // silence other listeners\n    }).on(\"dragend\", function () {\n      self.state = \"\";\n      // self._sync_open_images();\n      _d2.default.select(this).attr(\"data-status\", \"moved\");\n    }));\n\n    self.element.mousedown(function (e) {\n      //console.log(\"#scatterplot mousedown\");\n      e.preventDefault();\n      self.start_drag = [self._offsetX(e), self._offsetY(e)];\n      self.end_drag = null;\n    });\n\n    self.element.mousemove(function (e) {\n      if (self.start_drag === null) {\n        // Only schedule a hover if user is hovering over svg, not over images, video, etc.\n        if (e.target.nodeName === \"svg\") {\n          self._schedule_hover_canvas(e);\n        }\n      } else if (self.start_drag) // Mouse is down ...\n        {\n          if (self.end_drag) // Already dragging ...\n            {\n              self.end_drag = [self._offsetX(e), self._offsetY(e)];\n\n              var width = self.element.width();\n              var height = self.element.height();\n\n              self.selection_layer.selectAll(\".rubberband\").attr(\"x\", Math.min(self.start_drag[0], self.end_drag[0])).attr(\"y\", Math.min(self.start_drag[1], self.end_drag[1])).attr(\"width\", Math.abs(self.start_drag[0] - self.end_drag[0])).attr(\"height\", Math.abs(self.start_drag[1] - self.end_drag[1]));\n            } else {\n            if (Math.abs(self._offsetX(e) - self.start_drag[0]) > self.options.drag_threshold || Math.abs(self._offsetY(e) - self.start_drag[1]) > self.options.drag_threshold) // Start dragging ...\n              {\n                self.state = \"rubber-band-drag\";\n                self.end_drag = [self._offsetX(e), self._offsetY(e)];\n                self.selection_layer.append(\"rect\").attr(\"class\", \"rubberband\").attr(\"x\", Math.min(self.start_drag[0], self.end_drag[0])).attr(\"y\", Math.min(self.start_drag[1], self.end_drag[1])).attr(\"width\", Math.abs(self.start_drag[0] - self.end_drag[0])).attr(\"height\", Math.abs(self.start_drag[1] - self.end_drag[1])).attr(\"fill\", \"rgba(255, 255, 0, 0.3)\").attr(\"stroke\", \"rgb(255, 255, 0)\").attr(\"linewidth\", 2);\n              }\n          }\n        }\n    });\n\n    self.element.mouseout(function (e) {\n      self._cancel_hover_canvas();\n    });\n\n    self.element.mouseup(function (e) {\n      if (self.state == \"resizing\" || self.state == \"moving\") return;\n\n      //console.log(\"#scatterplot mouseup\");\n      if (!e.ctrlKey && !e.metaKey) {\n        self.options.selection = [];\n        self.options.filtered_selection = [];\n      }\n\n      var x = self.options.x;\n      var y = self.options.y;\n      var count = x.length;\n      var x_coord, y_coord;\n\n      if (self.state == \"rubber-band-drag\") // Rubber-band selection ...\n        {\n          self.selection_layer.selectAll(\".rubberband\").remove();\n\n          if (self.start_drag && self.end_drag) {\n            var x1 = Math.min(self.start_drag[0], self.end_drag[0]);\n            var x2 = Math.max(self.start_drag[0], self.end_drag[0]);\n            var y1 = Math.min(self.start_drag[1], self.end_drag[1]);\n            var y2 = Math.max(self.start_drag[1], self.end_drag[1]);\n\n            for (var i = 0; i != count; ++i) {\n              x_coord = self.x_scale(x[i]);\n              y_coord = self.y_scale(y[i]);\n              if (x1 <= x_coord && x_coord <= x2 && y1 <= y_coord && y_coord <= y2) {\n                var index = self.options.selection.indexOf(self.options.indices[i]);\n                if (index == -1) self.options.selection.push(self.options.indices[i]);\n              }\n            }\n          }\n        } else // Pick selection ...\n        {\n          var x1 = self._offsetX(e) - self.options.pick_distance;\n          var x2 = self._offsetX(e) + self.options.pick_distance;\n          var y1 = self._offsetY(e) - self.options.pick_distance;\n          var y2 = self._offsetY(e) + self.options.pick_distance;\n\n          for (var i = count - 1; i > -1; i--) {\n            x_coord = self.x_scale(x[i]);\n            y_coord = self.y_scale(y[i]);\n            if (x1 <= x_coord && x_coord <= x2 && y1 <= y_coord && y_coord <= y2) {\n              // Update the list of selected points ...\n              var index = self.options.selection.indexOf(self.options.indices[i]);\n              if (index == -1) {\n                // Selecting a new point.\n                self.options.selection.push(self.options.indices[i]);\n              } else {\n                // Deselecting an existing point.\n                self.options.selection.splice(index, 1);\n              }\n\n              break;\n            }\n          }\n        }\n\n      self.start_drag = null;\n      self.end_drag = null;\n      self.state = \"\";\n\n      self._filterIndices();\n      self.options.selection = self.options.filtered_selection.slice(0);\n      self._schedule_update({ render_selection: true });\n      self.element.trigger(\"selection-changed\", [self.options.selection]);\n    });\n    self._filterIndices();\n  },\n\n  _filterIndices: function _filterIndices() {\n    var self = this;\n    var x = self.options.x;\n    var y = self.options.y;\n    var indices = self.options.indices;\n    var selection = self.options.selection;\n    var hidden_simulations = self.options.hidden_simulations;\n    var filtered_indices = self._cloneArrayBuffer(indices);\n    var filtered_selection = selection.slice(0);\n    var length = indices.length;\n\n    // Remove hidden simulations and NaNs and empty strings\n    for (var i = length - 1; i >= 0; i--) {\n      var hidden = $.inArray(indices[i], hidden_simulations) > -1;\n\n      if (hidden || !self._validateValue(x[i]) || !self._validateValue(y[i])) {\n        filtered_indices.splice(i, 1);\n        var selectionIndex = $.inArray(indices[i], filtered_selection);\n        if (selectionIndex > -1) {\n          filtered_selection.splice(selectionIndex, 1);\n        }\n      }\n    }\n\n    self.options.filtered_indices = filtered_indices;\n    self.options.filtered_selection = filtered_selection;\n  },\n\n  // Filters source values by removing hidden_simulations\n  _filterValues: function _filterValues(source) {\n    var self = this;\n    var hidden_simulations = self.options.hidden_simulations.sort(_d2.default.ascending);\n    var length = hidden_simulations.length;\n\n    var filtered = self._cloneArrayBuffer(source);\n\n    for (var i = length - 1; i >= 0; i--) {\n      filtered.splice(hidden_simulations[i], 1);\n    }\n\n    return filtered;\n  },\n\n  // Clones an ArrayBuffer or Array\n  _cloneArrayBuffer: function _cloneArrayBuffer(source) {\n    // Array.apply method of turning an ArrayBuffer into a normal array is very fast (around 5ms for 250K) but doesn't work in WebKit with arrays longer than about 125K\n    // if(source.length > 1)\n    // {\n    //   return Array.apply( [], source );\n    // }\n    // else if(source.length == 1)\n    // {\n    //   return [source[0]];\n    // }\n    // return [];\n\n    // For loop method is much shower (around 300ms for 250K) but works in WebKit. Might be able to speed things up by using ArrayBuffer.subarray() method to make smallery arrays and then Array.apply those.\n    var clone = [];\n    for (var i = 0; i < source.length; i++) {\n      clone.push(source[i]);\n    }\n    return clone;\n  },\n\n  _createScale: function _createScale(string, values, range, reverse) {\n    if (!string) {\n      var domain = [_d2.default.min(values), _d2.default.max(values)];\n      if (reverse === true) {\n        domain.reverse();\n      }\n      return _d2.default.scale.linear().domain(domain).range(range);\n    } else {\n      var uniqueValues = _d2.default.set(values).values().sort();\n      if (reverse === true) {\n        uniqueValues.reverse();\n      }\n      return _d2.default.scale.ordinal().domain(uniqueValues).rangePoints(range);\n    }\n  },\n\n  _getDefaultXPosition: function _getDefaultXPosition(imageIndex, imageWidth) {\n    // We force the image to the left or right side of the screen, based on the target point position.\n    var self = this;\n    var width = self.svg.attr(\"width\");\n    var range = self.x_scale.range();\n    var rangeLast = range.length - 1;\n    var relx = (self.x_scale(self.options.x[imageIndex]) - range[0]) / (range[rangeLast] - range[0]);\n    var x;\n\n    if (relx < 0.5) x = relx * range[0];else x = width - (width - range[rangeLast]) * (1.0 - relx) - imageWidth;\n\n    return parseInt(x);\n  },\n\n  _getDefaultYPosition: function _getDefaultYPosition(imageIndex, imageHeight) {\n    var self = this;\n    var height = self.svg.attr(\"height\");\n    var target_y = self.y_scale(self.options.y[imageIndex]);\n    return parseInt(target_y / height * (height - imageHeight));\n  },\n\n  _validateValue: function _validateValue(value) {\n    var self = this;\n    if (typeof value == \"number\" && !isNaN(value)) return true;\n    if (typeof value == \"string\" && value.trim() != \"\") return true;\n    return false;\n  },\n\n  _setOption: function _setOption(key, value) {\n    var self = this;\n\n    //console.log(\"parameter_image.scatterplot._setOption()\", key, value);\n    self.options[key] = value;\n\n    if (key == \"indices\") {\n      self._filterIndices();\n      self._schedule_update({ update_indices: true, render_selection: true });\n    } else if (key == \"x_label\") {\n      self._schedule_update({ update_x_label: true });\n    } else if (key == \"y_label\") {\n      self._schedule_update({ update_y_label: true });\n    } else if (key == \"v_label\") {\n      self._schedule_update({ update_v_label: true });\n    } else if (key == \"x\") {\n      if (self.options[\"auto-scale\"]) {\n        self.options.filtered_x = self._filterValues(self.options.x);\n        self.options.scale_x = self.options.filtered_x;\n      } else {\n        self.options.scale_x = self.options.x;\n      }\n      self._filterIndices();\n      self._close_hidden_simulations();\n      self._schedule_update({ update_x: true, update_leaders: true, render_data: true, render_selection: true });\n    } else if (key == \"y\") {\n      if (self.options[\"auto-scale\"]) {\n        self.options.filtered_y = self._filterValues(self.options.y);\n        self.options.scale_y = self.options.filtered_y;\n      } else {\n        self.options.scale_y = self.options.y;\n      }\n      self._filterIndices();\n      self._close_hidden_simulations();\n      self._schedule_update({ update_y: true, update_leaders: true, render_data: true, render_selection: true });\n    } else if (key == \"v\") {\n      if (self.options[\"auto-scale\"]) {\n        self.options.filtered_v = self._filterValues(self.options.v);\n        self.options.scale_v = self.options.filtered_v;\n      } else {\n        self.options.scale_v = self.options.v;\n      }\n      self._schedule_update({ render_data: true, render_selection: true, update_legend_axis: true });\n    } else if (key == \"images\") {} else if (key == \"selection\") {\n      self._filterIndices();\n      self._schedule_update({ render_selection: true });\n    } else if (key == \"colorscale\") {\n      self._schedule_update({ render_data: true, render_selection: true });\n    } else if (key == \"width\") {\n      self._schedule_update({ update_width: true, update_x_label: true, update_x: true, update_leaders: true, render_data: true, render_selection: true });\n    } else if (key == \"height\") {\n      self._schedule_update({ update_height: true, update_y: true, update_y_label: true, update_leaders: true, render_data: true, render_selection: true, update_legend_position: true, update_legend_axis: true, update_v_label: true });\n    } else if (key == \"border\") {\n      self._schedule_update({ update_x: true, update_y: true, update_leaders: true, render_data: true, render_selection: true, update_legend_position: true, update_v_label: true });\n    } else if (key == \"gradient\") {\n      self._schedule_update({ update_legend_colors: true });\n    } else if (key == \"hidden_simulations\") {\n      self._filterIndices();\n      if (self.options[\"auto-scale\"]) {\n        self.options.filtered_x = self._filterValues(self.options.x);\n        self.options.filtered_y = self._filterValues(self.options.y);\n        self.options.filtered_v = self._filterValues(self.options.v);\n        self.options.scale_x = self.options.filtered_x;\n        self.options.scale_y = self.options.filtered_y;\n        self.options.scale_v = self.options.filtered_v;\n      } else {\n        self.options.scale_x = self.options.x;\n        self.options.scale_y = self.options.y;\n        self.options.scale_v = self.options.v;\n      }\n      self._schedule_update({ update_x: true, update_y: true, update_leaders: true, render_data: true, render_selection: true, update_legend_axis: true });\n      self._close_hidden_simulations();\n    } else if (key == \"auto-scale\") {\n      if (self.options[\"auto-scale\"]) {\n        self.options.filtered_x = self._filterValues(self.options.x);\n        self.options.filtered_y = self._filterValues(self.options.y);\n        self.options.filtered_v = self._filterValues(self.options.v);\n        self.options.scale_x = self.options.filtered_x;\n        self.options.scale_y = self.options.filtered_y;\n        self.options.scale_v = self.options.filtered_v;\n      } else {\n        self.options.scale_x = self.options.x;\n        self.options.scale_y = self.options.y;\n        self.options.scale_v = self.options.v;\n      }\n      self._schedule_update({ update_x: true, update_y: true, update_leaders: true, render_data: true, render_selection: true, update_legend_axis: true });\n    }\n  },\n\n  update_color_scale_and_v: function update_color_scale_and_v(data) {\n    var self = this;\n    self.options.colorscale = data.colorscale;\n    self.options.v = data.v;\n    if (data.v_string !== undefined) {\n      self.options.v_string = data.v_string;\n    }\n    if (self.options[\"auto-scale\"]) {\n      self.options.filtered_v = self._filterValues(self.options.v);\n      self.options.scale_v = self.options.filtered_v;\n    } else {\n      self.options.scale_v = self.options.v;\n    }\n    self._schedule_update({ render_data: true, render_selection: true, update_legend_axis: true });\n  },\n\n  _schedule_update: function _schedule_update(updates) {\n    var self = this;\n\n    for (var key in updates) {\n      self.updates[key] = updates[key];\n    }if (self.update_timer) return;\n\n    self.update_timer = window.setTimeout(function () {\n      self._update();\n    }, 0);\n  },\n\n  _update: function _update() {\n    var self = this;\n\n    //console.log(\"parameter_image.scatterplot._update()\", self.updates);\n    self.update_timer = null;\n\n    var xoffset = 0;\n    var legend_width = 150;\n\n    if (self.updates[\"update_width\"]) {\n      self.element.attr(\"width\", self.options.width);\n      self.svg.attr(\"width\", self.options.width);\n\n      var total_width = self.options.width;\n      var total_height = self.options.height;\n      var width = Math.min(total_width, total_height);\n      var width_offset = (total_width - width) / 2;\n\n      _d2.default.select(self.canvas_datum).style({\n        \"left\": width_offset + self.options.border - self.options.canvas_square_size / 2 + \"px\"\n      }).attr(\"width\", width - 2 * self.options.border - xoffset + self.options.canvas_square_size);\n      _d2.default.select(self.canvas_selected).style({\n        \"left\": width_offset + self.options.border - self.options.canvas_selected_square_size / 2 + \"px\"\n      }).attr(\"width\", width - 2 * self.options.border - xoffset + self.options.canvas_selected_square_size);\n    }\n\n    if (self.updates[\"update_height\"]) {\n      self.element.attr(\"height\", self.options.height);\n      self.svg.attr(\"height\", self.options.height);\n\n      var total_width = self.options.width;\n      var total_height = self.options.height;\n      var height = Math.min(total_width, total_height);\n      var height_offset = (total_height - height) / 2;\n      _d2.default.select(self.canvas_datum).style({\n        \"top\": height_offset + self.options.border - self.options.canvas_square_size / 2 + \"px\"\n      }).attr(\"height\", height - 2 * self.options.border - 40 + self.options.canvas_square_size);\n      _d2.default.select(self.canvas_selected).style({\n        \"top\": height_offset + self.options.border - self.options.canvas_selected_square_size / 2 + \"px\"\n      }).attr(\"height\", height - 2 * self.options.border - 40 + self.options.canvas_selected_square_size);\n    }\n\n    if (self.updates[\"update_x\"]) {\n      var total_width = self.options.width;\n      var total_height = self.options.height;\n      var width = Math.min(self.options.width, self.options.height);\n      var width_offset = (total_width - width) / 2;\n\n      var range = [0 + width_offset + self.options.border, total_width - width_offset - self.options.border - xoffset];\n      var range_canvas = [0, width - 2 * self.options.border - xoffset];\n\n      self.x_scale = self._createScale(self.options.x_string, self.options.scale_x, range, false);\n      self.x_scale_canvas = self._createScale(self.options.x_string, self.options.scale_x, range_canvas, false);\n\n      var height = Math.min(self.options.width, self.options.height);\n      var height_offset = (total_height - height) / 2;\n      self.x_axis_offset = total_height - height_offset - self.options.border - 40;\n      self.x_axis = _d2.default.svg.axis().scale(self.x_scale).orient(\"bottom\");\n      self.x_axis_layer.attr(\"transform\", \"translate(0,\" + self.x_axis_offset + \")\").call(self.x_axis);\n    }\n\n    if (self.updates[\"update_y\"]) {\n      var total_width = self.options.width;\n      var total_height = self.options.height;\n      var width = Math.min(self.options.width, self.options.height);\n      var height = Math.min(self.options.width, self.options.height);\n      var width_offset = (total_width - width) / 2;\n      var height_offset = (total_height - height) / 2;\n      var range = [total_height - height_offset - self.options.border - 40, 0 + height_offset + self.options.border];\n      var range_canvas = [height - 2 * self.options.border - 40, 0];\n      self.y_axis_offset = 0 + width_offset + self.options.border;\n\n      self.y_scale = self._createScale(self.options.y_string, self.options.scale_y, range, false);\n      self.y_scale_canvas = self._createScale(self.options.y_string, self.options.scale_y, range_canvas, false);\n\n      self.y_axis = _d2.default.svg.axis().scale(self.y_scale).orient(\"left\");\n      self.y_axis_layer.attr(\"transform\", \"translate(\" + self.y_axis_offset + \",0)\").call(self.y_axis);\n    }\n\n    if (self.updates[\"update_indices\"]) {\n      self.inverse_indices = {};\n      var count = self.options.indices.length;\n      for (var i = 0; i != count; ++i) {\n        self.inverse_indices[self.options.indices[i]] = i;\n      }\n    }\n\n    if (self.updates[\"update_x_label\"]) {\n      var x = self.svg.attr(\"width\") / 2;\n      var y = 40;\n\n      self.x_axis_layer.selectAll(\".label\").remove();\n      self.x_axis_layer.append(\"text\").attr(\"class\", \"label\").attr(\"x\", x).attr(\"y\", y).style(\"text-anchor\", \"middle\").style(\"font-weight\", \"bold\").text(self.options.x_label);\n    }\n\n    if (self.updates[\"update_y_label\"]) {\n      self.y_axis_layer.selectAll(\".label\").remove();\n\n      var y_axis_width = self.y_axis_layer.node().getBBox().width;\n      var x = -(y_axis_width + 15);\n      var y = self.svg.attr(\"height\") / 2;\n\n      self.y_axis_layer.append(\"text\").attr(\"class\", \"label\").attr(\"x\", x).attr(\"y\", y).attr(\"transform\", \"rotate(-90,\" + x + \",\" + y + \")\").style(\"text-anchor\", \"middle\").style(\"font-weight\", \"bold\").text(self.options.y_label);\n    }\n\n    if (self.updates[\"render_data\"]) {\n      var x = self.options.x,\n          y = self.options.y,\n          v = self.options.v,\n          filtered_indices = self.options.filtered_indices,\n          canvas = self.canvas_datum_layer,\n          i = -1,\n          n = filtered_indices.length,\n          cx,\n          cy,\n          color,\n          square_size = self.options.canvas_square_size,\n          border_width = self.options.canvas_square_border_size,\n          half_border_width = border_width / 2,\n          fillWidth = square_size - 2 * border_width,\n          fillHeight = fillWidth,\n          strokeWidth = square_size - border_width,\n          strokeHeight = strokeWidth;\n\n      // Draw points on canvas ...\n      var time = Date;\n      if (window.performance) time = window.performance;\n      var start = time.now();\n\n      canvas.clearRect(0, 0, self.canvas_datum.width, self.canvas_datum.height);\n      canvas.strokeStyle = \"black\";\n      canvas.lineWidth = border_width;\n\n      while (++i < n) {\n        var index = filtered_indices[i];\n        var value = v[index];\n        if (!self._validateValue(value)) color = $(\"#color-switcher\").colorswitcher(\"get_null_color\");else color = self.options.colorscale(value);\n        canvas.fillStyle = color;\n        cx = Math.round(self.x_scale_canvas(x[index]));\n        cy = Math.round(self.y_scale_canvas(y[index]));\n        canvas.fillRect(cx + border_width, cy + border_width, fillWidth, fillHeight);\n        canvas.strokeRect(cx + half_border_width, cy + half_border_width, strokeWidth, strokeHeight);\n      }\n      // Test point for checking position and border\n      // canvas.fillStyle = \"white\";\n      // canvas.fillRect(0 + 0.5, 0 + 0.5, width, height);\n      // canvas.strokeRect(0 + 0.5, 0 + 0.5, width, height);\n      var end = time.now();\n      console.log(\"Time to render \" + filtered_indices.length + \" canvas points: \" + (end - start) + \" milliseconds.\");\n\n      // Draw points on svg ...\n      // var start = performance.now();\n      // var circle = self.datum_layer.selectAll(\".datum\")\n      //   .data(filtered_indices, function(d, i){ \n      //     return d;\n      //   })\n      //   ;\n      // circle.exit()\n      //   .remove()\n      //   ;\n      // circle.enter()\n      //   .append(\"circle\")\n      //   .attr(\"class\", \"datum\")\n      //   .attr(\"r\", 4)\n      //   .attr(\"stroke\", \"black\")\n      //   .attr(\"linewidth\", 1)\n      //   .attr(\"data-index\", function(d, i) { return d; })\n      //   .on(\"mouseover\", function(d, i) { \n      //     self._schedule_hover(d);\n      //   })\n      //   .on(\"mouseout\", function(d, i) { \n      //     self._cancel_hover(); \n      //   })\n      //   ;\n      // circle\n      //   .attr(\"cx\", function(d, i) { return self.x_scale( x[d] ); })\n      //   .attr(\"cy\", function(d, i) { return self.y_scale( y[d] ); })\n      //   .attr(\"fill\", function(d, i) { \n      //     var value = v[d];\n      //     if(isNaN(value))\n      //       return $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n      //     else\n      //       return self.options.color(value); \n      //   })\n      //   ;\n      // var end = performance.now();\n      // console.log(\"Time to render \" + filtered_indices.length + \" svg points: \" + (end-start) + \" milliseconds.\");\n    }\n\n    if (self.updates[\"render_selection\"]) {\n      var x = self.options.x,\n          y = self.options.y,\n          v = self.options.v,\n          filtered_selection = self.options.filtered_selection,\n          canvas = self.canvas_selected_layer,\n          i = -1,\n          n = filtered_selection.length,\n          cx,\n          cy,\n          color,\n          square_size = self.options.canvas_selected_square_size,\n          border_width = self.options.canvas_selected_square_border_size,\n          half_border_width = border_width / 2,\n          fillWidth = fillHeight = square_size - 2 * border_width,\n          strokeWidth = strokeHeight = square_size - border_width;\n\n      canvas.clearRect(0, 0, self.canvas_selected.width, self.canvas_selected.height);\n      canvas.strokeStyle = \"black\";\n      canvas.lineWidth = border_width;\n\n      while (++i < n) {\n        var index = filtered_selection[i];\n        var value = v[index];\n        if (!self._validateValue(value)) color = $(\"#color-switcher\").colorswitcher(\"get_null_color\");else color = self.options.colorscale(value);\n        canvas.fillStyle = color;\n        cx = Math.round(self.x_scale_canvas(x[index]));\n        cy = Math.round(self.y_scale_canvas(y[index]));\n        canvas.fillRect(cx + border_width, cy + border_width, fillWidth, fillHeight);\n        canvas.strokeRect(cx + half_border_width, cy + half_border_width, strokeWidth, strokeHeight);\n      }\n\n      // var x_scale = self.x_scale;\n      // var y_scale = self.y_scale;\n\n      // self.selected_layer.selectAll(\".selection\").remove();\n\n      // var circle = self.selected_layer.selectAll(\".selection\")\n      //   .data(filtered_selection, function(d, i){\n      //     return d;\n      //   })\n      //   ;\n      // circle.enter()\n      //   .append(\"circle\")\n      //   .attr(\"class\", \"selection\")\n      //   .attr(\"r\", 8)\n      //   .attr(\"stroke\", \"black\")\n      //   .attr(\"linewidth\", 1)\n      //   .attr(\"data-index\", function(d, i) {\n      //     return d;\n      //   })\n      //   .on(\"mouseover\", function(d, i) {\n      //     self._schedule_hover(d);\n      //   })\n      //   .on(\"mouseout\", function(d, i) {\n      //     self._cancel_hover();\n      //   })\n      //   ;\n      // circle\n      //   .attr(\"cx\", function(d, i) {\n      //     return x_scale( x[d] );\n      //   })\n      //   .attr(\"cy\", function(d, i) {\n      //     return y_scale( y[d] );\n      //   })\n      //   .attr(\"fill\", function(d, i) {\n      //     var value = v[d];\n      //     if(isNaN(value))\n      //       return $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n      //     else\n      //       return self.options.color(value);\n      //   })\n      //   ;\n    }\n\n    // Used to open an initial list of images at startup only\n    if (self.updates[\"open_images\"]) {\n      // This is just a convenience for testing - in practice, these parameters should always be part of the open image specification.\n      self.options.open_images.forEach(function (image) {\n        if (image.uri === undefined) image.uri = self.options.images[image.index];\n        if (image.width === undefined) image.width = self.options.pinned_width;\n        if (image.height === undefined) image.height = self.options.pinned_height;\n      });\n\n      // Transform the list of initial images so we can pass them to _open_images()\n      var width = Number(self.svg.attr(\"width\"));\n      var height = Number(self.svg.attr(\"height\"));\n\n      var images = [];\n      self.options.open_images.forEach(function (image, index) {\n        images.push({\n          index: image.index,\n          uri: image.uri.trim(),\n          image_class: \"open-image\",\n          x: width * image.relx,\n          y: height * image.rely,\n          width: image.width,\n          height: image.height,\n          target_x: self.x_scale(self.options.x[image.index]),\n          target_y: self.y_scale(self.options.y[image.index])\n        });\n      });\n      self._open_images(images);\n    }\n\n    // Update leader targets anytime we resize or change our axes ...\n    if (self.updates[\"update_leaders\"]) {\n      $(\".open-image\").each(function (index, frame) {\n        var frame = $(frame);\n        var image_index = Number(frame.attr(\"data-index\"));\n        frame.find(\".leader\").attr(\"x2\", self.x_scale(self.options.x[image_index]) - Number(frame.attr(\"data-transx\"))).attr(\"y2\", self.y_scale(self.options.y[image_index]) - Number(frame.attr(\"data-transy\"))).attr(\"data-targetx\", self.x_scale(self.options.x[image_index])).attr(\"data-targety\", self.y_scale(self.options.y[image_index]));\n      });\n    }\n\n    if (self.updates[\"render_legend\"]) {\n      var gradient = self.legend_layer.append(\"defs\").append(\"linearGradient\");\n      gradient.attr(\"id\", \"color-gradient\").attr(\"x1\", \"0%\").attr(\"y1\", \"0%\").attr(\"x2\", \"0%\").attr(\"y2\", \"100%\");\n\n      var colorbar = self.legend_layer.append(\"rect\").classed(\"color\", true).attr(\"width\", 10).attr(\"height\", 200).attr(\"x\", 0).attr(\"y\", 0).style(\"fill\", \"url(#color-gradient)\");\n    }\n\n    if (self.updates[\"update_legend_colors\"]) {\n      var gradient = self.legend_layer.select(\"#color-gradient\");\n      var stop = gradient.selectAll(\"stop\").data(self.options.gradient);\n      stop.exit().remove();\n      stop.enter().append(\"stop\");\n      stop.attr(\"offset\", function (d) {\n        return d.offset + \"%\";\n      }).attr(\"stop-color\", function (d) {\n        return d.color;\n      });\n    }\n\n    if (self.updates[\"update_legend_position\"]) {\n      var total_width = Number(self.options.width);\n      var total_height = Number(self.options.height);\n      var width = Math.min(self.options.width, self.options.height);\n      var height = Math.min(self.options.width, self.options.height);\n      var rectHeight = parseInt((height - self.options.border - 40) / 2);\n      var y_axis_layer_width = self.y_axis_layer.node().getBBox().width;\n      var x_axis_layer_width = self.x_axis_layer.node().getBBox().width;\n      var width_offset = (total_width + x_axis_layer_width) / 2;\n\n      if (self.legend_layer.attr(\"data-status\") != \"moved\") {\n        var transx = parseInt(y_axis_layer_width + 10 + width_offset);\n        var transy = parseInt(total_height / 2 - rectHeight / 2);\n        self.legend_layer.attr(\"transform\", \"translate(\" + transx + \",\" + transy + \")\").attr(\"data-transx\", transx).attr(\"data-transy\", transy);\n      }\n\n      self.legend_layer.select(\"rect.color\").attr(\"height\", rectHeight);\n    }\n\n    if (self.updates[\"update_legend_axis\"]) {\n      var range = [0, parseInt(self.legend_layer.select(\"rect.color\").attr(\"height\"))];\n\n      self.legend_scale = self._createScale(self.options.v_string, self.options.scale_v, range, true);\n\n      self.legend_axis = _d2.default.svg.axis().scale(self.legend_scale).orient(\"right\");\n      self.legend_axis_layer.attr(\"transform\", \"translate(\" + parseInt(self.legend_layer.select(\"rect.color\").attr(\"width\")) + \",0)\").call(self.legend_axis);\n    }\n\n    if (self.updates[\"update_v_label\"]) {\n      console.log(\"updating v label.\");\n      self.legend_layer.selectAll(\".label\").remove();\n\n      var rectHeight = parseInt(self.legend_layer.select(\"rect.color\").attr(\"height\"));\n      var x = -15;\n      var y = rectHeight / 2;\n\n      self.legend_layer.append(\"text\").attr(\"class\", \"label\").attr(\"x\", x).attr(\"y\", y).attr(\"transform\", \"rotate(-90,\" + x + \",\" + y + \")\").style(\"text-anchor\", \"middle\").style(\"font-weight\", \"bold\").text(self.options.v_label);\n    }\n\n    self.updates = {};\n  },\n\n  _sync_open_images: function _sync_open_images() {\n    var self = this;\n\n    // Get the scatterplot width so we can convert absolute to relative coordinates.\n    var width = Number(self.svg.attr(\"width\"));\n    var height = Number(self.svg.attr(\"height\"));\n    var open_images = [];\n    $(\".open-image\").each(function (index, frame) {\n      var frame = $(frame);\n      var image = frame.find(\"image.image\");\n      open_images.push({\n        index: Number(frame.attr(\"data-index\")),\n        uri: frame.attr(\"data-uri\"),\n        relx: Number(frame.attr(\"data-transx\")) / width,\n        rely: Number(frame.attr(\"data-transy\")) / height,\n        width: Number(image.attr(\"width\")),\n        height: Number(image.attr(\"height\"))\n      });\n    });\n    self.element.trigger(\"open-images-changed\", [open_images]);\n  },\n\n  _open_images: function _open_images(images) {\n    var self = this;\n\n    // If the list of images is empty, we're done.\n    if (images.length == 0) return;\n\n    var image = images[0];\n\n    // Don't open images for hidden simulations\n    if ($.inArray(image.index, self.options.hidden_simulations) != -1) {\n      self._open_images(images.slice(1));\n      return;\n    }\n\n    // // Don't open image if it's already open\n    // if($(\".open-image[data-uri='\" + image.uri + \"']\").size() > 0) {\n    //   self._open_images(images.slice(1));\n    //   return;\n    // }\n\n    // If image is hover and we are no longer loading this image, we're done.\n    if (image.image_class == \"hover-image\" && self.opening_image != image.index) {\n      return;\n    }\n\n    // Create scaffolding and status indicator if we already don't have one\n    if (self.image_layer.select(\"g.\" + image.image_class + \"[data-uri='\" + image.uri + \"']\").empty()) {\n\n      // Define a default size for every image.\n      if (image.width === undefined) image.width = self.options.pinned_width;\n      if (image.height === undefined) image.height = self.options.pinned_height;\n\n      // Define a default position for every image.\n      if (image.x === undefined) {\n        image.x = self._getDefaultXPosition(image.index, image.width);\n      }\n      if (image.y === undefined) {\n        image.y = self._getDefaultYPosition(image.index, image.height);\n      }\n\n      // Tag associated point with class\n      self.datum_layer.selectAll(\"circle[data-index='\" + image.index + \"']\").classed(\"openHover\", true);\n\n      var frame = self.image_layer.append(\"g\").attr(\"data-uri\", image.uri).attr(\"data-transx\", image.x).attr(\"data-transy\", image.y).attr('transform', \"translate(\" + image.x + \", \" + image.y + \")\").attr(\"class\", image.image_class + \" image-frame\").attr(\"data-index\", image.index).attr(\"data-uri\", image.uri).call(_d2.default.behavior.drag().on('drag', function () {\n        //console.log(\"frame drag\");\n        // Make sure mouse is inside svg element\n        if (0 <= _d2.default.event.y && _d2.default.event.y <= self.options.height && 0 <= _d2.default.event.x && _d2.default.event.x <= self.options.width) {\n          var theElement = _d2.default.select(this);\n          var transx = Number(theElement.attr(\"data-transx\"));\n          var transy = Number(theElement.attr(\"data-transy\"));\n          transx += _d2.default.event.dx;\n          transy += _d2.default.event.dy;\n          theElement.attr(\"data-transx\", transx);\n          theElement.attr(\"data-transy\", transy);\n          theElement.attr('transform', \"translate(\" + transx + \", \" + transy + \")\");\n\n          var leader = theElement.select(\".leader\");\n          leader.attr(\"x2\", Number(leader.attr(\"data-targetx\")) - transx);\n          leader.attr(\"y2\", Number(leader.attr(\"data-targety\")) - transy);\n        }\n      }).on(\"dragstart\", function () {\n        //console.log(\"frame dragstart\");\n        self.state = \"moving\";\n        // Verify source event target\n        var sourceEventTarget = _d2.default.select(_d2.default.event.sourceEvent.target);\n        if (sourceEventTarget.classed(\"outline\") || sourceEventTarget.classed(\"image\")) {\n          _d2.default.event.sourceEvent.stopPropagation(); // silence other listeners\n          // Reset tracking of hover image if we are starting to drag a hover image\n          var frame = _d2.default.select(this);\n          if (frame.classed(\"hover-image\")) {\n            self.opening_image = null;\n            if (self.close_hover_timer) {\n              window.clearTimeout(self.close_hover_timer);\n              self.close_hover_timer = null;\n            }\n            frame.classed(\"hover-image\", false).classed(\"open-image\", true);\n            image.image_class = \"open-image\";\n            // Remove openHover class tag from any points that might have it\n            self.datum_layer.selectAll(\"circle.openHover\").classed(\"openHover\", false);\n          }\n        }\n      }).on(\"dragend\", function () {\n        //console.log(\"frame dragend\");\n        self.state = \"\";\n        self._sync_open_images();\n      })).on(\"mousedown\", function () {\n        //console.log(\"frame mousedown\");\n        //d3.event.stopPropagation();\n        // Verify that click is on image, not something else like the close button\n        if (_d2.default.event.target.classList.contains(\"image\")) {\n          // Move this image to the top of the Z order ...\n          $(_d2.default.event.target.parentNode).detach().appendTo(self.image_layer.node());\n        }\n      }).on(\"mouseup\", function () {\n        //console.log(\"frame mouseup\");\n        //d3.event.stopPropagation();\n      });\n\n      // Create the leader line ...\n      if (\"target_x\" in image && \"target_y\" in image) {\n        frame.append(\"line\").attr(\"class\", \"leader\").attr(\"x1\", image.width / 2).attr(\"y1\", image.height / 2).attr(\"x2\", image.target_x - Number(frame.attr(\"data-transx\"))).attr(\"y2\", image.target_y - Number(frame.attr(\"data-transy\"))).attr(\"data-targetx\", image.target_x).attr(\"data-targety\", image.target_y).style(\"stroke\", \"black\").style(\"stroke-width\", 1.0);\n      }\n\n      // Create an outline ...\n      var outline = frame.append(\"rect\").attr(\"class\", \"outline\").attr(\"x\", -0.5).attr(\"y\", -0.5).attr(\"width\", image.width + 1).attr(\"height\", image.height + 1).style(\"stroke\", \"black\").style(\"stroke-width\", \"1px\").style(\"fill\", \"white\");\n\n      // // Create the loading image ...\n      // var timeout_image = frame.append(\"image\")\n      //   .attr(\"class\", \"loading-image\")\n      //   .attr(\"xlink:href\", \"/css/ajax-loader.gif\")\n      //   .attr(\"x\", (image.width / 2)-16)\n      //   .attr(\"y\", (image.height / 2)-16)\n      //   .attr(\"width\", 32)\n      //   .attr(\"height\", 32)\n      //   ;\n\n      // Schedule timeout for hover\n      self.close_hover_timer = window.setTimeout(function () {\n        self._hover_timeout(image.index, 0);\n      }, 1000);\n    }\n\n    // If the image is already in the cache, display it.\n    if (image.uri in self.options.image_cache) {\n      console.log(\"Displaying image \" + image.uri + \" from cache\");\n      var url_creator = window.URL || window.webkitURL;\n      var image_url = url_creator.createObjectURL(self.options.image_cache[image.uri]);\n\n      // Define a default size for every image.\n      if (image.width === undefined) image.width = self.options.pinned_width;\n      if (image.height === undefined) image.height = self.options.pinned_height;\n\n      // Define a default position for every image.\n      if (image.x === undefined) {\n        image.x = self._getDefaultXPosition(image.index, image.width);\n      }\n      if (image.y === undefined) {\n        image.y = self._getDefaultYPosition(image.index, image.height);\n      }\n\n      var frame = self.image_layer.select(\"g.\" + image.image_class + \"[data-uri='\" + image.uri + \"']\");\n\n      // Create the image ...\n      var svgImage = frame.append(\"image\").attr(\"class\", \"image\").attr(\"xlink:href\", image_url).attr(\"x\", 0).attr(\"y\", 0).attr(\"width\", image.width).attr(\"height\", image.height).attr(\"data-ratio\", image.width / image.height);\n\n      // Create a resize handle\n      var resize_handle = frame.append(\"g\").attr(\"class\", \"resize-handle\").attr('transform', \"translate(\" + (image.width - 9) + \", \" + (image.height - 9) + \")\").call(_d2.default.behavior.drag().on('drag', function () {\n        //console.log(\"resize drag\");\n        // Make sure mouse is inside svg element\n        if (0 <= _d2.default.event.y && _d2.default.event.y <= self.options.height && 0 <= _d2.default.event.x && _d2.default.event.x <= self.options.width) {\n          var frame = _d2.default.select(this.parentNode);\n          var theImage = frame.select(\"image.image\");\n          var width = Number(theImage.attr(\"width\"));\n          var height = Number(theImage.attr(\"height\"));\n          var theRectangle = frame.select(\"rect.outline\");\n          var theHandle = _d2.default.select(this);\n          var theLine = frame.select(\"line.leader\");\n          var thePin = frame.select('.pin-button');\n          var ratio = Number(theImage.attr(\"data-ratio\"));\n          var newWidth, newHeight;\n          var x = _d2.default.event.x;\n          var y = _d2.default.event.y;\n          var min = 50;\n          if (x < min) x = min;\n          if (y < min) y = min;\n          newWidth = x;\n          newHeight = newWidth / ratio;\n          if (newHeight > y) {\n            newHeight = y;\n            newWidth = newHeight * ratio;\n          }\n          theImage.attr(\"width\", newWidth);\n          theImage.attr(\"height\", newHeight);\n          theRectangle.attr(\"width\", newWidth + 1);\n          theRectangle.attr(\"height\", newHeight + 1);\n          theHandle.attr('transform', \"translate(\" + (newWidth - 9) + \", \" + (newHeight - 9) + \")\");\n          thePin.attr('transform', 'translate(' + (newWidth - 20) + ',0)');\n          theLine.attr(\"x1\", newWidth / 2);\n          theLine.attr(\"y1\", newHeight / 2);\n        }\n      }).on(\"dragstart\", function () {\n        //console.log(\"resize dragstart\");\n        self.state = \"resizing\";\n        _d2.default.selectAll([this.parentNode, _d2.default.select(\"#scatterplot\").node()]).classed(\"resizing\", true);\n        _d2.default.event.sourceEvent.stopPropagation(); // silence other listeners\n        // Reset tracking of hover image if we are starting to drag a hover image\n        var frame = _d2.default.select(this.parentNode);\n        if (frame.classed(\"hover-image\")) {\n          self.opening_image = null;\n          if (self.close_hover_timer) {\n            window.clearTimeout(self.close_hover_timer);\n            self.close_hover_timer = null;\n          }\n          frame.classed(\"hover-image\", false).classed(\"open-image\", true);\n          image.image_class = \"open-image\";\n\n          // Remove openHover class tag from any points that might have it\n          self.datum_layer.selectAll(\"circle.openHover\").classed(\"openHover\", false);\n        }\n      }).on(\"dragend\", function () {\n        //console.log(\"resize dragend\");\n        _d2.default.selectAll([this.parentNode, _d2.default.select(\"#scatterplot\").node()]).classed(\"resizing\", false);\n        self.state = \"\";\n        self._sync_open_images();\n      })).on(\"mousedown\", function () {\n        //console.log(\"resize mousedown\");\n        //d3.event.stopPropagation(); // silence other listeners\n      }).on(\"mouseup\", function () {\n        //console.log(\"resize mouseup\");\n        //d3.event.stopPropagation(); // silence other listeners\n      });\n\n      resize_handle.append(\"path\").attr(\"d\", \"M0,8 L8,0 M4,8 L8,4\").style(\"stroke\", \"#878787\").style(\"stroke-width\", 1).style(\"pointer-events\", \"none\");\n\n      resize_handle.append(\"rect\").attr(\"class\", \"resize-handle-mousetarget\").attr(\"width\", 10).attr(\"height\", 10).attr(\"fill\", \"transparent\");\n\n      // Create a close button ...\n      var close_button = frame.append(\"g\").attr(\"class\", \"close-button\");\n      close_button.append(\"rect\").attr(\"x\", 5).attr(\"y\", 5).attr(\"width\", 16).attr(\"height\", 16).attr(\"rx\", 2).attr(\"ry\", 2).style(\"fill\", \"rgba(0%,0%,0%,0.2)\").on(\"mousedown\", function () {\n        //console.log(\"close button mousedown\");\n        _d2.default.event.stopPropagation(); // silence other listeners\n      }).on(\"mouseup\", function () {\n        //console.log(\"close button mouseup\");\n        _d2.default.event.stopPropagation(); // silence other listeners\n      }).on(\"click\", function () {\n        //console.log(\"close button click\");\n        _d2.default.event.stopPropagation(); // silence other listeners\n        var frame = _d2.default.select(_d2.default.event.target.parentNode.parentNode);\n        frame.remove();\n        self._sync_open_images();\n      });\n\n      close_button.append(\"path\").attr(\"d\", \"M\" + 8 + \" \" + 8 + \" l10 10 m0 -10 l-10 10\").style(\"stroke\", \"rgba(100%,100%,100%, 0.8)\").style(\"stroke-width\", 3).style(\"pointer-events\", \"none\");\n\n      // Create a pin button ...\n      var pin_button = frame.append(\"g\").attr('class', 'pin-button').attr('transform', \"translate(\" + (image.width - 20) + \",0)\");\n\n      pin_button.append(\"image\").attr(\"class\", \"pin-icon\").attr(\"x\", 2).attr(\"y\", 2).attr(\"width\", 16).attr(\"height\", 16).attr(\"xlink:href\", _pin2.default).on(\"mousedown\", function () {\n        //console.log(\"pin button mousedown\");\n        _d2.default.event.stopPropagation(); // silence other listeners\n      }).on(\"mouseup\", function () {\n        //console.log(\"pin button mouseup\");\n        _d2.default.event.stopPropagation(); // silence other listeners\n      }).on(\"click\", function () {\n        _d2.default.event.stopPropagation(); // silence other listeners\n        // Reset tracking of hover image\n        self.opening_image = null;\n        if (self.close_hover_timer) {\n          window.clearTimeout(self.close_hover_timer);\n          self.close_hover_timer = null;\n        }\n\n        // Remove openHover class tag from any points that might have it\n        self.datum_layer.selectAll(\"circle.openHover\").classed(\"openHover\", false);\n\n        var frame = _d2.default.select(_d2.default.event.target.parentNode.parentNode);\n        var theImage = frame.select(\"image.image\");\n        var theRectangle = frame.select(\"rect.outline\");\n        var theHandle = frame.select(\"g.resize-handle\");\n        var theLine = frame.select(\"line.leader\");\n        var thePin = frame.select('.pin-button');\n        frame.classed(\"hover-image\", false).classed(\"open-image\", true);\n\n        // Adjust image position\n        var imageWidth = self.options.pinned_width;\n        var imageHeight = self.options.pinned_height;\n\n        var x = self._getDefaultXPosition(image.index, imageWidth);\n        var y = self._getDefaultYPosition(image.index, imageHeight);\n\n        frame.attr(\"data-transx\", x).attr(\"data-transy\", y).attr('transform', \"translate(\" + x + \", \" + y + \")\");\n\n        // Adjust image size\n        theImage.attr(\"width\", imageWidth);\n        theImage.attr(\"height\", imageHeight);\n        theRectangle.attr(\"width\", imageWidth + 1);\n        theRectangle.attr(\"height\", imageHeight + 1);\n        theHandle.attr('transform', \"translate(\" + (imageWidth - 9) + \", \" + (imageHeight - 9) + \")\");\n        thePin.attr('transform', 'translate(' + (imageWidth - 20) + ',0)');\n\n        // Adjust line\n        theLine.attr(\"x1\", imageWidth / 2).attr(\"y1\", imageHeight / 2).attr(\"x2\", image.target_x - Number(frame.attr(\"data-transx\"))).attr(\"y2\", image.target_y - Number(frame.attr(\"data-transy\")));\n\n        self._sync_open_images();\n      });\n\n      if (!image.no_sync) self._sync_open_images();\n      self._open_images(images.slice(1));\n      return;\n    }\n\n    if (!self.login_open) {\n      self.login_open = true;\n      var uri = (0, _urijs2.default)(image.uri);\n      self.remotes.get_remote({\n        hostname: uri.hostname(),\n        title: \"Login to \" + uri.hostname(),\n        message: \"Loading \" + uri.pathname(),\n        cancel: function cancel() {\n          self.login_open = false;\n        },\n        success: function success(hostname) {\n          var xhr = new XMLHttpRequest();\n          var api = \"/file\";\n\n          xhr.image = image;\n          //Double encode to avoid cherrypy's auto unencode in the controller\n          xhr.open(\"GET\", _slycatServerRoot2.default + \"remotes/\" + hostname + api + uri.pathname(), true);\n          xhr.responseType = \"arraybuffer\";\n          xhr.onload = function (e) {\n            // If we get 404, the remote session no longer exists because it timed-out.\n            // If we get 500, there was an internal error communicating to the remote host.\n            // Either way, delete the cached session and create a new one.\n            if (this.status == 404 || this.status == 500) {\n              self.remotes.delete_remote(uri.hostname());\n              self._open_images(images);\n              return;\n            }\n            // If we get 400, it means that the session is good and we're\n            // communicating with the remote host, but something else went wrong\n            // (probably file permissions issues).\n            if (this.status == 400) {\n              console.log(this);\n              console.log(this.getAllResponseHeaders());\n              var message = this.getResponseHeader(\"slycat-message\");\n              var hint = this.getResponseHeader(\"slycat-hint\");\n\n              if (message && hint) {\n                window.alert(message + \"\\n\\n\" + hint);\n              } else if (message) {\n                window.alert(message);\n              } else {\n                window.alert(\"Error loading image \" + this.image.uri + \": \" + this.statusText);\n              }\n              return;\n            } else {\n              // We received the image, so put it in the cache and start-over.\n              var array_buffer_view = new Uint8Array(this.response);\n              var blob = new Blob([array_buffer_view], { type: this.getResponseHeader('content-type') });\n              self.options.image_cache[image.uri] = blob;\n              self._open_images(images);\n              return;\n            }\n          };\n\n          xhr.send();\n          self.login_open = false;\n        }\n      });\n    }\n  },\n\n  _close_hidden_simulations: function _close_hidden_simulations() {\n    var self = this;\n    $(\"g.image-frame\").filter(function () {\n      return $.inArray($(this).data(\"index\"), self.options.filtered_indices) == -1;\n    }).remove();\n  },\n\n  _schedule_hover_canvas: function _schedule_hover_canvas(e) {\n    var self = this;\n    self._cancel_hover_canvas();\n\n    // Disable hovering whenever anything else is going on ...\n    if (self.state != \"\") return;\n\n    self.hover_timer_canvas = window.setTimeout(function () {\n      self._open_hover_canvas(e);\n    }, self.options.hover_time);\n  },\n\n  _open_hover_canvas: function _open_hover_canvas(e) {\n    var self = this;\n\n    // Disable hovering whenever anything else is going on ...\n    if (self.state != \"\") return;\n\n    var x = self._offsetX(e),\n        y = self._offsetY(e),\n        filtered_indices = self.options.filtered_indices,\n        filtered_selection = self.options.filtered_selection,\n        square_size = self.options.canvas_square_size,\n        shift = square_size / 2,\n        selected_square_size = self.options.canvas_selected_square_size,\n        selected_shift = selected_square_size / 2,\n        index;\n\n    var selected_match = self._open_first_match(x, y, filtered_selection, selected_shift, selected_square_size);\n    if (!selected_match) self._open_first_match(x, y, filtered_indices, shift, square_size);\n  },\n\n  _open_first_match: function _open_first_match(x, y, indices, shift, size) {\n    var self = this,\n        xvalues = self.options.x,\n        yvalues = self.options.y;\n    for (var i = indices.length - 1; i > -1; i--) {\n      var index = indices[i];\n      var x1 = Math.round(self.x_scale(xvalues[index])) - shift;\n      var y1 = Math.round(self.y_scale(yvalues[index])) - shift;\n      var x2 = x1 + size;\n      var y2 = y1 + size;\n\n      if (x >= x1 && x <= x2 && y >= y1 && y <= y2) {\n        // Disable hovering when there is no uri\n        if (self.options.images[index].trim() != \"\") {\n          self._open_hover(index);\n        }\n\n        return true;\n      }\n    }\n    return false;\n  },\n\n  _cancel_hover_canvas: function _cancel_hover_canvas() {\n    var self = this;\n\n    if (self.hover_timer_canvas) {\n      window.clearTimeout(self.hover_timer_canvas);\n      self.hover_timer_canvas = null;\n    }\n  },\n\n  _schedule_hover: function _schedule_hover(image_index) {\n    var self = this;\n\n    // Disable hovering whenever anything else is going on ...\n    if (self.state != \"\") return;\n\n    // Disable hovering when there are no image columns\n    if (self.options.images == null || self.options.images.length == 0) return;\n\n    // Disable hovering when there is no uri\n    if (self.options.images[self.options.indices[image_index]].trim() == \"\") return;\n\n    // // Disable hovering on points that already have open imges ...\n    // var uri = self.options.images[self.options.indices[image_index]];\n    // if($(\".open-image[data-uri='\" + uri + \"']\").size() != 0)\n    //   return;\n\n    // Cancel any pending hover ...\n    self._cancel_hover();\n\n    // Start the timer for the new hover ...\n    self.hover_timer = window.setTimeout(function () {\n      self._open_hover(image_index);\n    }, self.options.hover_time);\n  },\n\n  _cancel_hover: function _cancel_hover() {\n    var self = this;\n    if (self.hover_timer) {\n      window.clearTimeout(self.hover_timer);\n      self.hover_timer = null;\n    }\n  },\n\n  _open_hover: function _open_hover(image_index) {\n    var self = this;\n\n    // Verify that we don't already have an open hover for the associated point\n    if (self.datum_layer.select(\"circle.openHover[data-index='\" + image_index + \"']\").empty()) {\n      self._close_hover();\n      self.opening_image = image_index;\n\n      var width = self.svg.attr(\"width\");\n      var height = self.svg.attr(\"height\");\n      var hover_width = Math.min(width, height) * 0.85;\n      var hover_height = Math.min(width, height) * 0.85;\n\n      self._open_images([{\n        index: self.options.indices[image_index],\n        uri: self.options.images[self.options.indices[image_index]].trim(),\n        image_class: \"hover-image\",\n        x: Math.min(self.x_scale(self.options.x[image_index]) + 10, width - hover_width - self.options.border - 10),\n        y: Math.min(self.y_scale(self.options.y[image_index]) + 10, height - hover_height - self.options.border - 10),\n        width: hover_width,\n        height: hover_height,\n        target_x: self.x_scale(self.options.x[image_index]),\n        target_y: self.y_scale(self.options.y[image_index]),\n        no_sync: true\n      }]);\n\n      // self.close_hover_timer = window.setTimeout(function() {self._hover_timeout(image_index, 0);}, 1000);\n    }\n  },\n\n  _hover_timeout: function _hover_timeout(image_index, time) {\n    var self = this;\n    var checkInterval = 50;\n    var cutoff = 1000;\n\n    if (time > cutoff) {\n      self._close_hover();\n      return;\n    } else if (self._is_hovering(image_index)) {\n      self.close_hover_timer = window.setTimeout(function () {\n        self._hover_timeout(image_index, 0);\n      }, checkInterval);\n    } else {\n      self.close_hover_timer = window.setTimeout(function () {\n        self._hover_timeout(image_index, time + checkInterval);\n      }, checkInterval);\n    }\n  },\n\n  _is_hovering: function _is_hovering(image_index) {\n    var self = this;\n    var hoverEmpty = self.image_layer.selectAll(\".hover-image[data-index='\" + image_index + \"']:hover\").empty();\n    var circleEmpty = self.datum_layer.selectAll(\"circle[data-index='\" + image_index + \"']:hover\").empty();\n    var selectedCircleEmpty = self.selected_layer.selectAll(\"circle[data-index='\" + image_index + \"']:hover\").empty();\n\n    return !(hoverEmpty && circleEmpty && selectedCircleEmpty);\n  },\n\n  _close_hover: function _close_hover() {\n    var self = this;\n\n    self.opening_image = null;\n\n    if (self.close_hover_timer) {\n      window.clearTimeout(self.close_hover_timer);\n      self.close_hover_timer = null;\n    }\n\n    // Cancel any pending hover ...\n    self._cancel_hover();\n\n    // Close any current hover images ...\n    self.image_layer.selectAll(\".hover-image\").remove();\n\n    // Remove openHover class tag from any points that might have it\n    self.datum_layer.selectAll(\"circle.openHover\").classed(\"openHover\", false);\n  },\n\n  _offsetX: function _offsetX(e) {\n    return e.pageX - e.currentTarget.getBoundingClientRect().left - $(document).scrollLeft();\n  },\n\n  _offsetY: function _offsetY(e) {\n    return e.pageY - e.currentTarget.getBoundingClientRect().top - $(document).scrollTop();\n  },\n\n  pin: function pin(simulations) {\n    var self = this;\n\n    // Set default image size\n    var imageWidth = self.options.pinned_width;\n    var imageHeight = self.options.pinned_height;\n\n    var images = [];\n    simulations.forEach(function (image_index, loop_index) {\n      images.push({\n        index: self.options.indices[image_index],\n        uri: self.options.images[self.options.indices[image_index]].trim(),\n        image_class: \"open-image\",\n        x: self._getDefaultXPosition(image_index, imageWidth),\n        y: self._getDefaultYPosition(image_index, imageHeight),\n        width: imageWidth,\n        height: imageHeight,\n        target_x: self.x_scale(self.options.x[image_index]),\n        target_y: self.y_scale(self.options.y[image_index])\n      });\n    });\n    self._open_images(images);\n  }\n}); /* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\n//////////////////////////////////////////////////////////////////////////////////\n// d3js.org scatterplot visualization, for use with the parameter-image model.\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\")))\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-scatterplot.js?");

/***/ }),

/***/ "./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-table.js":
/*!******************************************************************************************!*\
  !*** ./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-table.js ***!
  \******************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($) {\n\nvar _slycatServerRoot = __webpack_require__(/*! js/slycat-server-root */ \"./web-server/js/slycat-server-root.js\");\n\nvar _slycatServerRoot2 = _interopRequireDefault(_slycatServerRoot);\n\nvar _d = __webpack_require__(/*! js/d3.min */ \"./web-server/js/d3.min.js\");\n\nvar _d2 = _interopRequireDefault(_d);\n\n__webpack_require__(/*! jquery-ui */ \"./node_modules/jquery-ui/jquery-ui.js\");\n\n__webpack_require__(/*! js/jquery.event.drag-2.2 */ \"./web-server/js/jquery.event.drag-2.2.js\");\n\n__webpack_require__(/*! js/slick.core */ \"./web-server/js/slick.core.js\");\n\n__webpack_require__(/*! js/slick.grid */ \"./web-server/js/slick.grid.js\");\n\n__webpack_require__(/*! js/slick.rowselectionmodel */ \"./web-server/js/slick.rowselectionmodel.js\");\n\n__webpack_require__(/*! js/slick.headerbuttons */ \"./web-server/js/slick.headerbuttons.js\");\n\n__webpack_require__(/*! js/slick.autotooltips */ \"./web-server/js/slick.autotooltips.js\");\n\n__webpack_require__(/*! js/slick.slycateditors */ \"./web-server/js/slick.slycateditors.js\");\n\nvar _chunker = __webpack_require__(/*! js/chunker */ \"./web-server/js/chunker.js\");\n\nvar chunker = _interopRequireWildcard(_chunker);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n$.widget(\"parameter_image.table\", {\n  options: {\n    mid: null,\n    aid: null,\n    metadata: null,\n    statistics: null,\n    inputs: [],\n    outputs: [],\n    others: [],\n    images: [],\n    ratings: [],\n    categories: [],\n    \"row-selection\": [],\n    \"variable-selection\": [],\n    \"sort-variable\": null,\n    \"sort-order\": null,\n    \"image-variable\": null,\n    \"x-variable\": null,\n    \"y-variable\": null,\n    colorscale: null,\n    hidden_simulations: []\n  },\n\n  _create: function _create() {\n    var self = this;\n\n    function value_formatter(value) {\n      return value == null ? \"&nbsp;\" : (value + \"\").replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n    }\n\n    function cell_formatter(row, cell, value, columnDef, dataContext) {\n      if (columnDef.colorscale) return \"<div class='highlightWrapper\" + (value == null ? \" null\" : \"\") + (_d2.default.hcl(columnDef.colorscale(value)).l > 50 ? \" light\" : \" dark\") + \"' style='background:\" + columnDef.colorscale(value) + \"'>\" + value_formatter(value) + \"</div>\";else if (value == null) return \"<div class='highlightWrapper\" + (value == null ? \" null\" : \"\") + \"'>\" + value_formatter(value) + \"</div>\";\n      return value_formatter(value);\n    }\n\n    function editable_cell_formatter(row, cell, value, columnDef, dataContext) {\n      if (columnDef.colorscale) return \"<div class='highlightWrapper\" + (value == null ? \" null\" : \"\") + (_d2.default.hcl(columnDef.colorscale(value)).l > 50 ? \" light\" : \" dark\") + \"' style='background:\" + columnDef.colorscale(value) + \"'>\" + value_formatter(value) + \"</div>\";else if (value == null) return \"<div class='highlightWrapper\" + (value == null ? \" null\" : \"\") + \"'>\" + value_formatter(value) + \"</div>\";\n      return value_formatter(value);\n    }\n\n    function set_sort(column, order) {\n      self.data.set_sort(column, order);\n      self.data.get_indices(\"sorted\", self.options[\"row-selection\"], function (sorted_rows) {\n        self.grid.invalidate();\n        self.trigger_row_selection = false;\n        self.grid.setSelectedRows(sorted_rows);\n        self.grid.resetActiveCell();\n        if (sorted_rows.length) self.grid.scrollRowToTop(Math.min.apply(Math, sorted_rows));\n        self.element.trigger(\"variable-sort-changed\", [column, order]);\n      });\n    }\n\n    function make_column(column_index, header_class, cell_class, formatter) {\n      var column = {\n        id: column_index,\n        field: column_index,\n        name: self.options.metadata[\"column-names\"][column_index],\n        toolTip: self.options.metadata[\"column-names\"][column_index],\n        sortable: false,\n        headerCssClass: header_class,\n        cssClass: cell_class,\n        formatter: formatter,\n        width: 100,\n        header: {\n          buttons: [{\n            cssClass: self.options[\"sort-variable\"] == column_index ? self.options[\"sort-order\"] == \"ascending\" ? \"icon-sort-ascending\" : \"icon-sort-descending\" : \"icon-sort-off\",\n            tooltip: self.options[\"sort-variable\"] == column_index ? self.options[\"sort-order\"] == \"ascending\" ? \"Sort descending\" : \"Sort ascending\" : \"Sort ascending\",\n            command: self.options[\"sort-variable\"] == column_index ? self.options[\"sort-order\"] == \"ascending\" ? \"sort-descending\" : \"sort-ascending\" : \"sort-ascending\"\n          }]\n        }\n      };\n      // Special options for image columns\n      if (self.options.images.indexOf(column_index) > -1) {\n        column.headerCssClass += \" headerImage\";\n        column.header.buttons.push({\n          cssClass: self.options[\"image-variable\"] == column_index ? \"icon-image-on\" : \"icon-image-off\",\n          tooltip: self.options[\"image-variable\"] == column_index ? \"Current image variable\" : \"Set as image variable\",\n          command: self.options[\"image-variable\"] == column_index ? \"\" : \"image-on\"\n        });\n      }\n      // Special options for non-image and non-index columns\n      else if (self.options.metadata[\"column-count\"] - 1 != column_index) {\n          column.headerCssClass += \" headerNumeric\";\n          column.header.buttons.push({\n            cssClass: self.options[\"x-variable\"] == column_index ? \"icon-x-on\" : \"icon-x-off\",\n            tooltip: self.options[\"x-variable\"] == column_index ? \"Current x variable\" : \"Set as x variable\",\n            command: self.options[\"x-variable\"] == column_index ? \"\" : \"x-on\"\n          }, {\n            cssClass: self.options[\"y-variable\"] == column_index ? \"icon-y-on\" : \"icon-y-off\",\n            tooltip: self.options[\"y-variable\"] == column_index ? \"Current y variable\" : \"Set as y variable\",\n            command: self.options[\"y-variable\"] == column_index ? \"\" : \"y-on\"\n          });\n        }\n      return column;\n    }\n\n    self.columns = [];\n\n    self.columns.push(make_column(self.options.metadata[\"column-count\"] - 1, \"headerSimId\", \"rowSimId\", cell_formatter));\n    for (var i in self.options.inputs) {\n      self.columns.push(make_column(self.options.inputs[i], \"headerInput\", \"rowInput\", cell_formatter));\n    }for (var i in self.options.outputs) {\n      self.columns.push(make_column(self.options.outputs[i], \"headerOutput\", \"rowOutput\", cell_formatter));\n    }for (var i in self.options.ratings) {\n      self.columns.push(make_column(self.options.ratings[i], \"headerRating\", \"rowRating\", editable_cell_formatter));\n    }for (var i in self.options.categories) {\n      self.columns.push(make_column(self.options.categories[i], \"headerCategory\", \"rowCategory\", editable_cell_formatter));\n    }for (var i in self.options.others) {\n      self.columns.push(make_column(self.options.others[i], \"headerOther\", \"rowOther\", cell_formatter));\n    }self.data = new self._data_provider({\n      mid: self.options.mid,\n      aid: self.options.aid,\n      metadata: self.options.metadata,\n      sort_column: self.options[\"sort-variable\"],\n      sort_order: self.options[\"sort-order\"],\n      inputs: self.options.inputs,\n      outputs: self.options.outputs,\n      indexOfIndex: self.options.metadata[\"column-count\"] - 1,\n      hidden_simulations: self.options.hidden_simulations\n    });\n\n    self.trigger_row_selection = true;\n\n    self.grid = new Slick.Grid(self.element, self.data, self.columns, {\n      explicitInitialization: true,\n      enableColumnReorder: false,\n      editable: true,\n      editCommandHandler: self._editCommandHandler\n    });\n\n    self.data.onDataLoaded.subscribe(function (e, args) {\n      for (var i = args.from; i <= args.to; i++) {\n        self.grid.invalidateRow(i);\n      }\n      self.grid.render();\n    });\n\n    var header_buttons = new Slick.Plugins.HeaderButtons();\n    header_buttons.onCommand.subscribe(function (e, args) {\n      var column = args.column;\n      var button = args.button;\n      var command = args.command;\n      var grid = args.grid;\n\n      if (command == \"sort-ascending\" || command == \"sort-descending\") {\n        for (var i in self.columns) {\n          self.columns[i].header.buttons[0].cssClass = \"icon-sort-off\";\n          self.columns[i].header.buttons[0].tooltip = \"Sort ascending\";\n          self.columns[i].header.buttons[0].command = \"sort-ascending\";\n          grid.updateColumnHeader(self.columns[i].id);\n        }\n      }\n\n      if (command == \"sort-ascending\") {\n        button.cssClass = 'icon-sort-ascending';\n        button.command = 'sort-descending';\n        button.tooltip = 'Sort descending';\n        set_sort(column.id, \"ascending\");\n      } else if (command == \"sort-descending\") {\n        button.cssClass = 'icon-sort-descending';\n        button.command = 'sort-ascending';\n        button.tooltip = 'Sort ascending';\n        set_sort(column.id, \"descending\");\n      } else if (command == \"image-on\") {\n        for (var i = 0; i < self.options.images.length; i++) {\n          var index = grid.getColumnIndex(self.options.images[i]);\n          self.columns[index].header.buttons[1].cssClass = \"icon-image-off\";\n          self.columns[index].header.buttons[1].tooltip = \"Set as image variable\";\n          self.columns[index].header.buttons[1].command = \"image-on\";\n          grid.updateColumnHeader(self.columns[index].id);\n        }\n        button.cssClass = 'icon-image-on';\n        button.command = '';\n        button.tooltip = 'Current image variable';\n        self.element.trigger(\"images-selection-changed\", column.id);\n      } else if (command == \"x-on\") {\n        for (var i in self.columns) {\n          if (self.options.images.indexOf(self.columns[i].id) == -1 && self.options.metadata[\"column-count\"] - 1 != self.columns[i].id) {\n            self.columns[i].header.buttons[1].cssClass = \"icon-x-off\";\n            self.columns[i].header.buttons[1].tooltip = \"Set as x variable\";\n            self.columns[i].header.buttons[1].command = \"x-on\";\n            grid.updateColumnHeader(self.columns[i].id);\n          }\n        }\n        button.cssClass = 'icon-x-on';\n        button.command = '';\n        button.tooltip = 'Current x variable';\n        self.element.trigger(\"x-selection-changed\", column.id);\n      } else if (command == \"y-on\") {\n        for (var i in self.columns) {\n          if (self.options.images.indexOf(self.columns[i].id) == -1 && self.options.metadata[\"column-count\"] - 1 != self.columns[i].id) {\n            self.columns[i].header.buttons[2].cssClass = \"icon-y-off\";\n            self.columns[i].header.buttons[2].tooltip = \"Set as y variable\";\n            self.columns[i].header.buttons[2].command = \"y-on\";\n            grid.updateColumnHeader(self.columns[i].id);\n          }\n        }\n        button.cssClass = 'icon-y-on';\n        button.command = '';\n        button.tooltip = 'Current y variable';\n        self.element.trigger(\"y-selection-changed\", column.id);\n      }\n    });\n\n    self.grid.registerPlugin(header_buttons);\n    self.grid.registerPlugin(new Slick.AutoTooltips({ enableForHeaderCells: true }));\n\n    self.grid.setSelectionModel(new Slick.RowSelectionModel());\n    self.grid.onSelectedRowsChanged.subscribe(function (e, selection) {\n      // Don't trigger a selection event unless the selection was changed by user interaction (i.e. not outside callers or changing the sort order).\n      if (self.trigger_row_selection) {\n        self.data.get_indices(\"unsorted\", selection.rows, function (unsorted_rows) {\n          self.options[\"row-selection\"] = unsorted_rows;\n          self.element.trigger(\"row-selection-changed\", [unsorted_rows]);\n        });\n      }\n      self.trigger_row_selection = true;\n    });\n    self.grid.onHeaderClick.subscribe(function (e, args) {\n      if (!self._array_equal([args.column.field], self.options[\"variable-selection\"]) && self.options.images.indexOf(args.column.field) == -1) {\n        self.options[\"variable-selection\"] = [args.column.field];\n        self.element.trigger(\"variable-selection-changed\", [self.options[\"variable-selection\"]]);\n      }\n    });\n\n    self._color_variables(self.options[\"variable-selection\"]);\n\n    self.grid.init();\n\n    self.data.get_indices(\"sorted\", self.options[\"row-selection\"], function (sorted_rows) {\n      self.trigger_row_selection = false;\n      self.grid.setSelectedRows(sorted_rows);\n      self.grid.resetActiveCell();\n      if (sorted_rows.length) self.grid.scrollRowToTop(Math.min.apply(Math, sorted_rows));\n    });\n  },\n\n  resize_canvas: function resize_canvas() {\n    var self = this;\n    self.grid.resizeCanvas();\n  },\n\n  update_data: function update_data() {\n    var self = this;\n    self.data.invalidate();\n    self.grid.invalidate();\n    self.data.get_indices(\"sorted\", self.options[\"row-selection\"], function (sorted_rows) {\n      self.trigger_row_selection = false;\n      self.grid.setSelectedRows(sorted_rows);\n      self.grid.resetActiveCell();\n      if (sorted_rows.length) self.grid.scrollRowToTop(Math.min.apply(Math, sorted_rows));\n    });\n  },\n\n  _setOption: function _setOption(key, value) {\n    var self = this;\n\n    if (key == \"row-selection\") {\n      // Unexpectedly at this point self.options[key] has already been set to value, so this always returns even when the row-selection is unique\n      // if(self._array_equal(self.options[key], value))\n      //   return;\n\n      self.options[key] = value;\n      self.data.get_indices(\"sorted\", value, function (sorted_rows) {\n        self.trigger_row_selection = false;\n        self.grid.setSelectedRows(sorted_rows);\n        self.grid.resetActiveCell();\n        if (sorted_rows.length) self.grid.scrollRowToTop(Math.min.apply(Math, sorted_rows));\n      });\n    } else if (key == \"variable-selection\") {\n      if (self._array_equal(self.options[key], value)) return;\n\n      self.options[key] = value;\n      self._color_variables(value);\n    } else if (key == \"colorscale\") {\n      self.options[key] = value;\n      self._color_variables(self.options[\"variable-selection\"]);\n    } else if (key == \"x-variable\") {\n      self.options[key] = value;\n      self._set_selected_x();\n    } else if (key == \"y-variable\") {\n      self.options[key] = value;\n      self._set_selected_y();\n    } else if (key == \"image-variable\") {\n      self.options[key] = value;\n      self._set_selected_image();\n    } else if (key == \"metadata\") {\n      self.options[key] = value;\n      self._color_variables(self.options[\"variable-selection\"]);\n    } else if (key == \"statistics\") {\n      self.options[key] = value;\n      self._color_variables(self.options[\"variable-selection\"]);\n    } else if (key == \"hidden_simulations\") {\n      self.options[key] = value;\n      self.data.invalidate();\n      self.grid.invalidate();\n    }\n  },\n\n  _set_selected_x: function _set_selected_x() {\n    var self = this;\n    for (var i in self.columns) {\n      if (self.options.images.indexOf(self.columns[i].id) == -1 && self.options.metadata[\"column-count\"] - 1 != self.columns[i].id) {\n        if (self.columns[i].id == self.options[\"x-variable\"]) {\n          self.columns[i].header.buttons[1].cssClass = \"icon-x-on\";\n          self.columns[i].header.buttons[1].tooltip = \"Current x variable\";\n          self.columns[i].header.buttons[1].command = \"\";\n        } else {\n          self.columns[i].header.buttons[1].cssClass = \"icon-x-off\";\n          self.columns[i].header.buttons[1].tooltip = \"Set as x variable\";\n          self.columns[i].header.buttons[1].command = \"x-on\";\n        }\n        self.grid.updateColumnHeader(self.columns[i].id);\n      }\n    }\n  },\n\n  _set_selected_y: function _set_selected_y() {\n    var self = this;\n    for (var i in self.columns) {\n      if (self.options.images.indexOf(self.columns[i].id) == -1 && self.options.metadata[\"column-count\"] - 1 != self.columns[i].id) {\n        if (self.columns[i].id == self.options[\"y-variable\"]) {\n          self.columns[i].header.buttons[2].cssClass = \"icon-y-on\";\n          self.columns[i].header.buttons[2].tooltip = \"Current y variable\";\n          self.columns[i].header.buttons[2].command = \"\";\n        } else {\n          self.columns[i].header.buttons[2].cssClass = \"icon-y-off\";\n          self.columns[i].header.buttons[2].tooltip = \"Set as y variable\";\n          self.columns[i].header.buttons[2].command = \"y-on\";\n        }\n        self.grid.updateColumnHeader(self.columns[i].id);\n      }\n    }\n  },\n\n  _set_selected_image: function _set_selected_image() {\n    var self = this;\n    for (var i = 0; i < self.options.images.length; i++) {\n      var index = self.grid.getColumnIndex(self.options.images[i]);\n      if (self.columns[index].id == self.options[\"image-variable\"]) {\n        self.columns[index].header.buttons[1].cssClass = \"icon-image-on\";\n        self.columns[index].header.buttons[1].tooltip = \"Current image variable\";\n        self.columns[index].header.buttons[1].command = \"\";\n      } else {\n        self.columns[index].header.buttons[1].cssClass = \"icon-image-off\";\n        self.columns[index].header.buttons[1].tooltip = \"Set as image variable\";\n        self.columns[index].header.buttons[1].command = \"image-on\";\n      }\n      self.grid.updateColumnHeader(self.columns[index].id);\n    }\n  },\n\n  _color_variables: function _color_variables(variables) {\n    var self = this;\n\n    var columns = self.grid.getColumns();\n    for (var i in columns) {\n      var column = columns[i];\n      if (self.options.colorscale !== null && $.inArray(column.id, variables) != -1) {\n        column.colorscale = self.options.colorscale;\n        column.cssClass = column.cssClass.split(\" \")[0] + \" highlight\";\n      } else {\n        column.colorscale = null;\n        column.cssClass = column.cssClass.split(\" \")[0];\n      }\n    }\n    self.grid.invalidate();\n  },\n\n  _editCommandHandler: function _editCommandHandler(item, column, editCommand) {\n    console.log(\"editCommandHandler called\");\n    editCommand.execute();\n    // To Do: Attempt to save edit and undo it if Ajax call returns error\n    //editCommand.undo();\n  },\n\n  _data_provider: function _data_provider(parameters) {\n    var self = this;\n\n    self.mid = parameters.mid;\n    self.aid = parameters.aid;\n    self.metadata = parameters.metadata;\n    self.sort_column = parameters.sort_column;\n    self.sort_order = parameters.sort_order;\n    self.inputs = parameters.inputs;\n    self.outputs = parameters.outputs;\n    self.analysis_columns = self.inputs.concat(self.outputs);\n    self.indexOfIndex = parameters.indexOfIndex;\n    self.hidden_simulations = parameters.hidden_simulations;\n    self.ranked_indices = {};\n\n    self.pages = {};\n    self.pages_in_progress = {};\n    self.page_size = 50;\n\n    self.onDataLoaded = new Slick.Event();\n\n    self.getLength = function () {\n      return self.metadata[\"row-count\"];\n    };\n\n    self.getItem = function (index) {\n      var column_begin = 0;\n      var column_end = self.metadata[\"column-count\"];\n      var page = Math.floor(index / self.page_size);\n      var page_begin = page * self.page_size;\n\n      if (self.pages_in_progress[page]) {\n        return null;\n      }\n\n      if (!(page in self.pages)) {\n        self.pages_in_progress[page] = true;\n        var row_begin = page_begin;\n        var row_end = (page + 1) * self.page_size;\n\n        var sort = \"\";\n        if (self.sort_column !== null && self.sort_order !== null) {\n          var sort_column = \"a\" + self.sort_column;\n          var sort_order = self.sort_order;\n          if (sort_order == 'ascending') {\n            sort_order = 'asc';\n          } else if (sort_order == 'descending') {\n            sort_order = 'desc';\n          }\n          if (self.sort_column == self.metadata[\"column-count\"] - 1) sort_column = \"index(0)\";\n          sort = \"/order: rank(\" + sort_column + ', \"' + sort_order + '\")';\n        }\n\n        $.ajax({\n          type: \"GET\",\n          url: _slycatServerRoot2.default + \"models/\" + self.mid + \"/arraysets/\" + self.aid + \"/data?hyperchunks=0/\" + column_begin + \":\" + (column_end - 1) + \"|index(0)\" + sort + \"/\" + row_begin + \":\" + row_end,\n          success: function success(data) {\n            self.pages[page] = [];\n            for (var i = 0; i < data[0].length; i++) {\n              var result = {};\n              for (var j = column_begin; j != column_end; ++j) {\n                result[j] = data[j][i];\n              }\n              self.pages[page].push(result);\n            }\n            self.pages_in_progress[page] = false;\n            self.onDataLoaded.notify({ from: row_begin, to: row_end });\n          },\n          error: function error(request, status, reason_phrase) {\n            console.log(\"error\", request, status, reason_phrase);\n          }\n        });\n        return null;\n      }\n\n      return self.pages[page][index - page_begin];\n    };\n\n    self.getItemMetadata = function (index) {\n      var page = Math.floor(index / self.page_size);\n      if (self.pages_in_progress[page] || !(page in self.pages)) {\n        return null;\n      }\n\n      var row = this.getItem(index);\n      var column_end = self.analysis_columns.length;\n      var cssClasses = \"\";\n      for (var i = 0; i != column_end; i++) {\n        if (row[self.analysis_columns[i]] == null) {\n          cssClasses += \"nullRow \";\n        }\n      }\n      if ($.inArray(row[self.indexOfIndex], self.hidden_simulations) != -1) {\n        cssClasses += \"hiddenRow \";\n      }\n      if (cssClasses != \"\") return { \"cssClasses\": cssClasses };\n      return null;\n    };\n\n    self.set_sort = function (column, order) {\n      if (column == self.sort_column && order == self.sort_order) return;\n      self.sort_column = column;\n      self.sort_order = order;\n      self.pages = {};\n    };\n\n    self.get_indices = function (direction, rows, callback) {\n      if (rows.length == 0) {\n        callback([]);\n        return;\n      }\n      // We have no sort column or order, so just returning the same rows as were asked for since they're in the same order\n      if (self.sort_column == null || self.sort_order == null) {\n        callback(rows);\n      } else {\n        if (self.ranked_indices[self.sort_column]) {\n          // we have data for this column, so figure out what to return\n          var indices = self.ranked_indices[self.sort_column];\n          // Reverse response indexes for descending sort order\n          if (self.sort_order == 'descending') {\n            var plain_array = [];\n            for (var i = 0; i < indices.length; i++) {\n              plain_array.push(indices[i]);\n            }\n            indices = plain_array.reverse();\n          }\n          var response = [];\n          for (var i = 0; i < rows.length; i++) {\n            if (direction == \"unsorted\") {\n              response.push(indices[rows[i]]);\n            } else if (direction == \"sorted\") {\n              response.push(indices.indexOf(rows[i]));\n            }\n          }\n          callback(new Int32Array(response));\n        } else {\n          if (self.sort_column == self.metadata[\"column-count\"] - 1) {\n            // we are sorting by the index column, so we can just make the data we need.\n            self.ranked_indices[self.sort_column] = new Int32Array(_d2.default.range(self.metadata[\"row-count\"]));\n            self.get_indices(direction, rows, callback);\n          } else {\n            // we have no data for this column, so go retrieve it and call this function again.\n            var request = new XMLHttpRequest();\n            request.open(\"GET\", _slycatServerRoot2.default + \"models/\" + self.mid + \"/arraysets/data-table/data?hyperchunks=0/rank(a\" + self.sort_column + ',\"asc\")/...&byteorder=' + (chunker.is_little_endian() ? \"little\" : \"big\"));\n            request.responseType = \"arraybuffer\";\n            request.direction = direction;\n            request.rows = rows;\n            request.callback = callback;\n            request.onload = function (e) {\n              var indices = [];\n              var data = new Int32Array(this.response);\n              // Filtering out every other element in the reponse array, because it's full of extraneous 0 (zeros) for some reason.\n              // Need to figure out why, but this is a fix for now.\n              for (var i = 0; i < data.length; i = i + 2) {\n                indices.push(data[i]);\n              }\n              self.ranked_indices[self.sort_column] = new Int32Array(indices);\n              self.get_indices(this.direction, this.rows, this.callback);\n            };\n            request.send();\n          }\n        }\n      }\n    };\n\n    self.invalidate = function () {\n      self.pages = {};\n    };\n  },\n\n  _array_equal: function _array_equal(a, b) {\n    return $(a).not(b).length == 0 && $(b).not(a).length == 0;\n  }\n}); /* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\n////////////////////////////////////////////////////////////////////////////////////////\n// Slickgrid-based data table widget, for use with the CCA model.\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\")))\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-table.js?");

/***/ }),

/***/ "./web-server/plugins/slycat-parameter-image-plus-model/js/ui.js":
/*!***********************************************************************!*\
  !*** ./web-server/plugins/slycat-parameter-image-plus-model/js/ui.js ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($) {\n\nvar _jqueryUi = __webpack_require__(/*! jquery-ui/themes/base/jquery-ui.css */ \"./node_modules/jquery-ui/themes/base/jquery-ui.css\");\n\nvar _jqueryUi2 = _interopRequireDefault(_jqueryUi);\n\nvar _slickGrid = __webpack_require__(/*! css/slickgrid/slick.grid.css */ \"./web-server/css/slickgrid/slick.grid.css\");\n\nvar _slickGrid2 = _interopRequireDefault(_slickGrid);\n\nvar _slickDefaultTheme = __webpack_require__(/*! css/slickgrid/slick-default-theme.css */ \"./web-server/css/slickgrid/slick-default-theme.css\");\n\nvar _slickDefaultTheme2 = _interopRequireDefault(_slickDefaultTheme);\n\nvar _slickHeaderbuttons = __webpack_require__(/*! css/slickgrid/slick.headerbuttons.css */ \"./web-server/css/slickgrid/slick.headerbuttons.css\");\n\nvar _slickHeaderbuttons2 = _interopRequireDefault(_slickHeaderbuttons);\n\nvar _slickSlycatTheme = __webpack_require__(/*! css/slick-slycat-theme.css */ \"./web-server/css/slick-slycat-theme.css\");\n\nvar _slickSlycatTheme2 = _interopRequireDefault(_slickSlycatTheme);\n\nvar _slycatAdditions = __webpack_require__(/*! css/slycat-additions.css */ \"./web-server/css/slycat-additions.css\");\n\nvar _slycatAdditions2 = _interopRequireDefault(_slycatAdditions);\n\nvar _ui = __webpack_require__(/*! ../css/ui.css */ \"./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _slycatServerRoot = __webpack_require__(/*! js/slycat-server-root */ \"./web-server/js/slycat-server-root.js\");\n\nvar _slycatServerRoot2 = _interopRequireDefault(_slycatServerRoot);\n\nvar _knockout = __webpack_require__(/*! knockout */ \"./node_modules/knockout/build/output/knockout-latest.debug.js\");\n\nvar _knockout2 = _interopRequireDefault(_knockout);\n\nvar _slycatWebClientWebpack = __webpack_require__(/*! js/slycat-web-client-webpack */ \"./web-server/js/slycat-web-client-webpack.js\");\n\nvar _slycatWebClientWebpack2 = _interopRequireDefault(_slycatWebClientWebpack);\n\nvar _slycatBookmarkManagerWebpack = __webpack_require__(/*! js/slycat-bookmark-manager-webpack */ \"./web-server/js/slycat-bookmark-manager-webpack.js\");\n\nvar _slycatBookmarkManagerWebpack2 = _interopRequireDefault(_slycatBookmarkManagerWebpack);\n\nvar _slycatDialogWebpack = __webpack_require__(/*! js/slycat-dialog-webpack */ \"./web-server/js/slycat-dialog-webpack.js\");\n\nvar dialog = _interopRequireWildcard(_slycatDialogWebpack);\n\nvar _d = __webpack_require__(/*! js/d3.min */ \"./web-server/js/d3.min.js\");\n\nvar _d2 = _interopRequireDefault(_d);\n\nvar _urijs = __webpack_require__(/*! urijs */ \"./node_modules/urijs/src/URI.js\");\n\nvar _urijs2 = _interopRequireDefault(_urijs);\n\nvar _chunker = __webpack_require__(/*! js/chunker */ \"./web-server/js/chunker.js\");\n\nvar chunker = _interopRequireWildcard(_chunker);\n\n__webpack_require__(/*! js/slycat-job-checker-webpack */ \"./web-server/js/slycat-job-checker-webpack.js\");\n\n__webpack_require__(/*! ./parameter-image-scatterplot */ \"./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-scatterplot.js\");\n\n__webpack_require__(/*! ./parameter-controls */ \"./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-controls.js\");\n\n__webpack_require__(/*! ./parameter-image-dendrogram */ \"./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-dendrogram.js\");\n\n__webpack_require__(/*! ./parameter-image-table */ \"./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-table.js\");\n\n__webpack_require__(/*! ./color-switcher */ \"./web-server/plugins/slycat-parameter-image-plus-model/js/color-switcher.js\");\n\n__webpack_require__(/*! jquery-ui */ \"./node_modules/jquery-ui/jquery-ui.js\");\n\n__webpack_require__(/*! js/jquery.layout-latest.min */ \"./web-server/js/jquery.layout-latest.min.js\");\n\n__webpack_require__(/*! js/slycat-navbar-webpack */ \"./web-server/js/slycat-navbar-webpack.js\");\n\nvar _slycatModelMainWebpack = __webpack_require__(/*! js/slycat-model-main-webpack */ \"./web-server/js/slycat-model-main-webpack.js\");\n\nvar slycat_model_main = _interopRequireWildcard(_slycatModelMainWebpack);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Wait for document ready\n$(document).ready(function () {\n\n  slycat_model_main.start();\n  _knockout2.default.applyBindings({}, document.getElementsByClassName('slycat-content')[0]);\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Setup global variables.\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  var model = null;\n  var default_image = null;\n  var model_id = (0, _urijs2.default)(window.location).segment(-1);\n  var input_columns = null;\n  var output_columns = null;\n  var image_columns = null;\n  var rating_columns = null;\n  var category_columns = null;\n\n  var bookmarker = null;\n  var bookmark = null;\n\n  var clusters = null; // This is just the list of cluster names\n  var cluster_index = null; // This is the index of the currently selected cluster\n  var clusters_data = null; // This holds data for each cluster\n\n  var table_metadata = null;\n  var table_statistics = null;\n  var indices = null;\n  var x_index = null;\n  var y_index = null;\n  var v_index = null;\n  var images_index = null;\n  var x = null;\n  var y = null;\n  var v = null;\n  var images = null;\n  var selected_simulations = null;\n  var hidden_simulations = null;\n  var colormap = null;\n  var colorscale = null;\n  var auto_scale = null;\n  var filtered_v = null;\n\n  var table_ready = false;\n  var scatterplot_ready = false;\n  var controls_ready = false;\n  var dendrogram_ready = false;\n  var cluster_ready = false;\n\n  var image_uri = document.createElement(\"a\");\n  var grid_pane = \"#parameter-image-plus-layout\";\n  // image_cache needs to be shared between dendrogram and scatterplot, thus it is passed inside an array to keep it in sync.\n  // http://api.jqueryui.com/jquery.widget/\n  // All options passed on init are deep-copied to ensure the objects can be modified later without affecting the widget.\n  // Arrays are the only exception, they are referenced as-is.\n  // This exception is in place to support data-binding, where the data source has to be kept as a reference.\n  var image_cache = {};\n  var cache_references = [image_cache];\n\n  var login_dialog = $(\"#remote-login-dialog\");\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Setup page layout.\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  login_dialog.dialog({\n    autoOpen: false,\n    width: 700,\n    height: 300,\n    modal: true,\n    close: function close() {\n      $(\"#remote-password\", this).val(\"\");\n    },\n    open: function open() {\n      // Neither of these work on the first instantiation of the dialog.\n      // $(\"#remote-username\", this).focus();\n      // setTimeout(function(){\n      //   $(\"#remote-username\").focus();\n      // },1);\n    }\n  });\n\n  // Enter key in password field triggers click on Login button\n  $(\"#remote-password\", login_dialog).keypress(function (event) {\n    if (event.keyCode == 13) {\n      $('.ui-dialog-buttonset', login_dialog.parent()).find('button:contains(Login)').trigger('click');\n    }\n  });\n\n  $(\"#parameter-image-plus-layout\").layout({\n    north: {\n      size: 28,\n      resizable: false\n    },\n    center: {\n      // resizeWhileDragging: false,\n      // onresize: function() {\n      //   $(\"#scatterplot\").scatterplot(\"option\", {\n      //     width: $(\"#scatterplot-pane\").width(),\n      //     height: $(\"#scatterplot-pane\").height()\n      //   });\n      // },\n    },\n    west: {\n      size: $(\"#parameter-image-plus-layout\").width() / 2,\n      resizeWhileDragging: false,\n      onresize: function onresize() {\n        $(\"#dendrogram-viewer\").dendrogram(\"resize_canvas\");\n      }\n    },\n    south: {\n      size: $(\"#parameter-image-plus-layout\").height() / 4,\n      resizeWhileDragging: false,\n      onresize: function onresize() {\n        $(\"#table\").css(\"height\", $(\"#table-pane\").height());\n        $(\"#table\").table(\"resize_canvas\");\n      }\n    }\n  });\n\n  $(\"#model-pane\").layout({\n    center: {\n      resizeWhileDragging: false,\n      onresize: function onresize() {\n        $(\"#scatterplot\").scatterplot(\"option\", {\n          width: $(\"#scatterplot-pane\").width(),\n          height: $(\"#scatterplot-pane\").height()\n        });\n      }\n    }\n  });\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Load the model\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  $.ajax({\n    type: \"GET\",\n    url: _slycatServerRoot2.default + \"models/\" + model_id,\n    success: function success(result) {\n      model = result;\n      bookmarker = _slycatBookmarkManagerWebpack2.default.create(model.project, model._id);\n      input_columns = model[\"artifact:input-columns\"];\n      output_columns = model[\"artifact:output-columns\"];\n      image_columns = model[\"artifact:image-columns\"];\n      rating_columns = model[\"artifact:rating-columns\"] == undefined ? [] : model[\"artifact:rating-columns\"];\n      category_columns = model[\"artifact:category-columns\"] == undefined ? [] : model[\"artifact:category-columns\"];\n      default_image = model[\"artifact:default-image\"];\n\n      if (default_image === null || default_image === undefined) default_image = 0;\n\n      model_loaded();\n    },\n    error: function error(request, status, reason_phrase) {\n      window.alert(\"Error retrieving model: \" + reason_phrase);\n    }\n  });\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Once the model has been loaded, retrieve metadata / bookmarked state\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  var show_checkjob = function show_checkjob() {\n    var jc = $('#parameter-image-plus-layout').children()[0];\n    var $jc = $(jc);\n    $jc.detach();\n\n    $($('#parameter-image-plus-layout').children()).remove();\n    $('#parameter-image-plus-layout').append($jc);\n\n    var vm = _knockout2.default.dataFor($('.slycat-job-checker')[0]);\n    vm.set_jid(model['artifact:jid']);\n  };\n\n  function model_loaded() {\n    // If the model isn't ready or failed, we're done.\n    if (model[\"state\"] == \"waiting\" || model[\"state\"] == \"running\") {\n      show_checkjob();\n      return;\n    }\n    if (model[\"state\"] == \"closed\" && model[\"result\"] === null) return;\n    if (model[\"result\"] == \"failed\") return;\n\n    // Display progress as the load happens ...\n    $(\".load-status\").text(\"Loading data.\");\n\n    // Load list of clusters.\n    $.ajax({\n      url: _slycatServerRoot2.default + \"models/\" + model_id + \"/files/clusters\",\n      contentType: \"application/json\",\n      success: function success(result) {\n        clusters = result;\n        clusters_data = new Array(clusters.length);\n        retrieve_current_cluster();\n        setup_controls();\n        setup_dendrogram();\n      },\n      error: artifact_missing\n    });\n\n    // Load data table metadata.\n    $.ajax({\n      url: _slycatServerRoot2.default + \"models/\" + model_id + \"/tables/data-table/arrays/0/metadata?index=Index\",\n      contentType: \"application/json\",\n      success: function success(metadata) {\n        table_metadata = metadata;\n        table_statistics = new Array(metadata[\"column-count\"]);\n        table_statistics[metadata[\"column-count\"] - 1] = { \"max\": metadata[\"row-count\"] - 1, \"min\": 0 };\n        load_table_statistics(_d2.default.range(metadata[\"column-count\"] - 1), metadata_loaded);\n      },\n      error: artifact_missing\n    });\n\n    // Retrieve bookmarked state information ...\n    bookmarker.getState(function (state) {\n      bookmark = state;\n      cluster_index = bookmark[\"cluster-index\"] !== undefined ? bookmark[\"cluster-index\"] : 0;\n      retrieve_current_cluster();\n      setup_controls();\n      setup_colorswitcher();\n      metadata_loaded();\n    });\n  }\n\n  function artifact_missing() {\n    $(\".load-status\").css(\"display\", \"none\");\n\n    dialog.dialog({\n      title: \"Load Error\",\n      message: \"Oops, there was a problem retrieving data from the model. This likely means that there was a problem during computation.\"\n    });\n  }\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Setup the rest of the UI as data is received.\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  function build_dendrogram_node_options(cluster_index) {\n    var dendrogram_options = {\n      cluster: cluster_index\n    };\n\n    dendrogram_options.collapsed_nodes = bookmark[cluster_index + \"-collapsed-nodes\"];\n    dendrogram_options.expanded_nodes = bookmark[cluster_index + \"-expanded-nodes\"];\n    dendrogram_options.selected_nodes = bookmark[cluster_index + \"-selected-nodes\"];\n    dendrogram_options.highlight = bookmark[cluster_index + \"-selected-row-simulations\"];\n\n    return dendrogram_options;\n  }\n\n  function retrieve_current_cluster() {\n    if (!cluster_ready && cluster_index != null && clusters != null) {\n      cluster_ready = true;\n\n      $.ajax({\n        url: _slycatServerRoot2.default + \"models/\" + model_id + \"/files/cluster-\" + clusters[cluster_index],\n        contentType: \"application/json\",\n        success: function success(cluster_data) {\n          clusters_data[cluster_index] = cluster_data;\n          setup_dendrogram();\n        },\n        error: artifact_missing\n      });\n    }\n  }\n\n  function setup_colorswitcher() {\n    var colormap = bookmark[\"colormap\"] !== undefined ? bookmark[\"colormap\"] : \"night\";\n\n    $(\"#color-switcher\").colorswitcher({ colormap: colormap });\n\n    $(\"#color-switcher\").bind(\"colormap-changed\", function (event, colormap) {\n      selected_colormap_changed(colormap);\n    });\n  }\n\n  function metadata_loaded() {\n    setup_table();\n\n    if (!indices && table_metadata) {\n      var count = table_metadata[\"row-count\"];\n      indices = new Int32Array(count);\n      for (var i = 0; i != count; ++i) {\n        indices[i] = i;\n      }\n    }\n\n    setup_controls();\n\n    if (table_metadata && bookmark) {\n      // Choose some columns for the X and Y axes.\n      var numeric_variables = [];\n      for (var i = 0; i < table_metadata[\"column-count\"] - 1; i++) {\n        // Only use non-string columns that are not used for ratings or categories\n        if (table_metadata[\"column-types\"][i] != 'string' && rating_columns.indexOf(i) == -1 && category_columns.indexOf(i) == -1) numeric_variables.push(i);\n      }\n\n      x_index = numeric_variables[0];\n      y_index = numeric_variables[1 % numeric_variables.length];\n      if (\"x-selection\" in bookmark) x_index = Number(bookmark[\"x-selection\"]);\n      if (\"y-selection\" in bookmark) y_index = Number(bookmark[\"y-selection\"]);\n      auto_scale = true;\n      if (\"auto-scale\" in bookmark) {\n        auto_scale = bookmark[\"auto-scale\"];\n      }\n\n      // Set state of selected and hidden simulations\n      selected_simulations = [];\n      if (\"simulation-selection\" in bookmark) selected_simulations = bookmark[\"simulation-selection\"];\n      hidden_simulations = [];\n      if (\"hidden-simulations\" in bookmark) hidden_simulations = bookmark[\"hidden-simulations\"];\n\n      chunker.get_model_array_attribute({\n        server_root: _slycatServerRoot2.default,\n        mid: model_id,\n        aid: \"data-table\",\n        array: 0,\n        attribute: x_index,\n        success: function success(result) {\n          x = result;\n          if (table_metadata[\"column-types\"][x_index] == \"string\") {\n            x = x[0];\n          }\n          setup_scatterplot();\n          setup_table();\n        },\n        error: artifact_missing\n      });\n\n      chunker.get_model_array_attribute({\n        server_root: _slycatServerRoot2.default,\n        mid: model_id,\n        aid: \"data-table\",\n        array: 0,\n        attribute: y_index,\n        success: function success(result) {\n          y = result;\n          if (table_metadata[\"column-types\"][y_index] == \"string\") {\n            y = y[0];\n          }\n          setup_scatterplot();\n          setup_table();\n        },\n        error: artifact_missing\n      });\n\n      v_index = table_metadata[\"column-count\"] - 1;\n      if (\"variable-selection\" in bookmark) v_index = Number(bookmark[\"variable-selection\"]);\n\n      if (v_index == table_metadata[\"column-count\"] - 1) {\n        var count = table_metadata[\"row-count\"];\n        v = new Float64Array(count);\n        for (var i = 0; i != count; ++i) {\n          v[i] = i;\n        }update_current_colorscale();\n        setup_scatterplot();\n        setup_table();\n        setup_dendrogram();\n      } else {\n        chunker.get_model_array_attribute({\n          server_root: _slycatServerRoot2.default,\n          mid: model_id,\n          aid: \"data-table\",\n          array: 0,\n          attribute: v_index,\n          success: function success(result) {\n            v = result;\n            if (table_metadata[\"column-types\"][v_index] == \"string\") {\n              v = v[0];\n            }\n            update_current_colorscale();\n            setup_scatterplot();\n            setup_table();\n            setup_dendrogram();\n          },\n          error: artifact_missing\n        });\n      }\n\n      images_index = image_columns[default_image];\n      if (\"images-selection\" in bookmark) images_index = bookmark[\"images-selection\"];\n      setup_table();\n      if (image_columns.length > 0) {\n        $.ajax({\n          type: \"GET\",\n          url: _slycatServerRoot2.default + \"models/\" + model_id + \"/arraysets/data-table/data?hyperchunks=0/\" + images_index + \"/0:\" + table_metadata[\"row-count\"],\n          success: function success(result) {\n            images = result[0];\n            setup_scatterplot();\n            setup_dendrogram();\n            //setup_table();\n          },\n          error: artifact_missing\n        });\n      } else {\n        images = undefined;\n        setup_scatterplot();\n        setup_dendrogram();\n      }\n      setup_controls();\n    }\n  }\n\n  function setup_dendrogram() {\n    if (!dendrogram_ready && bookmark && clusters != null && cluster_index != null && clusters_data != null && clusters_data[cluster_index] !== undefined && colorscale && v && selected_simulations != null && images !== null) {\n      dendrogram_ready = true;\n      console.log(\"dendrogram ready to be initiated.\");\n\n      $(\"#dendrogram-pane .load-status\").css(\"display\", \"none\");\n\n      $(\"#dendrogram-leaf-backdrop\").css({\n        \"background-color\": $(\"#color-switcher\").colorswitcher(\"get_background\").toString()\n      });\n\n      var dendrogram_options = build_dendrogram_node_options(cluster_index);\n      dendrogram_options.clusters = clusters;\n      dendrogram_options.cluster_data = clusters_data[cluster_index];\n      dendrogram_options.colorscale = colorscale;\n      dendrogram_options.color_array = v;\n      dendrogram_options.images = images;\n      dendrogram_options.cache_references = cache_references;\n      dendrogram_options.login_dialog = login_dialog;\n\n      if (bookmark[\"sort-variable\"] != undefined) {\n        dendrogram_options.dendrogram_sort_order = false;\n      }\n\n      dendrogram_options[\"highlight\"] = selected_simulations;\n\n      $(\"#dendrogram-viewer\").dendrogram(dendrogram_options);\n\n      // Log and bookmark changes to the node selection ...\n      $(\"#dendrogram-viewer\").bind(\"node-selection-changed\", function (event, parameters) {\n        selected_node_changed(parameters);\n      });\n\n      // Changing the selected dendrogram node updates the waveform plot ...\n      $(\"#dendrogram-viewer\").bind(\"node-selection-changed\", function (event, parameters) {\n        // Only want to update the waveform plot if the user changed the selected node. It's automatically set at dendrogram creation time, and we want to avoid updating the waveform plot at that time.\n        if (parameters.skip_bookmarking != true) {\n          // $(\"#waveform-viewer\").waveformplot(\"option\", \"selection\", getWaveformIndexes(parameters.selection));\n\n          // if(bookmark[$(\"#cluster-viewer\").cluster(\"option\", \"cluster\") + \"-selected-row-simulations\"] !== undefined)\n          //   $(\"#waveform-viewer\").waveformplot(\"option\", \"highlight\", bookmark[$(\"#cluster-viewer\").cluster(\"option\", \"cluster\") + \"-selected-row-simulations\"]);\n\n          var visible_simulations = getNodeIndexes(parameters.selection, \"image-index\");\n\n          while (hidden_simulations.length > 0) {\n            hidden_simulations.pop();\n          }\n\n          for (var i = 0; i < indices.length; i++) {\n            var index = indices[i];\n            if (visible_simulations.indexOf(index) < 0) {\n              hidden_simulations.push(index);\n            }\n          }\n          update_widgets_when_hidden_simulations_change(true);\n        }\n      });\n\n      // Bookmark changes to expanded and collapsed nodes ...\n      $(\"#dendrogram-viewer\").bind(\"expanded-collapsed-nodes-changed\", function (event, nodes) {\n        expanded_collapsed_nodes_changed(nodes);\n      });\n\n      // Log changes to node toggle ...\n      $(\"#dendrogram-viewer\").bind(\"node-toggled\", function (event, node) {\n        node_toggled(node);\n      });\n\n      // Changing the scatterplot selection updates the table row selection and controls ..\n      $(\"#dendrogram-viewer\").bind(\"selection-changed\", function (event, selection) {\n        $(\"#table\").table(\"option\", \"row-selection\", selection);\n        $(\"#controls\").controls(\"option\", \"selection\", selection);\n        $(\"#scatterplot\").scatterplot(\"option\", \"selection\", selection);\n        selected_simulations_changed(selection);\n      });\n    }\n  }\n\n  function setup_table() {\n    if (!table_ready && table_metadata && table_statistics.length == table_metadata[\"column-count\"] && colorscale && bookmark && x_index != null && y_index != null && images_index !== null && selected_simulations != null && hidden_simulations != null) {\n      table_ready = true;\n\n      $(\"#table-pane .load-status\").css(\"display\", \"none\");\n\n      var other_columns = [];\n      for (var i = 0; i != table_metadata[\"column-count\"] - 1; ++i) {\n        if ($.inArray(i, input_columns) == -1 && $.inArray(i, output_columns) == -1 && $.inArray(i, rating_columns) == -1 && $.inArray(i, category_columns) == -1) other_columns.push(i);\n      }\n\n      var table_options = {\n        \"server-root\": _slycatServerRoot2.default,\n        mid: model_id,\n        aid: \"data-table\",\n        metadata: table_metadata,\n        statistics: table_statistics,\n        inputs: input_columns,\n        outputs: output_columns,\n        others: other_columns,\n        images: image_columns,\n        ratings: rating_columns,\n        categories: category_columns,\n        \"image-variable\": images_index,\n        \"x-variable\": x_index,\n        \"y-variable\": y_index,\n        \"row-selection\": selected_simulations,\n        hidden_simulations: hidden_simulations\n      };\n\n      var colormap = bookmark[\"colormap\"] !== undefined ? bookmark[\"colormap\"] : \"night\";\n      table_options.colorscale = colorscale;\n\n      if (\"sort-variable\" in bookmark && \"sort-order\" in bookmark) {\n        table_options[\"sort-variable\"] = bookmark[\"sort-variable\"];\n        table_options[\"sort-order\"] = bookmark[\"sort-order\"];\n      }\n\n      if (\"variable-selection\" in bookmark) {\n        table_options[\"variable-selection\"] = [bookmark[\"variable-selection\"]];\n      } else {\n        table_options[\"variable-selection\"] = [table_metadata[\"column-count\"] - 1];\n      }\n\n      $(\"#table\").table(table_options);\n\n      // Log changes to the table sort order ...\n      $(\"#table\").bind(\"variable-sort-changed\", function (event, variable, order) {\n        variable_sort_changed(variable, order);\n      });\n\n      // Log changes to the x variable ...\n      $(\"#table\").bind(\"x-selection-changed\", function (event, variable) {\n        x_selection_changed(variable);\n      });\n\n      // Log changes to the y variable ...\n      $(\"#table\").bind(\"y-selection-changed\", function (event, variable) {\n        y_selection_changed(variable);\n      });\n\n      // Changing the table row selection updates the scatterplot and controls ...\n      // Log changes to the table row selection ...\n      $(\"#table\").bind(\"row-selection-changed\", function (event, selection) {\n        // The table selection is an array buffer which can't be\n        // serialized as JSON, so convert it to an array.\n        var temp = [];\n        for (var i = 0; i != selection.length; ++i) {\n          temp.push(selection[i]);\n        }selected_simulations_changed(temp);\n        $(\"#scatterplot\").scatterplot(\"option\", \"selection\", temp);\n        $(\"#controls\").controls(\"option\", \"selection\", temp);\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", \"highlight\", temp);\n      });\n\n      // Changing the scatterplot selection updates the table row selection and controls ..\n      $(\"#scatterplot\").bind(\"selection-changed\", function (event, selection) {\n        $(\"#table\").table(\"option\", \"row-selection\", selection);\n        $(\"#controls\").controls(\"option\", \"selection\", selection);\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", \"highlight\", selection);\n      });\n\n      // Changing the x variable updates the table ...\n      $(\"#controls\").bind(\"x-selection-changed\", function (event, variable) {\n        $(\"#table\").table(\"option\", \"x-variable\", variable);\n      });\n\n      // Changing the y variable updates the table ...\n      $(\"#controls\").bind(\"y-selection-changed\", function (event, variable) {\n        $(\"#table\").table(\"option\", \"y-variable\", variable);\n      });\n\n      // Changing the image variable updates the table ...\n      $(\"#controls\").bind(\"images-selection-changed\", function (event, variable) {\n        $(\"#table\").table(\"option\", \"image-variable\", variable);\n      });\n\n      // Handle table variable selection ...\n      $(\"#table\").bind(\"variable-selection-changed\", function (event, selection) {\n        // Changing the table variable updates the controls ...\n        $(\"#controls\").controls(\"option\", \"color-variable\", selection[0]);\n\n        // Handle changes to the table variable selection ...\n        handle_color_variable_change(selection[0]);\n      });\n\n      // Handle color variable selection ...\n      $(\"#controls\").bind(\"color-selection-changed\", function (event, variable) {\n        // Changing the color variable updates the table ...\n        $(\"#table\").table(\"option\", \"variable-selection\", [Number(variable)]);\n\n        // Handle changes to the color variable ...\n        handle_color_variable_change(variable);\n      });\n    }\n  }\n\n  function setup_scatterplot() {\n    // Setup the scatterplot ...\n    if (!scatterplot_ready && bookmark && indices && x && y && v && images !== null && colorscale && selected_simulations != null && hidden_simulations != null && auto_scale != null) {\n      scatterplot_ready = true;\n\n      $(\"#scatterplot-pane .load-status\").css(\"display\", \"none\");\n\n      var colormap = bookmark[\"colormap\"] !== undefined ? bookmark[\"colormap\"] : \"night\";\n\n      $(\"#scatterplot-pane\").css(\"background\", $(\"#color-switcher\").colorswitcher(\"get_background\", colormap).toString());\n\n      var open_images = [];\n      if (\"open-images-selection\" in bookmark) {\n        open_images = bookmark[\"open-images-selection\"];\n      }\n\n      $(\"#scatterplot\").scatterplot({\n        indices: indices,\n        x_label: table_metadata[\"column-names\"][x_index],\n        y_label: table_metadata[\"column-names\"][y_index],\n        v_label: table_metadata[\"column-names\"][v_index],\n        x: x,\n        y: y,\n        v: v,\n        x_string: table_metadata[\"column-types\"][x_index] == \"string\",\n        y_string: table_metadata[\"column-types\"][y_index] == \"string\",\n        v_string: table_metadata[\"column-types\"][v_index] == \"string\",\n        images: images,\n        width: $(\"#scatterplot-pane\").width(),\n        height: $(\"#scatterplot-pane\").height(),\n        colorscale: colorscale,\n        selection: selected_simulations,\n        open_images: open_images,\n        gradient: $(\"#color-switcher\").colorswitcher(\"get_gradient_data\", colormap),\n        hidden_simulations: hidden_simulations,\n        \"auto-scale\": auto_scale,\n        cache_references: cache_references,\n        login_dialog: login_dialog\n      });\n\n      $(\"#scatterplot\").bind(\"selection-changed\", function (event, selection) {\n        selected_simulations_changed(selection);\n      });\n\n      // Changing the x variable updates the scatterplot ...\n      $(\"#table\").bind(\"x-selection-changed\", function (event, variable) {\n        update_scatterplot_x(variable);\n      });\n      $(\"#controls\").bind(\"x-selection-changed\", function (event, variable) {\n        update_scatterplot_x(variable);\n      });\n\n      // Changing the y variable updates the scatterplot ...\n      $(\"#table\").bind(\"y-selection-changed\", function (event, variable) {\n        update_scatterplot_y(variable);\n      });\n      $(\"#controls\").bind(\"y-selection-changed\", function (event, variable) {\n        update_scatterplot_y(variable);\n      });\n\n      // Changing the images variable updates the scatterplot ...\n      $(\"#table\").bind(\"images-selection-changed\", function (event, variable) {\n        handle_image_variable_change(variable);\n      });\n      $(\"#controls\").bind(\"images-selection-changed\", function (event, variable) {\n        handle_image_variable_change(variable);\n      });\n\n      // Log changes to open images ...\n      $(\"#scatterplot\").bind(\"open-images-changed\", function (event, selection) {\n        open_images_changed(selection);\n      });\n    }\n  }\n\n  function setup_controls() {\n    if (!controls_ready && table_metadata && image_columns !== null && rating_columns != null && category_columns != null && x_index != null && y_index != null && auto_scale != null && images_index !== null && selected_simulations != null && hidden_simulations != null && indices\n    // && (cluster_index != null) && (clusters != null)\n    ) {\n        controls_ready = true;\n        var numeric_variables = [];\n        var axes_variables = [];\n        var color_variables = [];\n\n        for (var i = 0; i < table_metadata[\"column-count\"]; i++) {\n          if (table_metadata[\"column-types\"][i] != 'string') {\n            numeric_variables.push(i);\n          }\n          if (image_columns.indexOf(i) == -1 && table_metadata[\"column-count\"] - 1 > i) {\n            axes_variables.push(i);\n          }\n          if (image_columns.indexOf(i) == -1) {\n            color_variables.push(i);\n          }\n        }\n\n        var color_variable = table_metadata[\"column-count\"] - 1;\n        if (\"variable-selection\" in bookmark) {\n          color_variable = [bookmark[\"variable-selection\"]];\n        }\n\n        $(\"#controls\").controls({\n          \"server-root\": _slycatServerRoot2.default,\n          mid: model_id,\n          model_name: model_name,\n          aid: \"data-table\",\n          metadata: table_metadata,\n          // clusters : clusters,\n          x_variables: axes_variables,\n          y_variables: axes_variables,\n          image_variables: image_columns,\n          color_variables: color_variables,\n          rating_variables: rating_columns,\n          category_variables: category_columns,\n          selection: selected_simulations,\n          // cluster_index : cluster_index,\n          \"x-variable\": x_index,\n          \"y-variable\": y_index,\n          \"image-variable\": images_index,\n          \"color-variable\": color_variable,\n          \"auto-scale\": auto_scale,\n          hidden_simulations: hidden_simulations,\n          indices: indices\n        });\n\n        // Changing the x variable updates the controls ...\n        $(\"#table\").bind(\"x-selection-changed\", function (event, variable) {\n          $(\"#controls\").controls(\"option\", \"x-variable\", variable);\n        });\n\n        // Changing the y variable updates the controls ...\n        $(\"#table\").bind(\"y-selection-changed\", function (event, variable) {\n          $(\"#controls\").controls(\"option\", \"y-variable\", variable);\n        });\n\n        // Changing the image variable updates the controls ...\n        $(\"#table\").bind(\"images-selection-changed\", function (event, variable) {\n          $(\"#controls\").controls(\"option\", \"image-variable\", variable);\n        });\n\n        // Changing the value of a variable updates the database, table, and scatterplot ...\n        $(\"#controls\").bind(\"set-value\", function (event, args) {\n          writeData(args.selection, args.variable, args.value);\n          function writeData(selection, variable, value) {\n            var hyperslices = \"\";\n            var data = \"[\";\n            for (var i = 0; i < selection.length; i++) {\n              if (i > 0) {\n                hyperslices += \"|\";\n                data += \",\";\n              }\n              hyperslices += selection[i];\n              data += \"[\" + value + \"]\";\n            }\n            data += \"]\";\n            var blob = new Blob([data], { type: \"text/html\" });\n            var formdata = new FormData();\n            formdata.append(\"data\", blob);\n            formdata.append(\"hyperchunks\", 0 + \"/\" + variable + \"/\" + hyperslices);\n\n            $.ajax({\n              type: \"PUT\",\n              url: _slycatServerRoot2.default + \"models/\" + model_id + \"/arraysets/data-table/data\",\n              data: formdata,\n              processData: false,\n              contentType: false,\n              success: function success(results) {\n                $(\"#table\").table(\"update_data\");\n\n                if (variable == x_index) update_scatterplot_x(variable);\n                if (variable == y_index) update_scatterplot_y(variable);\n\n                load_table_statistics([variable], function () {\n                  $(\"#table\").table(\"option\", \"statistics\", table_statistics);\n                  if (variable == v_index) {\n                    update_v(variable);\n                  }\n                });\n              },\n              error: function error(jqXHR, textStatus, errorThrown) {\n                console.log(\"writing array data error\");\n              }\n            });\n          }\n        });\n\n        // Log changes to the cluster variable ...\n        // $(\"#controls\").bind(\"cluster-selection-changed\", function(event, variable)\n        // {\n        //   variable = parseInt(variable);\n        //   cluster_selection_changed(variable);\n        //   update_dendrogram(variable);\n        // });\n\n        // Log changes to the x variable ...\n        $(\"#controls\").bind(\"x-selection-changed\", function (event, variable) {\n          x_selection_changed(variable);\n        });\n\n        // Log changes to the y variable ...\n        $(\"#controls\").bind(\"y-selection-changed\", function (event, variable) {\n          y_selection_changed(variable);\n        });\n\n        // Changing the auto scale option updates the scatterplot and logs it ...\n        $(\"#controls\").bind(\"auto-scale\", function (event, auto_scale) {\n          auto_scale_option_changed(auto_scale);\n        });\n\n        // Log changes to hidden selection ...\n        $(\"#controls\").bind(\"hide-selection\", function (event, selection) {\n          for (var i = 0; i < selected_simulations.length; i++) {\n            if ($.inArray(selected_simulations[i], hidden_simulations) == -1) {\n              hidden_simulations.push(selected_simulations[i]);\n            }\n          }\n          update_widgets_when_hidden_simulations_change();\n        });\n\n        // Log changes to hidden selection ...\n        $(\"#controls\").bind(\"show-selection\", function (event, selection) {\n          for (var i = 0; i < selected_simulations.length; i++) {\n            var index = $.inArray(selected_simulations[i], hidden_simulations);\n            if (index != -1) {\n              hidden_simulations.splice(index, 1);\n            }\n          }\n          update_widgets_when_hidden_simulations_change();\n        });\n\n        // Log changes to hidden selection ...\n        $(\"#controls\").bind(\"pin-selection\", function (event, selection) {\n          // Removing any hidden simulations from those that will be pinned\n          var simulations_to_pin = [];\n          for (var i = 0; i < selected_simulations.length; i++) {\n            var index = $.inArray(selected_simulations[i], hidden_simulations);\n            if (index == -1) {\n              simulations_to_pin.push(selected_simulations[i]);\n            }\n          }\n          $(\"#scatterplot\").scatterplot(\"pin\", simulations_to_pin);\n        });\n\n        // Log changes to hidden selection ...\n        $(\"#controls\").bind(\"show-all\", function (event, selection) {\n          while (hidden_simulations.length > 0) {\n            hidden_simulations.pop();\n          }\n          update_widgets_when_hidden_simulations_change();\n        });\n      }\n  }\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Event handlers.\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  function selected_node_changed(parameters) {\n    if (parameters.node != null && parameters.node[\"node-index\"] != null) {\n      $.ajax({\n        type: \"POST\",\n        url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/node/\" + parameters.node[\"node-index\"]\n      });\n    }\n    if (parameters.skip_bookmarking != true) {\n      var state = {};\n      state[cluster_index + \"-selected-nodes\"] = getNodeIndexes(parameters.selection, \"node-index\");\n      state[cluster_index + \"-selected-image-indexes\"] = getNodeIndexes(parameters.selection, \"image-index\");\n      bookmarker.updateState(state);\n    }\n  }\n\n  function getNodeIndexes(nodes, indexName) {\n    var node_indexes = [];\n    var node_index = null;\n\n    for (var i = 0; i < nodes.length; i++) {\n      node_index = nodes[i][indexName];\n      if (node_index != null) node_indexes.push(node_index);\n    }\n\n    return node_indexes;\n  }\n\n  function expanded_collapsed_nodes_changed(nodes) {\n    var cluster_state = {};\n    cluster_state[cluster_index + \"-expanded-nodes\"] = nodes.expanded;\n    cluster_state[cluster_index + \"-collapsed-nodes\"] = nodes.collapsed;\n    bookmarker.updateState(cluster_state);\n  }\n\n  function node_toggled(node) {\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/toggle/node/\" + node[\"node-index\"]\n    });\n  }\n\n  function selected_colormap_changed(colormap) {\n    update_current_colorscale();\n\n    // Changing the color map updates the dendrogram with a new color scale and new backdrop ...\n    $(\"#dendrogram-viewer\").dendrogram(\"option\", \"colorscale\", colorscale);\n    $(\"#dendrogram-leaf-backdrop\").css({\n      \"background-color\": $(\"#color-switcher\").colorswitcher(\"get_background\").toString()\n    });\n\n    // Changing the color map updates the table with a new color scale ...\n    $(\"#table\").table(\"option\", \"colorscale\", colorscale);\n\n    // Changing the color scale updates the scatterplot ...\n    $(\"#scatterplot-pane\").css(\"background\", $(\"#color-switcher\").colorswitcher(\"get_background\", colormap).toString());\n    $(\"#scatterplot\").scatterplot(\"option\", {\n      colorscale: colorscale,\n      gradient: $(\"#color-switcher\").colorswitcher(\"get_gradient_data\", colormap)\n    });\n\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/colormap/\" + colormap\n    });\n\n    bookmarker.updateState({ \"colormap\": colormap });\n  }\n\n  function handle_color_variable_change(variable) {\n    v_index = Number(variable);\n\n    if (v_index == table_metadata[\"column-count\"] - 1) {\n      var count = table_metadata[\"row-count\"];\n      for (var i = 0; i != count; ++i) {\n        v[i] = i;\n      }update_widgets_after_color_variable_change();\n    } else {\n      update_v(variable);\n    }\n\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/variable/\" + variable\n    });\n\n    bookmarker.updateState({ \"variable-selection\": variable });\n  }\n\n  function handle_image_variable_change(variable) {\n    images_index = Number(variable);\n\n    // Determine cluster variable from image variable\n    // TODO this needs improvement because we are not guaranteed unique variable names. List of clusters should provide indexes on the variables, instead of just names.\n    cluster_index = clusters.indexOf(table_metadata[\"column-names\"][images_index]);\n\n    // Get entire data column for current image variable and pass it to scatterplot and dendrogram\n    $.ajax({\n      type: \"GET\",\n      url: _slycatServerRoot2.default + \"models/\" + model_id + \"/arraysets/data-table/data?hyperchunks=0/\" + images_index + \"/0:\" + table_metadata[\"row-count\"],\n      success: function success(result) {\n        images = result[0];\n        // Passing new images to both scatterplot and dendrogram\n        $(\"#scatterplot\").scatterplot(\"option\", \"images\", images);\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", \"images\", images);\n        // Updating dendrogram with new cluster data, which will trigger refresh and thus render new images too\n        update_dendrogram(cluster_index);\n      },\n      error: artifact_missing\n    });\n\n    // Log changes to and bookmark the images variable ...\n    images_selection_changed(images_index);\n    // Log changes to and bookmark the cluster variable ...\n    cluster_selection_changed(cluster_index);\n  }\n\n  function images_selection_changed(variable) {\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/images/\" + variable\n    });\n    bookmarker.updateState({ \"images-selection\": variable });\n  }\n\n  function update_v(variable) {\n    chunker.get_model_array_attribute({\n      server_root: _slycatServerRoot2.default,\n      mid: model_id,\n      aid: \"data-table\",\n      array: 0,\n      attribute: variable,\n      success: function success(result) {\n        v = result;\n        if (table_metadata[\"column-types\"][variable] == \"string\") {\n          v = v[0];\n        }\n        update_widgets_after_color_variable_change();\n      },\n      error: artifact_missing\n    });\n  }\n\n  function update_widgets_after_color_variable_change() {\n    update_current_colorscale();\n    $(\"#table\").table(\"option\", \"colorscale\", colorscale);\n    $(\"#scatterplot\").scatterplot(\"update_color_scale_and_v\", {\n      v: v,\n      v_string: table_metadata[\"column-types\"][v_index] == \"string\",\n      colorscale: colorscale\n    });\n    $(\"#scatterplot\").scatterplot(\"option\", \"v_label\", table_metadata[\"column-names\"][v_index]);\n    $(\"#dendrogram-viewer\").dendrogram(\"option\", \"color-options\", { color_array: v, colorscale: colorscale });\n  }\n\n  function update_widgets_when_hidden_simulations_change(skip_dendrogram_update) {\n    hidden_simulations_changed();\n    if (auto_scale) {\n      update_current_colorscale();\n      $(\"#table\").table(\"option\", { hidden_simulations: hidden_simulations, colorscale: colorscale });\n      // TODO this will result in 2 updates to canvas, one to redraw points according to hidden simulations and another to color them according to new colorscale. Need to combine this to a single update when converting to canvas.\n      $(\"#scatterplot\").scatterplot(\"option\", { hidden_simulations: hidden_simulations, colorscale: colorscale });\n      if (!skip_dendrogram_update) {\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", { hidden_simulations: hidden_simulations, colorscale: colorscale });\n      }\n    } else {\n      $(\"#table\").table(\"option\", \"hidden_simulations\", hidden_simulations);\n      $(\"#scatterplot\").scatterplot(\"option\", \"hidden_simulations\", hidden_simulations);\n      if (!skip_dendrogram_update) {\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", \"hidden_simulations\", hidden_simulations);\n      }\n    }\n    $(\"#controls\").controls(\"option\", \"hidden_simulations\", hidden_simulations);\n  }\n\n  function update_current_colorscale() {\n    // Check if numeric or string variable\n    var v_type = table_metadata[\"column-types\"][v_index];\n    if (auto_scale) filtered_v = filterValues(v);else filtered_v = v;\n\n    if (v_type != \"string\") {\n      colorscale = $(\"#color-switcher\").colorswitcher(\"get_color_scale\", undefined, _d2.default.min(filtered_v), _d2.default.max(filtered_v));\n    } else {\n      var uniqueValues = _d2.default.set(filtered_v).values().sort();\n      colorscale = $(\"#color-switcher\").colorswitcher(\"get_color_scale_ordinal\", undefined, uniqueValues);;\n    }\n  }\n\n  // Filters source values by removing hidden_simulations\n  function filterValues(source) {\n    var self = this;\n    hidden_simulations.sort(_d2.default.ascending);\n    var length = hidden_simulations.length;\n\n    var filtered = cloneArrayBuffer(source);\n\n    for (var i = length - 1; i >= 0; i--) {\n      filtered.splice(hidden_simulations[i], 1);\n    }\n\n    return filtered;\n  }\n\n  // Clones an ArrayBuffer or Array\n  function cloneArrayBuffer(source) {\n    if (source.length > 1) {\n      return Array.apply([], source);\n    } else if (source.length == 1) {\n      return [source[0]];\n    }\n    return [];\n  }\n\n  function variable_sort_changed(variable, order) {\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/sort-order/\" + variable + \"/\" + order\n    });\n    bookmarker.updateState({ \"sort-variable\": variable, \"sort-order\": order });\n  }\n\n  function selected_simulations_changed(selection) {\n    // Logging every selected item is too slow, so just log the count instead.\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/simulation/count/\" + selection.length\n    });\n    bookmarker.updateState({ \"simulation-selection\": selection });\n    selected_simulations = selection;\n  }\n\n  function cluster_selection_changed(variable) {\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/cluster/\" + variable\n    });\n    bookmarker.updateState({ \"cluster-index\": variable });\n  }\n\n  function update_dendrogram(cluster_index) {\n    // Retrieve cluster data if it's not already in the cache\n    if (clusters_data[cluster_index] === undefined) {\n      $.ajax({\n        url: _slycatServerRoot2.default + \"models/\" + model_id + \"/files/cluster-\" + clusters[cluster_index],\n        contentType: \"application/json\",\n        success: function success(cluster_data) {\n          clusters_data[cluster_index] = cluster_data;\n          var dendrogram_options = build_dendrogram_node_options(cluster_index);\n          dendrogram_options.cluster_data = clusters_data[cluster_index];\n          $(\"#dendrogram-viewer\").dendrogram(\"option\", dendrogram_options);\n        },\n        error: artifact_missing\n      });\n    } else {\n      var dendrogram_options = build_dendrogram_node_options(cluster_index);\n      dendrogram_options.cluster_data = clusters_data[cluster_index];\n      $(\"#dendrogram-viewer\").dendrogram(\"option\", dendrogram_options);\n    }\n  }\n\n  function x_selection_changed(variable) {\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/x/\" + variable\n    });\n    bookmarker.updateState({ \"x-selection\": variable });\n    x_index = Number(variable);\n  }\n\n  function y_selection_changed(variable) {\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/y/\" + variable\n    });\n    bookmarker.updateState({ \"y-selection\": variable });\n    y_index = Number(variable);\n  }\n\n  function auto_scale_option_changed(auto_scale_value) {\n    auto_scale = auto_scale_value;\n    if (hidden_simulations.length > 0) {\n      update_current_colorscale();\n      $(\"#dendrogram-viewer\").dendrogram(\"option\", \"colorscale\", colorscale);\n      $(\"#table\").table(\"option\", \"colorscale\", colorscale);\n      // TODO this will result in 2 updates to canvas, one to redraw points accourding to scale and another to color them according to new colorscale. Need to combine this to a single update when converting to canvas.\n      $(\"#scatterplot\").scatterplot(\"option\", { colorscale: colorscale, 'auto-scale': auto_scale });\n    } else {\n      $(\"#scatterplot\").scatterplot(\"option\", \"auto-scale\", auto_scale);\n    }\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/auto-scale/\" + auto_scale\n    });\n    bookmarker.updateState({ \"auto-scale\": auto_scale });\n  }\n\n  function open_images_changed(selection) {\n    // Logging every open image is too slow, so just log the count instead.\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/select/openimages/count/\" + selection.length\n    });\n    bookmarker.updateState({ \"open-images-selection\": selection });\n  }\n\n  function hidden_simulations_changed() {\n    // Logging every hidden simulation is too slow, so just log the count instead.\n    $.ajax({\n      type: \"POST\",\n      url: _slycatServerRoot2.default + \"events/models/\" + model_id + \"/hidden/count/\" + hidden_simulations.length\n    });\n    bookmarker.updateState({ \"hidden-simulations\": hidden_simulations });\n  }\n\n  function update_scatterplot_x(variable) {\n    chunker.get_model_array_attribute({\n      server_root: _slycatServerRoot2.default,\n      mid: model_id,\n      aid: \"data-table\",\n      array: 0,\n      attribute: variable,\n      success: function success(result) {\n        $(\"#scatterplot\").scatterplot(\"option\", {\n          x_string: table_metadata[\"column-types\"][variable] == \"string\",\n          x: table_metadata[\"column-types\"][variable] == \"string\" ? result[0] : result,\n          x_label: table_metadata[\"column-names\"][variable]\n        });\n      },\n      error: artifact_missing\n    });\n  }\n\n  function update_scatterplot_y(variable) {\n    chunker.get_model_array_attribute({\n      server_root: _slycatServerRoot2.default,\n      mid: model_id,\n      aid: \"data-table\",\n      array: 0,\n      attribute: variable,\n      success: function success(result) {\n        $(\"#scatterplot\").scatterplot(\"option\", {\n          y_string: table_metadata[\"column-types\"][variable] == \"string\",\n          y: table_metadata[\"column-types\"][variable] == \"string\" ? result[0] : result,\n          y_label: table_metadata[\"column-names\"][variable]\n        });\n      },\n      error: artifact_missing\n    });\n  }\n\n  function load_table_statistics(columns, callback) {\n    _slycatWebClientWebpack2.default.get_model_arrayset_metadata({\n      mid: model_id,\n      aid: \"data-table\",\n      statistics: \"0/\" + columns.join(\"|\"),\n      success: function success(metadata) {\n        var statistics = metadata.statistics;\n        for (var i = 0; i != statistics.length; ++i) {\n          table_statistics[statistics[i].attribute] = { min: statistics[i].min, max: statistics[i].max };\n        }callback();\n      }\n    });\n  }\n}); /* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\")))\n\n//# sourceURL=webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/ui.js?");

/***/ })

/******/ });